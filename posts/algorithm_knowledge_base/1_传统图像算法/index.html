<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>传统图像算法 - FangjieYu‘s site</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/">
<meta property="og:site_name" content="FangjieYu‘s site"><meta property="og:title" content="传统图像算法"><meta property="og:description" content="deep-learning、CV（2d、3d）、RS、optical"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-01T00:00:00+00:00"><meta property="article:tag" content="CV"><meta property="article:tag" content="图像算法"><meta name=twitter:card content="summary"><meta name=twitter:title content="传统图像算法"><meta name=twitter:description content="deep-learning、CV（2d、3d）、RS、optical"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/><link rel=prev href=https://fjyu95.github.io/posts/algorithm_knowledge_base/2_%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"传统图像算法","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/fjyu95.github.io\/posts\/algorithm_knowledge_base\/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95\/"},"genre":"posts","keywords":"CV, 图像算法","wordcount":5577,"url":"https:\/\/fjyu95.github.io\/posts\/algorithm_knowledge_base\/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95\/","datePublished":"2024-10-22T00:00:00+00:00","dateModified":"2025-04-01T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"fjyu95"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="FangjieYu‘s site">fjyu95</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>posts </a><a class=menu-item href=/tags/>tags </a><a class=menu-item href=/categories/>category </a><a class=menu-item href=/about/>about </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="FangjieYu‘s site">fjyu95</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>posts</a><a class=menu-item href=/tags/ title>tags</a><a class=menu-item href=/categories/ title>category</a><a class=menu-item href=/about/ title>about</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">传统图像算法</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://fjyu95.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>fjyu95</a></span>&nbsp;<span class=post-category>included in <a href=/categories/%E7%AE%97%E6%B3%95%E7%9F%A5%E8%AF%86%E5%BA%93/><i class="far fa-folder fa-fw" aria-hidden=true></i>算法知识库</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-10-22>2024-10-22</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;5577 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;12 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#传统图像算法>传统图像算法</a><ul><li><a href=#特征提取><strong>特征提取</strong></a><ul><li><a href=#harris角点检测><strong>Harris角点检测</strong></a></li><li><a href=#sift尺度不变特征变换><strong>SIFT（尺度不变特征变换）</strong></a><ul><li><a href=#主方向与描述子的关系>主方向与描述子的关系</a></li></ul></li><li><a href=#surf加速稳健特征><strong>SURF（加速稳健特征）</strong></a></li><li><a href=#orb><strong>ORB</strong></a></li></ul></li><li><a href=#边缘检测>边缘检测</a><ul><li><a href=#canny>canny</a></li></ul></li><li><a href=#图像拼接>图像拼接</a><ul><li><a href=#特征点法最常用>特征点法（最常用）</a></li><li><a href=#总结对比>总结对比</a></li><li><a href=#光流法>光流法</a></li></ul></li><li><a href=#图像配准>图像配准</a></li><li><a href=#去噪增强>去噪、增强</a></li><li><a href=#形态学处理>形态学处理</a></li><li><a href=#hdr><strong>HDR</strong></a></li><li><a href=#变换技术>变换技术</a><ul><li><a href=#傅里叶变换><strong>傅里叶变换</strong></a></li><li><a href=#空间域与频率域>空间域与频率域</a></li><li><a href=#低频与高频>低频与高频</a></li></ul></li><li><a href=#raw图像>RAW图像</a></li><li><a href=#isp-图像信号处理>ISP 图像信号处理</a><ul><li><a href=#主要isp算法模块>主要ISP算法模块</a></li></ul></li><li><a href=#3a算法>3A算法</a><ul><li><a href=#1-自动对焦auto-focusaf>1. 自动对焦（Auto Focus，AF）</a></li><li><a href=#2-自动曝光auto-exposureae>2. 自动曝光（Auto Exposure，AE）</a></li><li><a href=#3-自动白平衡auto-white-balanceawb>3. 自动白平衡（Auto White Balance，AWB）</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=传统图像算法>传统图像算法</h1><h2 id=特征提取><strong>特征提取</strong></h2><h3 id=harris角点检测><strong>Harris角点检测</strong></h3><p><a href=https://dezeming.top/wp-content/uploads/2021/05/Harris%e8%a7%92%e7%82%b9%e6%a3%80%e6%b5%8b%e5%8e%9f%e7%90%86%e4%b8%8eOpenCV%e6%ba%90%e7%a0%81%e8%a7%a3%e8%af%bb-1.pdf target=_blank rel="noopener noreffer">Harris角点检测原理与OpenCV源码解读-1.pdf</a></p><p><strong>检测图像中的角点，用于特征匹配和识别</strong></p><p><strong>角点是向各个方向移动窗口，灰度值都发生较大变化的点</strong></p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/image%2042.png data-srcset="/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/image%2042.png, /posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/image%2042.png 1.5x, /posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/image%2042.png 2x" data-sizes=auto alt=/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/image%2042.png title=image.png width=338 height=122></p><img src=image%2043.png width=75%><p><strong>主要是根据矩阵分析的方法，构造了角点响应函数，以此作为判定依据</strong></p><h3 id=sift尺度不变特征变换><strong>SIFT（尺度不变特征变换）</strong></h3><p>提取局部特征点，在尺度和旋转上具有不变性，常用于图像匹配。</p><p><a href=https://dezeming.top/wp-content/uploads/2021/07/Sift%e7%ae%97%e6%b3%95%e5%8e%9f%e7%90%86%e4%b8%8eOpenCV%e6%ba%90%e7%a0%81%e8%a7%a3%e8%af%bb.pdf target=_blank rel="noopener noreffer">Sift算法原理与OpenCV源码解读.pdf</a></p><p><a href=https://blog.csdn.net/lhanchao/article/details/52345845 target=_blank rel="noopener noreffer">特征点匹配——SIFT算法详解</a></p><p><strong>第一步是特征点检测，第二步是生成特征描述</strong></p><ol><li>尺度空间上极值点检测</li><li>关键点精确定位</li><li>关键点方向分配（根据36个bins的峰值确定主导方向）</li><li>生成特征描述子（周围分为4 × 4个区域，各计算8个方向的梯度，128维特征描述子）</li></ol><ul><li>特征点的 36 个方向是用来确定每个特征点的主方向，以便于在旋转和缩放变化中保持一致性。</li><li>描述子的 8 个方向则是在特征点的主方向基础上，通过对局部区域的梯度信息进行统计生成的，确保描述子能够有效捕捉周围的局部特征。</li><li>这两者的结合使得 SIFT 能够在各种图像变换下保持良好的特征匹配性能。</li></ul><h4 id=主方向与描述子的关系>主方向与描述子的关系</h4><ul><li><strong>旋转不变性</strong>：特征点的主方向用于对描述子进行旋转对齐。这样可以确保即使图像发生旋转，描述子仍然可以保持一致性。<ul><li>具体来说，<strong>生成描述子时，首先将局部区域的梯度信息相对于特征点的主方向进行旋转</strong>。这种方法使得描述子在不同视角下对同一物体的表示是一致的。</li></ul></li><li><strong>特征匹配</strong>：由于描述子是相对于主方向计算的，因此在特征匹配时，可以更容易地找到相似的特征点。例如，在两幅图像中找到具有相同描述子的特征点时，它们的主方向一致性提供了额外的匹配准确性。</li></ul><p>首先构造高斯金字塔尺度空间，对图像进行高斯模糊不断降采样</p><p>具体分为4步：</p><p>• 第一阶段的计算搜索所有的尺度上的所有图像区域。<br>该算法利用高斯函数的微分来识别对尺度和方向不变性的潜在兴趣点。</p><p>• 第二阶段是关键点定位，在每个候选位置，一个精细的模型用于确定位置和尺度。<br>关键点是根据它们的稳定性来选择的。</p><img src=image%2044.png width=75%><p>离散空间的极值点并不一定是真的极值点，通过函数拟合精确定位<br>• 第三阶段是方向分配，基于局部图像梯度方向为每个关键点位置分配一个或多个方向。<br>所有的后续操作都是对已相对于每个特征的指定方向、比例和位置进行变换的图像执行的，从而为这些变换提供不变性。</p><p>• 最后生成关键点描述子（descriptor，又叫描述符），在每个关键点周围区域的选定比例上测量局部图像梯度。这些被转换成一种表示方法，允许较大的局部形状失真和照明变化。</p><p>对描述子使用关键点所在尺度空间内4 × 4 个子区域中计算8 个方向的梯度信息，也就是总共4 × 4 × 8 = 128 维向量。</p><h3 id=surf加速稳健特征><strong>SURF（加速稳健特征）</strong></h3><p>比SIFT更快，性能也较好，用于特征点提取和描述。</p><h3 id=orb><strong>ORB</strong></h3><p>slam中使用较多</p><h2 id=边缘检测>边缘检测</h2><h3 id=canny>canny</h3><p><a href=https://zj-image-processing.readthedocs.io/zh-cn/latest/opencv/code/%5BCanny%5D%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B/#_4 target=_blank rel="noopener noreffer">Canny边缘检测</a></p><p><code>Canny</code>算子是常用的边缘检测算法，其执行步骤如下：</p><ol><li>应用高斯滤波器平滑图像以去除噪声</li><li>计算图像的强度梯度</li><li>应用非最大抑制（<code>Non-maximum suppression</code>）消除边缘检测的虚假响应</li></ol><p>（不同于目标检测NMS）</p><ol><li>应用<strong>双阈值</strong>确定潜在边缘</li></ol><p>根据梯度强度将像素分为三类：</p><ul><li><strong>强边缘</strong>：梯度强度大于高阈值的像素，被直接标记为边缘。</li><li><strong>弱边缘</strong>：梯度强度在低阈值和高阈值之间的像素，可能是边缘，但需要进一步判断。</li><li><strong>非边缘</strong>：梯度强度小于低阈值的像素，被抑制为非边缘。</li></ul><ol start=2><li>通过滞后（<code>hysteresis</code>）方法跟踪边缘：通过抑制所有其他弱边缘和未连接到强边缘的边缘，完成边缘检测</li></ol><h2 id=图像拼接>图像拼接</h2><h3 id=特征点法最常用>特征点法（最常用）</h3><ul><li><p><strong>特征提取</strong>：</p><ul><li>使用特征检测算法（如 SIFT、SURF、ORB 等）从每张图像中提取关键点，并计算对应的特征描述子。</li></ul></li><li><p><strong>特征匹配</strong>：</p><ul><li>使用最近邻匹配或基于距离比率的匹配（如 KNN 匹配）来找到不同图像中的相似特征点对。FLANN快速最近邻</li></ul></li><li><p><strong>求解单应矩阵（Homography Matrix）</strong>：</p><ul><li>使用 <strong>RANSAC 等鲁棒算法</strong>估计两张图像间的单应矩阵，以剔除错误匹配点，并获取精确的几何变换关系。</li></ul></li><li><p><strong>图像变换与对齐</strong>：</p><ul><li>使用单应矩阵将图像进行几何变换（如透视变换或仿射变换），实现图像的对齐。</li></ul><h3 id=总结对比>总结对比</h3><table><thead><tr><th>特性</th><th>仿射变换</th><th>单应变换</th></tr></thead><tbody><tr><td>矩阵大小</td><td>3×2</td><td>3×3</td></tr><tr><td>自由度</td><td>6 个参数</td><td>8 个参数（一个比例因子）</td></tr><tr><td>支持变换类型</td><td>旋转、平移、缩放、剪切</td><td>透视变换（包含仿射变换）</td></tr><tr><td>适用场景</td><td>小视角变换、图像小幅旋转、平移、缩放</td><td>大视角变换、透视失真、图像拼接</td></tr><tr><td>准确性</td><td>适合简单几何变形</td><td>适合复杂几何变形</td></tr><tr><td>适用平面</td><td>适合在同一平面内的平移或旋转</td><td>适用于不同平面视角拍摄的透视场景</td></tr></tbody></table></li><li><p><strong>图像融合</strong>：</p><ul><li>采用多种融合算法（如渐变融合、拉普拉斯融合）对重叠区域进行平滑过渡，减少拼接痕迹。</li></ul></li></ul><h3 id=光流法>光流法</h3><p>lk光流 稀疏光流</p><p><strong>基于灰度不变假设，适用于特征缺失的情况</strong></p><p>光流法是一种基于图像运动估计的拼接方法，主要应用于相邻帧的运动估计。</p><p>适合于处理连续帧图像间的拼接，尤其在视频帧拼接、微小相对运动的场景中效果较好。</p><p>光流法基于假设：图像中相邻帧之间的亮度在运动过程中是保持恒定的，即光流约束方程。它通过对相邻帧图像像素点进行运动估计，从而计算出每个像素的位移向量，进而实现图像拼接。</p><p>光流约束方程</p><h2 id=图像配准>图像配准</h2><p>基于特征点</p><p>光流法</p><p>模板匹配 通过计算两幅图像之间的互相关系数，找到最佳的平移量进行对齐</p><h2 id=去噪增强>去噪、增强</h2><p><strong>滤波器(平滑、积分运算)</strong>：</p><ul><li><strong>均值滤波</strong>：通过计算邻域像素的均值来平滑图像，减少噪声。</li><li><strong>高斯滤波</strong>：使用高斯函数作为卷积核进行平滑，能更好地保留边缘信息。</li><li><strong>中值滤波</strong>：用邻域像素的中值替代中心像素，有效去除椒盐噪声。</li></ul><p><strong>锐化、微分运算</strong></p><p><strong>直方图均衡化</strong>：</p><p>通过调整图像的直方图，使得图像的对比度得到增强，尤其适用于低对比度图像。</p><p>变为灰度分布均匀的新图像</p><h2 id=形态学处理>形态学处理</h2><ul><li><strong>膨胀和腐蚀</strong>：用于图像的形态学处理，膨胀增加物体的边界，腐蚀则减小物体的边界。</li><li><strong>开运算和闭运算</strong>：开运算用于去除小的物体，闭运算用于填补小的空洞。</li></ul><hr><p>详见OpenCV章节</p><hr><h2 id=hdr><strong>HDR</strong></h2><p><a href=https://linux.cn/article-9754-1.html target=_blank rel="noopener noreffer">https://linux.cn/article-9754-1.html</a></p><p><a href=https://www.orzzz.cn/index.php/archives/44/ target=_blank rel="noopener noreffer">https://www.orzzz.cn/index.php/archives/44/</a></p><p>CRF估计：与计算机视觉中的许多问题一样，找到 CRF 的问题本质是一个最优解问题，其目标是使由数据项和平滑项组成的目标函数最小化。 这些问题通常会降维到线性最小二乘问题，这些问题可以使用奇异值分解Singular Value Decomposition（SVD）来解决，奇异值分解是所有线性代数包的一部分。<strong>Debevec算法</strong></p><p>hdr合成：针对某一个位置的像素点，将不同曝光图片的这个位置的辐照度<strong>进行加权平均</strong>，求出最终 <code>hdr</code> 图片的这个位置的像素值。<strong>多种策略，中间亮度权重更高</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cv2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>np</span><span class=o>.</span><span class=n>set_printoptions</span><span class=p>(</span><span class=n>suppress</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1、读图</span>
</span></span><span class=line><span class=cl><span class=n>img_fn</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;img_0.033.jpg&#34;</span><span class=p>,</span> <span class=s2>&#34;img_0.25.jpg&#34;</span><span class=p>,</span> <span class=s2>&#34;img_2.5.jpg&#34;</span><span class=p>,</span> <span class=s2>&#34;img_15.jpg&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>img_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>cv2</span><span class=o>.</span><span class=n>imread</span><span class=p>(</span><span class=n>fn</span><span class=p>)</span> <span class=k>for</span> <span class=n>fn</span> <span class=ow>in</span> <span class=n>img_fn</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>exposure_times</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mf>0.033</span><span class=p>,</span> <span class=mf>0.25</span><span class=p>,</span> <span class=mf>2.5</span><span class=p>,</span> <span class=mf>15.0</span><span class=p>],</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>float32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2、对齐</span>
</span></span><span class=line><span class=cl><span class=n>alignMTB</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>createAlignMTB</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>alignMTB</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>img_list</span><span class=p>,</span> <span class=n>img_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3、计算响应曲线crf</span>
</span></span><span class=line><span class=cl><span class=n>calibrateDebevec</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>createCalibrateDebevec</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>responseDebevec</span> <span class=o>=</span> <span class=n>calibrateDebevec</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>img_list</span><span class=p>,</span> <span class=n>exposure_times</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>responseDebevec</span><span class=p>),</span><span class=n>responseDebevec</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>responseDebevec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4、hdr融合</span>
</span></span><span class=line><span class=cl><span class=n>mergeDebevec</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>createMergeDebevec</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>hdrDebevec</span> <span class=o>=</span> <span class=n>mergeDebevec</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>img_list</span><span class=p>,</span> <span class=n>exposure_times</span><span class=p>,</span> <span class=n>responseDebevec</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s2>&#34;hdrDebevec.hdr&#34;</span><span class=p>,</span> <span class=n>hdrDebevec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5、色调映射</span>
</span></span><span class=line><span class=cl><span class=n>tonemapMantiuk</span> <span class=o>=</span> <span class=n>cv2</span><span class=o>.</span><span class=n>createTonemapMantiuk</span><span class=p>(</span><span class=mf>2.2</span><span class=p>,</span> <span class=mf>0.85</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ldrMantiuk</span> <span class=o>=</span> <span class=n>tonemapMantiuk</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>hdrDebevec</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ldrMantiuk</span> <span class=o>=</span> <span class=mi>3</span> <span class=o>*</span> <span class=n>ldrMantiuk</span>
</span></span><span class=line><span class=cl><span class=n>cv2</span><span class=o>.</span><span class=n>imwrite</span><span class=p>(</span><span class=s2>&#34;ldr-Mantiuk.jpg&#34;</span><span class=p>,</span> <span class=n>ldrMantiuk</span> <span class=o>*</span> <span class=mi>255</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=变换技术>变换技术</h2><h3 id=傅里叶变换><strong>傅里叶变换</strong></h3><p>将图像从空间域转换到频率域，常用于图像分析和滤波。</p><p>空间域是指图像本身的像素值分布，它直接描述了图像的视觉内容。</p><p>频率域是指<strong>图像的频率成分分布，它描述了图像中像素值变化的速率，描述结构特征。空间域和频率域提供了两种不同的视角来分析和处理图像。空间域直接反映了图像的视觉内容，而频率域则揭示了图像中的频率成分及其分布，描述的是整体特征，不直接与空间位置对应</strong>。</p><h3 id=空间域与频率域>空间域与频率域</h3><ul><li><strong>空间域</strong>：在空间域中，图像是由像素组成的矩阵，每个像素值表示该位置的灰度或颜色值。空间域描述了图像的直接视觉内容。</li><li><strong>频率域</strong>：在频率域中，<strong>图像被分解为不同的频率成分，表示图像中像素值变化的速率</strong>。<strong>频率域描述了图像的结构特征，如边缘和纹理</strong>。</li></ul><h3 id=低频与高频>低频与高频</h3><ul><li><strong>低频成分</strong>：代表图像中的大面积平滑区域，变化缓慢。低频成分在频谱的中心区域，包含了图像的整体轮廓和主要特征。</li><li><strong>高频成分</strong>：代表图像中的细节和边缘，变化迅速。高频成分在频谱的外围区域，包含了图像的细节和噪声。</li><li><strong>频谱图</strong>：通过傅里叶变换得到的频谱图直观地显示了图像的频率成分，<strong>中心亮表示低频成分强，外围亮表示高频成分强。</strong></li></ul><p>幅度谱和相位谱是图像傅里叶变换的两个重要组成部分。幅度谱描述频率成分的强度，反映图像的对比度和亮度；相位谱描述频率成分的相位，反映图像的结构和细节。</p><p><a href=https://blog.csdn.net/weixin_39504171/article/details/94553357 target=_blank rel="noopener noreffer">图像处理2：二维图像的频谱图理解_图像频谱图的含义-CSDN博客</a></p><p>1、频谱图以图像的中心为圆心,,半径对应频率高低。低频半径小,高频半径大,中心为直流分量,某点的灰度值对应该频率的能量高低。</p><p>2、频谱图用来表示图像的频率分布,频率分布是图像的整体特征,因此频谱图与原图像之间并不存在坐标点上的对应关系。</p><ul><li><strong>小波变换</strong>：用于多分辨率分析，能在不同尺度上表示图像信息。</li><li>PCA 降维(主成分分析)：对原始信息进行<strong>重新线性组合</strong>，指向信息量更大的方向。</li></ul><h2 id=raw图像>RAW图像</h2><p><strong>RAW图像保留了传感器的原始数据，没有经过ISP的进一步处理，因此能够为后续的图像处理提供更灵活的调整空间。</strong></p><p><a href=https://www.cnblogs.com/powerforme/p/16722603.html target=_blank rel="noopener noreffer">https://www.cnblogs.com/powerforme/p/16722603.html</a></p><p>RAW格式文件本质上是一个没有经任何图像处理的源文件，它能原原本本的记录下相机拍摄到的的信息，没有因为图像处理（如锐化、增加色彩对比）和压缩而造成的信息丢失，但需要经过相关的ISP处理才能够呈现出来。</p><h2 id=isp-图像信号处理>ISP 图像信号处理</h2><p>ISP（Image Signal Processing）算法是图像信号处理的关键技术，主要应用在<strong>相机传感器捕获图像后的处理环节中，将原始传感器数据转换为可视图像</strong>。ISP算法通常用于数码相机、智能手机摄像头和监控摄像头等设备中。ISP算法可以包含多个步骤，以实现对色彩、清晰度、动态范围等的优化。</p><h3 id=主要isp算法模块>主要ISP算法模块</h3><ol><li><p><strong>去噪（Denoising）</strong>：</p><ul><li>图像传感器会在低光环境和高增益设置下产生噪声。去噪算法（如中值滤波、均值滤波、双边滤波、非局部均值滤波等）可以减少这些噪声，同时保持边缘细节。</li></ul></li><li><p><strong>黑电平校正（Black Level Correction）</strong>：</p><ul><li>由于传感器的基准噪声，所有像素的起始电平并非零。黑电平校正可以将电平重新归一化，调整黑色像素的基准。</li></ul></li><li><p><strong>白平衡（White Balance）</strong>：</p><ul><li>不同光源会导致色温不同，白平衡校正能让白色区域在不同光源下看起来都接近白色。自动白平衡算法可以调整RGB通道的增益，以实现色彩还原。</li></ul></li><li><p><strong>去伪色（Demosaicing）</strong>：</p><ul><li>图像传感器通常使用拜耳滤波器捕获彩色信息，每个像素只能记录一种颜色。去伪色算法通过插值填充其他颜色的信息，从而生成完整的RGB图像。</li></ul></li><li><p><strong>色彩校正（Color Correction）</strong>：</p><ul><li>传感器的RGB响应与人眼感知的颜色不同。色彩校正矩阵（CCM）可以校准RGB信号，使得图像的色彩更符合真实场景。</li></ul></li><li><p><strong>伽马校正（Gamma Correction）</strong>：</p><ul><li>伽马校正用于调整图像的亮度分布，使图像在视觉上更加自然。此操作根据非线性伽马曲线，将图像的亮暗区域调整到更适合人眼观察的效果。</li></ul></li><li><p><strong>锐化（Sharpening）</strong>：</p><ul><li>锐化处理可以增强图像的边缘细节，增加图像的清晰度。常用的锐化算法有拉普拉斯锐化、Unsharp Masking等。</li></ul></li><li><p><strong>色调映射（Tone Mapping）</strong>：</p><ul><li>主要用于HDR图像处理，将高动态范围图像映射到低动态范围显示设备上，以适应屏幕显示。常用的色调映射算法包括全局色调映射和局部色调映射。</li></ul></li><li><p><strong>伽马校正与亮度增强</strong>：</p><ul><li>伽马校正可以使图像的亮度更符合人眼的感知。同时，通过亮度增强，图像在低光条件下会显得更明亮。</li></ul></li><li><p><strong>畸变校正（Distortion Correction）</strong>：</p><ul><li>广角镜头或其他特殊镜头会导致图像变形。畸变校正算法可以纠正镜头引起的桶形或枕形畸变。</li></ul></li><li><p><strong>图像裁剪和缩放（Cropping and Scaling）</strong>：</p><ul><li>为了适应不同显示分辨率和需求，对图像进行裁剪和缩放是必不可少的操作。双线性插值和双三次插值是常用的缩放算法。</li></ul></li><li><p><strong>降采样（Downsampling）</strong>：</p><ul><li>在某些应用场景中，如视频流传输中需要更低的分辨率。降采样通过减少图像分辨率，来降低带宽需求。</li></ul></li><li><p><strong>去马赛克（Demosaicing）</strong></p><p>由于大多数图像传感器采用拜耳滤波器阵列（Bayer Filter Array），每个像素只能记录红、绿或蓝中的一种颜色，去马赛克算法会通过插值计算还原每个像素的完整RGB信息，以生成彩色图像。</p></li></ol><h2 id=3a算法>3A算法</h2><p>3A算法（Auto Focus、Auto Exposure、Auto White Balance）是相机图像处理中的三项核心自动化技术，用于自动优化图像质量。</p><h3 id=1-自动对焦auto-focusaf>1. 自动对焦（Auto Focus，AF）</h3><p>自动对焦算法用于<strong>将目标对象调至清晰成像的位置</strong>，确保图像具有最佳锐度。常见的自动对焦技术包括：</p><ul><li><strong>相位检测自动对焦（PDAF）</strong>：通过检测图像传感器上成对的光线相位差，快速计算出焦点位置，适用于快速运动物体。</li><li><strong>对比度检测自动对焦</strong>：通过分析图像对比度的变化来确定焦点，但速度较慢。</li><li><strong>激光自动对焦（Laser AF）</strong>：利用激光测距，可以在暗光条件下快速对焦。</li></ul><p>在3A算法中，自动对焦模块通过对场景的动态分析，选择合适的对焦模式，并不断调整以适应场景的变化。</p><h3 id=2-自动曝光auto-exposureae>2. 自动曝光（Auto Exposure，AE）</h3><p>自动曝光算法通过<strong>调节图像传感器的曝光参数</strong>（如快门速度、光圈大小和ISO感光度），确保图像亮度适中，不会过曝或欠曝。AE通常包括以下几种测光模式：</p><ul><li><strong>点测光</strong>：测量特定区域的亮度，适合高对比度的场景。</li><li><strong>中心加权测光</strong>：主要测量画面中心的亮度，但也参考边缘区域，适用于大多数场景。</li><li><strong>矩阵测光</strong>：将画面分为多个区域，综合分析亮度来决定曝光值，是较为智能的一种方式。</li></ul><p>AE算法会分析场景的亮度分布和动态范围，并根据不同场景的需要，动态调整曝光参数。</p><h3 id=3-自动白平衡auto-white-balanceawb>3. 自动白平衡（Auto White Balance，AWB）</h3><p>自动白平衡算法通过调节红、绿、蓝三通道的增益，以还<strong>原场景中的真实色彩，防止不同光源色温带来的色偏</strong>。常见的白平衡算法有：</p><ul><li><strong>灰度世界假设</strong>：假设图像中所有颜色的平均值是中性灰，从而推导出适合的色温。</li><li><strong>动态白平衡检测</strong>：通过实时分析图像中高光、中间调和阴影区域的颜色信息，动态调整白平衡。</li><li><strong>基于场景的白平衡</strong>：在特定场景（如日光、荧光灯）下，直接使用预设的白平衡参数。</li></ul><p>AWB算法会分析场景的光源特性，自动调节三通道的增益值，<strong>使得白色区域尽可能接近真实白色</strong>，从而使图像的色彩更加自然。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-04-01</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/ data-title=传统图像算法 data-hashtags=CV,图像算法><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/ data-hashtag=CV><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/ data-title=传统图像算法><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/ data-title=传统图像算法><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://fjyu95.github.io/posts/algorithm_knowledge_base/1_%E4%BC%A0%E7%BB%9F%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/ data-title=传统图像算法><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/cv/>CV</a>,&nbsp;<a href=/tags/%E5%9B%BE%E5%83%8F%E7%AE%97%E6%B3%95/>图像算法</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/algorithm_knowledge_base/2_%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/ class=prev rel=prev title=计算机视觉><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>计算机视觉</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2020 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://fjyu95.github.io/ target=_blank>fjyu95</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>