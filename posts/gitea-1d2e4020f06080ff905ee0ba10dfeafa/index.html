<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Giteaæ­å»º - FangjieYuâ€˜s site</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/">
<meta property="og:site_name" content="FangjieYuâ€˜s site"><meta property="og:title" content="Giteaæ­å»º"><meta property="og:description" content="æ–‡æ¡£ https://docs.gitea.com/zh-cn/category/installation
https://dl.gitea.com/gitea/1.23.7/
å®‰è£…ï¼ˆäºŒè¿›åˆ¶ï¼‰ https://docs.gitea.com/zh-cn/installation/install-from-binary
# ç¯å¢ƒå‡†å¤‡ sudo apt update sudo apt install git wget sqlite3 -y # giteaä¸‹è½½ wget -O gitea https://dl.gitea.com/gitea/1.23.7/gitea-1.23.7-linux-amd64 # -O write documents to FILE wget gitea https://dl.gitea.com/gitea/1.23.7/gitea-1.23.7-linux-amd64.asc chmod +x gitea sudo cp gitea /usr/local/bin/gitea # éªŒè¯GPGç­¾å[å¯é€‰] gpg --keyserver keys.openpgp.org --recv 7C9E68152594688862D62AF62D9AE806EC1592E2 gpg --verify gitea-1.23.7-linux-amd64.asc gitea # åˆ›å»ºå·¥ä½œè·¯å¾„ sudo mkdir -p /var/lib/gitea/{custom,data,log} sudo chown -R git:git /var/lib/gitea/ sudo chmod -R 750 /var/lib/gitea/ sudo mkdir /etc/gitea sudo chown root:git /etc/gitea sudo chmod 770 /etc/gitea # ç½‘é¡µé…ç½®å®Œæˆåæ‰§è¡Œ chmod 750 /etc/gitea chmod 640 /etc/gitea/app.ini # åˆ›å»º Gitea ç”¨æˆ· sudo adduser \ --system \ --shell /bin/bash \ --gecos 'Git Version Control' \ --group \ --disabled-password \ --home /home/git \ git # æ·»åŠ  Systemd æœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰ sudo tee /etc/systemd/system/gitea.service > /dev/null << EOF [Unit] Description=Gitea (Git with a cup of tea) After=syslog.target After=network.target Requires=network.target [Service] RestartSec=2s Type=simple User=git Group=git WorkingDirectory=/var/lib/gitea/ ExecStart=/usr/local/bin/gitea web --config /etc/gitea/app.ini Restart=always Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/var/lib/gitea [Install] WantedBy=multi-user.target EOF # å¯åŠ¨æœåŠ¡ sudo systemctl daemon-reload sudo systemctl enable --now gitea sudo systemctl status gitea # æ£€æŸ¥æœåŠ¡çŠ¶æ€ # è®¿é—® Web é¡µé¢é…ç½® æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š ğŸ“ http://<ä½ çš„æœåŠ¡å™¨IP>:3000 /etc/gitea/app.ini # é…ç½®æ–‡ä»¶é»˜è®¤è·¯å¾„ # å¯é€‰ï¼šå¼€æ”¾é˜²ç«å¢™ç«¯å£ sudo ufw allow 3000 # æˆ–æ”¾åœ¨ Nginx åé¢ä½¿ç”¨ 80/443 sudo ufw status sudo systemctl restart gitea # é‡å¯ Gitea	å®‰è£…æŒ‡å¯¼ gpt ä¸‹é¢æ˜¯åœ¨ Ubuntu ä¸Šéƒ¨ç½² Giteaï¼ˆç§æœ‰ Git å¹³å°ï¼‰ çš„è¶…æ¸…æ™°æ­¥éª¤ï¼Œè½»é‡å¥½ç”¨ï¼Œé€‚åˆä¸ªäººå’Œå°å›¢é˜Ÿï¼Œå‡ å MB å°±èƒ½è·‘ï¼Œå‡ åˆ†é’Ÿæå®šï¼ğŸ’»ğŸš€"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-11T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-13T00:00:00+00:00"><meta property="article:tag" content="Git"><meta name=twitter:card content="summary"><meta name=twitter:title content="Giteaæ­å»º"><meta name=twitter:description content="æ–‡æ¡£ https://docs.gitea.com/zh-cn/category/installation
https://dl.gitea.com/gitea/1.23.7/
å®‰è£…ï¼ˆäºŒè¿›åˆ¶ï¼‰ https://docs.gitea.com/zh-cn/installation/install-from-binary
# ç¯å¢ƒå‡†å¤‡ sudo apt update sudo apt install git wget sqlite3 -y # giteaä¸‹è½½ wget -O gitea https://dl.gitea.com/gitea/1.23.7/gitea-1.23.7-linux-amd64 # -O write documents to FILE wget gitea https://dl.gitea.com/gitea/1.23.7/gitea-1.23.7-linux-amd64.asc chmod +x gitea sudo cp gitea /usr/local/bin/gitea # éªŒè¯GPGç­¾å[å¯é€‰] gpg --keyserver keys.openpgp.org --recv 7C9E68152594688862D62AF62D9AE806EC1592E2 gpg --verify gitea-1.23.7-linux-amd64.asc gitea # åˆ›å»ºå·¥ä½œè·¯å¾„ sudo mkdir -p /var/lib/gitea/{custom,data,log} sudo chown -R git:git /var/lib/gitea/ sudo chmod -R 750 /var/lib/gitea/ sudo mkdir /etc/gitea sudo chown root:git /etc/gitea sudo chmod 770 /etc/gitea # ç½‘é¡µé…ç½®å®Œæˆåæ‰§è¡Œ chmod 750 /etc/gitea chmod 640 /etc/gitea/app.ini # åˆ›å»º Gitea ç”¨æˆ· sudo adduser \ --system \ --shell /bin/bash \ --gecos 'Git Version Control' \ --group \ --disabled-password \ --home /home/git \ git # æ·»åŠ  Systemd æœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰ sudo tee /etc/systemd/system/gitea.service > /dev/null << EOF [Unit] Description=Gitea (Git with a cup of tea) After=syslog.target After=network.target Requires=network.target [Service] RestartSec=2s Type=simple User=git Group=git WorkingDirectory=/var/lib/gitea/ ExecStart=/usr/local/bin/gitea web --config /etc/gitea/app.ini Restart=always Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/var/lib/gitea [Install] WantedBy=multi-user.target EOF # å¯åŠ¨æœåŠ¡ sudo systemctl daemon-reload sudo systemctl enable --now gitea sudo systemctl status gitea # æ£€æŸ¥æœåŠ¡çŠ¶æ€ # è®¿é—® Web é¡µé¢é…ç½® æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š ğŸ“ http://<ä½ çš„æœåŠ¡å™¨IP>:3000 /etc/gitea/app.ini # é…ç½®æ–‡ä»¶é»˜è®¤è·¯å¾„ # å¯é€‰ï¼šå¼€æ”¾é˜²ç«å¢™ç«¯å£ sudo ufw allow 3000 # æˆ–æ”¾åœ¨ Nginx åé¢ä½¿ç”¨ 80/443 sudo ufw status sudo systemctl restart gitea # é‡å¯ Gitea	å®‰è£…æŒ‡å¯¼ gpt ä¸‹é¢æ˜¯åœ¨ Ubuntu ä¸Šéƒ¨ç½² Giteaï¼ˆç§æœ‰ Git å¹³å°ï¼‰ çš„è¶…æ¸…æ™°æ­¥éª¤ï¼Œè½»é‡å¥½ç”¨ï¼Œé€‚åˆä¸ªäººå’Œå°å›¢é˜Ÿï¼Œå‡ å MB å°±èƒ½è·‘ï¼Œå‡ åˆ†é’Ÿæå®šï¼ğŸ’»ğŸš€"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/><link rel=prev href=https://fjyu95.github.io/posts/gogs-1cee4020f06080249ec6d53c8d9ef2eb/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Giteaæ­å»º","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/fjyu95.github.io\/posts\/gitea-1d2e4020f06080ff905ee0ba10dfeafa\/"},"genre":"posts","keywords":"git","wordcount":11523,"url":"https:\/\/fjyu95.github.io\/posts\/gitea-1d2e4020f06080ff905ee0ba10dfeafa\/","datePublished":"2025-04-11T00:00:00+00:00","dateModified":"2025-04-13T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"fjyu95"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="FangjieYuâ€˜s site">fjyu95</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>posts </a><a class=menu-item href=/tags/>tags </a><a class=menu-item href=/categories/>category </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="FangjieYuâ€˜s site">fjyu95</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>posts</a><a class=menu-item href=/tags/ title>tags</a><a class=menu-item href=/categories/ title>category</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Giteaæ­å»º</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://fjyu95.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>fjyu95</a></span>&nbsp;<span class=post-category>included in <a href=/categories/git%E7%AC%94%E8%AE%B0/><i class="far fa-folder fa-fw" aria-hidden=true></i>Gitç¬”è®°</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2025-04-11>2025-04-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;11523 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;23 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#æ–‡æ¡£>æ–‡æ¡£</a></li><li><a href=#å®‰è£…äºŒè¿›åˆ¶>å®‰è£…ï¼ˆäºŒè¿›åˆ¶ï¼‰</a><ul><li><a href=#å®‰è£…æŒ‡å¯¼-gpt>å®‰è£…æŒ‡å¯¼ gpt</a></li><li><a href=#-gitea-ç®€ä»‹>ğŸ§© Gitea ç®€ä»‹</a></li><li><a href=#-ç¯å¢ƒå‡†å¤‡>ğŸ§° ç¯å¢ƒå‡†å¤‡</a></li><li><a href=#-å®‰è£…-gitea>ğŸš€ å®‰è£… Gitea</a><ul><li><a href=#-ç¬¬ä¸€æ­¥åˆ›å»º-gitea-ç”¨æˆ·>ğŸ”§ ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Gitea ç”¨æˆ·</a></li><li><a href=#-ç¬¬äºŒæ­¥ä¸‹è½½-gitea>ğŸ”§ ç¬¬äºŒæ­¥ï¼šä¸‹è½½ Gitea</a></li><li><a href=#-ç¬¬ä¸‰æ­¥åˆ›å»ºæ‰€éœ€ç›®å½•>ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæ‰€éœ€ç›®å½•</a></li><li><a href=#-ç¬¬å››æ­¥æ·»åŠ -systemd-æœåŠ¡å¼€æœºè‡ªå¯>ğŸ”§ ç¬¬å››æ­¥ï¼šæ·»åŠ  Systemd æœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰</a></li><li><a href=#-ç¬¬äº”æ­¥å¯åŠ¨æœåŠ¡>ğŸ”§ ç¬¬äº”æ­¥ï¼šå¯åŠ¨æœåŠ¡</a></li><li><a href=#-ç¬¬å…­æ­¥è®¿é—®-web-é¡µé¢é…ç½®>âœ… ç¬¬å…­æ­¥ï¼šè®¿é—® Web é¡µé¢é…ç½®</a></li></ul></li><li><a href=#-å¯é€‰å¼€æ”¾é˜²ç«å¢™ç«¯å£>ğŸŒ å¯é€‰ï¼šå¼€æ”¾é˜²ç«å¢™ç«¯å£</a></li><li><a href=#-åç»­å»ºè®®>ğŸ›¡ï¸ åç»­å»ºè®®</a></li><li><a href=#-å¦‚æœä½ æƒ³>ğŸ§  å¦‚æœä½ æƒ³ï¼š</a></li><li><a href=#éªŒè¯-gpg-ç­¾å><strong>éªŒè¯ GPG ç­¾å</strong></a><ul><li><a href=#å‘½ä»¤è§£é‡Š>å‘½ä»¤è§£é‡Š</a></li><li><a href=#-ç¬¬ä¸€æ­¥>âœ… ç¬¬ä¸€æ­¥ï¼š</a></li><li><a href=#-å«ä¹‰è§£é‡Š>ğŸ” å«ä¹‰è§£é‡Šï¼š</a></li><li><a href=#-ç¬¬äºŒæ­¥>âœ… ç¬¬äºŒæ­¥ï¼š</a></li><li><a href=#-å«ä¹‰è§£é‡Š-1>ğŸ” å«ä¹‰è§£é‡Šï¼š</a></li><li><a href=#-éªŒè¯æˆåŠŸçš„æ ·å­>ğŸ¯ éªŒè¯æˆåŠŸçš„æ ·å­ï¼š</a></li><li><a href=#-é™„gitea-å®˜æ–¹ç­¾åè€…-gpg-æŒ‡çº¹å®Œæ•´>ğŸ§± é™„ï¼šGitea å®˜æ–¹ç­¾åè€… GPG æŒ‡çº¹ï¼ˆå®Œæ•´ï¼‰</a></li><li><a href=#éªŒè¯åˆ¤æ–­>éªŒè¯åˆ¤æ–­</a></li><li><a href=#-éªŒè¯ä¿¡æ¯è§£æ>ğŸ§¾ éªŒè¯ä¿¡æ¯è§£æï¼š</a></li><li><a href=#-å…³äºè­¦å‘Šä¿¡æ¯>âš ï¸ å…³äºè­¦å‘Šä¿¡æ¯ï¼š</a></li><li><a href=#è§£é‡Š>è§£é‡Šï¼š</a></li><li><a href=#-ä½ å¯ä»¥åšçš„äº‹å¯é€‰>ğŸ§  ä½ å¯ä»¥åšçš„äº‹ï¼ˆå¯é€‰ï¼‰ï¼š</a></li><li><a href=#-æœ€ç»ˆç»“è®º>âœ… æœ€ç»ˆç»“è®ºï¼š</a></li></ul></li></ul></li><li><a href=#faq>FAQ</a><ul><li><a href=#é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®>é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®</a></li><li><a href=#3000ç«¯å£ç¦æ­¢è®¿é—®>3000ç«¯å£ç¦æ­¢è®¿é—®</a><ul><li><a href=#æ–¹æ³•ä¸€ä¿®æ”¹-gitea-ç›‘å¬åœ°å€><strong>æ–¹æ³•ä¸€ï¼šä¿®æ”¹ Gitea ç›‘å¬åœ°å€</strong></a></li><li><a href=#æ–¹æ³•äºŒä½¿ç”¨é˜²ç«å¢™è§„åˆ™æ¨èç»„åˆæ–¹æ¡ˆ><strong>æ–¹æ³•äºŒï¼šä½¿ç”¨é˜²ç«å¢™è§„åˆ™ï¼ˆæ¨èç»„åˆæ–¹æ¡ˆï¼‰</strong></a></li><li><a href=#1-æ¸…é™¤åŸæœ‰3000ç«¯å£è§„åˆ™>1. æ¸…é™¤åŸæœ‰3000ç«¯å£è§„åˆ™</a></li><li><a href=#2-è®¾ç½®æ–°è§„åˆ™ä»…å…è®¸æœ¬æœºè®¿é—®>2. è®¾ç½®æ–°è§„åˆ™ï¼ˆä»…å…è®¸æœ¬æœºè®¿é—®ï¼‰</a></li><li><a href=#3-ç”Ÿæ•ˆè§„åˆ™>3. ç”Ÿæ•ˆè§„åˆ™</a></li><li><a href=#æ–¹æ³•ä¸‰nginx-åå‘ä»£ç†éš”ç¦»ç”Ÿäº§ç¯å¢ƒæ¨è><strong>æ–¹æ³•ä¸‰ï¼šNginx åå‘ä»£ç†éš”ç¦»ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</strong></a></li><li><a href=#éªŒè¯é…ç½®æ•ˆæœ><strong>éªŒè¯é…ç½®æ•ˆæœ</strong></a></li><li><a href=#è¡¥å……å®‰å…¨æªæ–½><strong>è¡¥å……å®‰å…¨æªæ–½</strong></a></li></ul></li><li><a href=#frpåå‘ä»£ç†>frpåå‘ä»£ç†</a><ul><li><a href=#åŸºæœ¬é…ç½®>åŸºæœ¬é…ç½®</a></li></ul></li><li><a href=#-ä¸€gitea-é¦–æ¬¡-web-é¡µé¢é…ç½®å®Œæˆåè¿˜èƒ½ä¿®æ”¹å—>ğŸ“Œ ä¸€ã€Gitea é¦–æ¬¡ Web é¡µé¢é…ç½®å®Œæˆåè¿˜èƒ½ä¿®æ”¹å—ï¼Ÿ</a><ul><li><a href=#-é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®>ğŸ“„ é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®ï¼š</a></li><li><a href=#-ä½ å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹çš„å†…å®¹>ğŸ”§ ä½ å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹çš„å†…å®¹ï¼š</a></li></ul></li><li><a href=#-äºŒå¦‚ä½•é€šè¿‡-frp-å°†-gitea-å±€åŸŸç½‘åœ°å€-192168xxxxxx3000-æš´éœ²åˆ°å…¬ç½‘é€šè¿‡ç«¯å£-2222>ğŸ“Œ äºŒã€å¦‚ä½•é€šè¿‡ frp å°† Gitea å±€åŸŸç½‘åœ°å€ <code>192.168.xxx.xxx:3000</code> æš´éœ²åˆ°å…¬ç½‘ï¼ˆé€šè¿‡ç«¯å£ <code>2222</code>ï¼‰ï¼Ÿ</a><ul><li><a href=#-æ–¹æ¡ˆfrp-ç«¯å£æ˜ å°„tcp-ä»£ç†>âœ… æ–¹æ¡ˆï¼šfrp ç«¯å£æ˜ å°„ï¼ˆTCP ä»£ç†ï¼‰</a></li><li><a href=#-1-vpså…¬ç½‘æœåŠ¡å™¨é…ç½®-frpsiniæœåŠ¡ç«¯>ğŸ“Œ 1. VPSï¼ˆå…¬ç½‘æœåŠ¡å™¨ï¼‰é…ç½® <code>frps.ini</code>ï¼ˆæœåŠ¡ç«¯ï¼‰ï¼š</a></li><li><a href=#-2-å±€åŸŸç½‘å†…è¿è¡Œ-gitea-çš„æœºå™¨é…ç½®-frpcini>ğŸ“Œ 2. å±€åŸŸç½‘å†…è¿è¡Œ Gitea çš„æœºå™¨é…ç½® <code>frpc.ini</code>ï¼š</a></li><li><a href=#-ç°åœ¨ä½ å°±å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—®-gitea>ğŸŒ ç°åœ¨ï¼Œä½ å°±å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—® Giteaï¼š</a></li><li><a href=#-è¡¥å……å»ºè®®>ğŸ” è¡¥å……å»ºè®®ï¼š</a></li><li><a href=#é˜»æ­¢frpè®¿é—®>é˜»æ­¢frpè®¿é—®</a></li></ul></li><li><a href=#-å…³é”®ç‚¹è§£é‡Š>ğŸ’¡ å…³é”®ç‚¹è§£é‡Š</a></li><li><a href=#-ç¦ç”¨-frp-è®¿é—®çš„çœŸæ­£è§£å†³æ–¹æ¡ˆ>âœ… ç¦ç”¨ frp è®¿é—®çš„çœŸæ­£è§£å†³æ–¹æ¡ˆ</a><ul><li><a href=#-æ–¹æ³•ä¸€ç›´æ¥ç¦ç”¨-frpc-ä¸­å¯¹-gitea-çš„é…ç½®>âœ… æ–¹æ³•ä¸€ï¼šç›´æ¥ç¦ç”¨ frpc ä¸­å¯¹ Gitea çš„é…ç½®</a></li><li><a href=#-æ–¹æ³•äºŒufw-å±è”½æœ¬æœºé€šè¿‡-lo-è®¿é—®-3000-ç«¯å£å¾ˆç¡¬æ ¸>âœ… æ–¹æ³•äºŒï¼šUFW å±è”½æœ¬æœºé€šè¿‡ <code>lo</code> è®¿é—® 3000 ç«¯å£ï¼ˆå¾ˆç¡¬æ ¸ï¼‰</a></li><li><a href=#-æ–¹æ³•ä¸‰iptables-ç²¾å‡†é˜»æ–­-frp-ç”¨æˆ·æ¨èä¸­é«˜çº§ç”¨æˆ·>âœ… æ–¹æ³•ä¸‰ï¼šiptables ç²¾å‡†é˜»æ–­ frp ç”¨æˆ·ï¼ˆæ¨èä¸­é«˜çº§ç”¨æˆ·ï¼‰</a></li><li><a href=#-æ–¹æ³•å››gitea-é…åˆ-tokenip-æ£€æŸ¥>âœ… æ–¹æ³•å››ï¼šGitea é…åˆ token/IP æ£€æŸ¥</a></li></ul></li><li><a href=#-æ€»ç»“>âœ… æ€»ç»“</a><ul><li><a href=#frpç™½åå•è®¿é—®-gpt>frpç™½åå•è®¿é—®-gpt</a></li></ul></li><li><a href=#-æ–¹æ³•ä¸€ç”¨-nginx-å®ç°-ip-ç™½åå•--token-é‰´æƒ>âœ… æ–¹æ³•ä¸€ï¼šç”¨ Nginx å®ç° IP ç™½åå• + Token é‰´æƒ</a><ul><li><a href=#-step-1-å®‰è£…-nginxå¦‚æœæ²¡è£…>ğŸ”§ Step 1: å®‰è£… Nginxï¼ˆå¦‚æœæ²¡è£…ï¼‰</a></li><li><a href=#-step-2-é…ç½®-nginx-åå‘ä»£ç†--ip-ç™½åå•--token-é™åˆ¶>ğŸ”§ Step 2: é…ç½® Nginx åå‘ä»£ç† + IP ç™½åå• + Token é™åˆ¶</a></li><li><a href=#-ä½¿ç”¨æ–¹å¼>âœ… ä½¿ç”¨æ–¹å¼ï¼š</a></li><li><a href=#-é…ç½®æ¿€æ´»>ğŸ” é…ç½®æ¿€æ´»</a></li></ul></li><li><a href=#-æ–¹æ³•äºŒåœ¨-gitea-ä¹‹ånginx-æˆ–-frp-åŠ è‡ªå®šä¹‰é‰´æƒ>âœ… æ–¹æ³•äºŒï¼šåœ¨ Gitea ä¹‹åï¼ŒNginx æˆ– frp åŠ è‡ªå®šä¹‰é‰´æƒ</a><ul><li><a href=#-frpsini-æ”¯æŒç”¨æˆ·å¯†ç è®¤è¯ä¸æ˜¯-ip-ç™½åå•>ğŸ’¡ frps.ini æ”¯æŒç”¨æˆ·å¯†ç è®¤è¯ï¼ˆä¸æ˜¯ IP ç™½åå•ï¼‰</a></li></ul></li><li><a href=#-æ€»ç»“æ¨è>ğŸš€ æ€»ç»“æ¨è</a><ul><li><a href=#frpç™½åå•è®¿é—®-qwen>frpç™½åå•è®¿é—®-qwen</a></li><li><a href=#1-frp-æœåŠ¡ç«¯é…ç½®ç™½åå•><strong>1. frp æœåŠ¡ç«¯é…ç½®ç™½åå•</strong></a></li><li><a href=#11-é™åˆ¶å®¢æˆ·ç«¯-ip><strong>1.1 é™åˆ¶å®¢æˆ·ç«¯ IP</strong></a></li><li><a href=#12-é™åˆ¶ä»£ç†ç«¯å£><strong>1.2 é™åˆ¶ä»£ç†ç«¯å£</strong></a></li><li><a href=#2-gitea-åº”ç”¨å±‚ç™½åå•><strong>2. Gitea åº”ç”¨å±‚ç™½åå•</strong></a></li><li><a href=#21-ip-ç™½åå•><strong>2.1 IP ç™½åå•</strong></a></li><li><a href=#22-ç¦ç”¨åŒ¿åè®¿é—®><strong>2.2 ç¦ç”¨åŒ¿åè®¿é—®</strong></a></li><li><a href=#3-nginx-åå‘ä»£ç†ç™½åå•å¯é€‰><strong>3. Nginx åå‘ä»£ç†ç™½åå•ï¼ˆå¯é€‰ï¼‰</strong></a></li><li><a href=#4-é˜²ç«å¢™è§„åˆ™ufw><strong>4. é˜²ç«å¢™è§„åˆ™ï¼ˆUFWï¼‰</strong></a></li><li><a href=#5-åŠ¨æ€-ip-ç™½åå•é«˜çº§><strong>5. åŠ¨æ€ IP ç™½åå•ï¼ˆé«˜çº§ï¼‰</strong></a></li><li><a href=#51-frp-token-è®¤è¯><strong>5.1 frp Token è®¤è¯</strong></a></li><li><a href=#52-è‡ªå®šä¹‰è„šæœ¬éªŒè¯><strong>5.2 è‡ªå®šä¹‰è„šæœ¬éªŒè¯</strong></a></li><li><a href=#6-æ—¥å¿—ä¸ç›‘æ§><strong>6. æ—¥å¿—ä¸ç›‘æ§</strong></a></li><li><a href=#61-å®æ—¶ç›‘æ§-frp-è¿æ¥><strong>6.1 å®æ—¶ç›‘æ§ frp è¿æ¥</strong></a></li><li><a href=#62-é…ç½®-fail2ban-é˜²æš´åŠ›ç ´è§£><strong>6.2 é…ç½® Fail2Ban é˜²æš´åŠ›ç ´è§£</strong></a></li><li><a href=#7-æ€»ç»“><strong>7. æ€»ç»“</strong></a></li></ul></li><li><a href=#nginxåå‘ä»£ç†>nginxåå‘ä»£ç†</a><ul><li><a href=#ubuntuå®‰è£…>ubuntuå®‰è£…</a></li><li><a href=#centos7å®‰è£…æ‰‹åŠ¨>centos7å®‰è£…(æ‰‹åŠ¨)</a></li><li><a href=#é…ç½®æ–¹å¼å¯¹æ¯”>é…ç½®æ–¹å¼å¯¹æ¯”</a></li><li><a href=#æ–¹æ¡ˆ-1nginx-å®‰è£…åœ¨å†…ç½‘><strong>æ–¹æ¡ˆ 1ï¼šNginx å®‰è£…åœ¨å†…ç½‘</strong></a></li><li><a href=#æ¶æ„æè¿°><strong>æ¶æ„æè¿°</strong></a></li><li><a href=#é€‚ç”¨åœºæ™¯><strong>é€‚ç”¨åœºæ™¯</strong></a></li><li><a href=#é…ç½®ç¤ºä¾‹><strong>é…ç½®ç¤ºä¾‹</strong></a></li><li><a href=#æ–¹æ¡ˆ-2nginx-å®‰è£…åœ¨å…¬ç½‘><strong>æ–¹æ¡ˆ 2ï¼šNginx å®‰è£…åœ¨å…¬ç½‘</strong></a></li><li><a href=#æ¶æ„æè¿°-1><strong>æ¶æ„æè¿°</strong></a></li><li><a href=#é€‚ç”¨åœºæ™¯-1><strong>é€‚ç”¨åœºæ™¯</strong></a></li><li><a href=#é…ç½®ç¤ºä¾‹-1><strong>é…ç½®ç¤ºä¾‹</strong></a></li><li><a href=#å¯¹æ¯”ä¸¤ç§æ–¹æ¡ˆ><strong>å¯¹æ¯”ä¸¤ç§æ–¹æ¡ˆ</strong></a></li><li><a href=#æ¨èé€‰æ‹©><strong>æ¨èé€‰æ‹©</strong></a></li><li><a href=#æ€»ç»“><strong>æ€»ç»“</strong></a></li><li><a href=#è‡ªç­¾åè¯ä¹¦>è‡ªç­¾åè¯ä¹¦</a></li><li><a href=#ä¸€nginx-é…ç½®æ ¸å¿ƒç»“è®º><strong>ä¸€ã€Nginx é…ç½®æ ¸å¿ƒç»“è®º</strong></a></li><li><a href=#äºŒçº¯å…¬ç½‘-ip-é…ç½®æ–¹æ¡ˆ><strong>äºŒã€çº¯å…¬ç½‘ IP é…ç½®æ–¹æ¡ˆ</strong></a></li><li><a href=#1-åŸºç¡€-http-é…ç½®ç¤ºä¾‹><strong>1. åŸºç¡€ HTTP é…ç½®ç¤ºä¾‹</strong></a></li><li><a href=#2-éªŒè¯é…ç½®><strong>2. éªŒè¯é…ç½®</strong></a></li><li><a href=#3-è®¿é—®æ–¹å¼><strong>3. è®¿é—®æ–¹å¼</strong></a></li><li><a href=#ä¸‰æ½œåœ¨é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ><strong>ä¸‰ã€æ½œåœ¨é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</strong></a></li><li><a href=#å››æ¨èæ”¹è¿›æ–¹æ¡ˆ><strong>å››ã€æ¨èæ”¹è¿›æ–¹æ¡ˆ</strong></a></li><li><a href=#æ–¹æ¡ˆ-1è‡ªç­¾åè¯ä¹¦--https><strong>æ–¹æ¡ˆ 1ï¼šè‡ªç­¾åè¯ä¹¦ + HTTPS</strong></a></li><li><a href=#æ–¹æ¡ˆ-2å…è´¹åŸŸå--let><strong>æ–¹æ¡ˆ 2ï¼šå…è´¹åŸŸå + Let&rsquo;s Encrypt</strong></a></li><li><a href=#äº”é˜²ç«å¢™é…ç½®><strong>äº”ã€é˜²ç«å¢™é…ç½®</strong></a></li><li><a href=#å…­æ€§èƒ½å¯¹æ¯”><strong>å…­ã€æ€§èƒ½å¯¹æ¯”</strong></a></li><li><a href=#ä¸ƒæ“ä½œå»ºè®®><strong>ä¸ƒã€æ“ä½œå»ºè®®</strong></a></li><li><a href=#é…ç½®æµç¨‹-deepseek>é…ç½®æµç¨‹ deepseek</a></li><li><a href=#ä¸€æ¶æ„è¯´æ˜>ä¸€ã€æ¶æ„è¯´æ˜</a></li><li><a href=#äºŒå…¬ç½‘æœåŠ¡å™¨é…ç½®centos>äºŒã€å…¬ç½‘æœåŠ¡å™¨é…ç½®ï¼ˆCentOSï¼‰</a></li><li><a href=#1-å®‰è£…ä¾èµ–>1. å®‰è£…ä¾èµ–</a></li><li><a href=#2-å®‰è£…é…ç½®-frp-æœåŠ¡ç«¯>2. å®‰è£…é…ç½® frp æœåŠ¡ç«¯</a></li><li><a href=#3-é…ç½®-systemd-æœåŠ¡>3. é…ç½® systemd æœåŠ¡</a></li><li><a href=#4-é˜²ç«å¢™å¼€æ”¾ç«¯å£>4. é˜²ç«å¢™å¼€æ”¾ç«¯å£</a></li><li><a href=#ä¸‰nginx-é…ç½®ssl-åå‘ä»£ç†>ä¸‰ã€Nginx é…ç½®ï¼ˆSSL åå‘ä»£ç†ï¼‰</a></li><li><a href=#1-å®‰è£…-nginx>1. å®‰è£… Nginx</a></li><li><a href=#2-ç”³è¯·-ssl-è¯ä¹¦lets-encrypt>2. ç”³è¯· SSL è¯ä¹¦ï¼ˆLet&rsquo;s Encryptï¼‰</a></li><li><a href=#3-é…ç½®åå‘ä»£ç†>3. é…ç½®åå‘ä»£ç†</a></li><li><a href=#å››å†…ç½‘æœåŠ¡å™¨é…ç½®gitea--frp-å®¢æˆ·ç«¯>å››ã€å†…ç½‘æœåŠ¡å™¨é…ç½®ï¼ˆGitea + frp å®¢æˆ·ç«¯ï¼‰</a></li><li><a href=#1-å®‰è£…-gitea>1. å®‰è£… Gitea</a></li><li><a href=#2-é…ç½®-systemd-æœåŠ¡>2. é…ç½® systemd æœåŠ¡</a></li><li><a href=#3-é…ç½®-frp-å®¢æˆ·ç«¯>3. é…ç½® frp å®¢æˆ·ç«¯</a></li><li><a href=#4-é…ç½®å®¢æˆ·ç«¯æœåŠ¡>4. é…ç½®å®¢æˆ·ç«¯æœåŠ¡</a></li><li><a href=#äº”gitea-å…³é”®é…ç½®>äº”ã€Gitea å…³é”®é…ç½®</a></li><li><a href=#å…­éªŒè¯ä¸ç»´æŠ¤>å…­ã€éªŒè¯ä¸ç»´æŠ¤</a></li><li><a href=#1-æœåŠ¡çŠ¶æ€æ£€æŸ¥>1. æœåŠ¡çŠ¶æ€æ£€æŸ¥</a></li><li><a href=#2-æ—¥å¿—ç›‘æ§>2. æ—¥å¿—ç›‘æ§</a></li><li><a href=#3-é˜²ç«å¢™çŠ¶æ€æ£€æŸ¥>3. é˜²ç«å¢™çŠ¶æ€æ£€æŸ¥</a></li><li><a href=#4-è¯ä¹¦è‡ªåŠ¨ç»­ç­¾>4. è¯ä¹¦è‡ªåŠ¨ç»­ç­¾</a></li><li><a href=#ä¸ƒæ•…éšœæ’æŸ¥æŒ‡å—>ä¸ƒã€æ•…éšœæ’æŸ¥æŒ‡å—</a></li><li><a href=#è¯¦ç»†é…ç½®>è¯¦ç»†é…ç½®</a></li><li><a href=#åŸŸåè®¿é—®>åŸŸåè®¿é—®</a></li><li><a href=#ä¸€æ ¸å¿ƒæ€è·¯><strong>ä¸€ã€æ ¸å¿ƒæ€è·¯</strong></a></li><li><a href=#äºŒæ“ä½œæ­¥éª¤><strong>äºŒã€æ“ä½œæ­¥éª¤</strong></a></li><li><a href=#1-è®¾ç½®æœ¬åœ°-dns-è§£æ><strong>1. è®¾ç½®æœ¬åœ° DNS è§£æ</strong></a></li><li><a href=#windows-ç³»ç»Ÿ>Windows ç³»ç»Ÿï¼š</a></li><li><a href=#linuxmacos-ç³»ç»Ÿ>Linux/macOS ç³»ç»Ÿï¼š</a></li><li><a href=#2-ç”Ÿæˆè‡ªç­¾åè¯ä¹¦><strong>2. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</strong></a></li><li><a href=#3-é…ç½®-nginx><strong>3. é…ç½® Nginx</strong></a></li><li><a href=#4-è°ƒæ•´-gitea-é…ç½®><strong>4. è°ƒæ•´ Gitea é…ç½®</strong></a></li><li><a href=#ä¸‰éªŒè¯è®¿é—®><strong>ä¸‰ã€éªŒè¯è®¿é—®</strong></a></li><li><a href=#å››é«˜çº§é…ç½®å¯é€‰><strong>å››ã€é«˜çº§é…ç½®ï¼ˆå¯é€‰ï¼‰</strong></a></li><li><a href=#1-å†…ç½‘-dns-æœåŠ¡å™¨é…ç½®><strong>1. å†…ç½‘ DNS æœåŠ¡å™¨é…ç½®</strong></a></li><li><a href=#2-è¯ä¹¦ä¿¡ä»»é…ç½®æ¶ˆé™¤æµè§ˆå™¨è­¦å‘Š><strong>2. è¯ä¹¦ä¿¡ä»»é…ç½®ï¼ˆæ¶ˆé™¤æµè§ˆå™¨è­¦å‘Šï¼‰</strong></a></li><li><a href=#3-å¤šåŸŸåæ”¯æŒ><strong>3. å¤šåŸŸåæ”¯æŒ</strong></a></li><li><a href=#äº”å¸¸è§é—®é¢˜æ’æŸ¥><strong>äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥</strong></a></li><li><a href=#å…­ç”Ÿäº§ç¯å¢ƒå»ºè®®><strong>å…­ã€ç”Ÿäº§ç¯å¢ƒå»ºè®®</strong></a></li></ul></li><li><a href=#frp-vs-nginx>frp vs. nginx</a><ul><li><a href=#deepseek>deepseek</a></li><li><a href=#æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨><strong>æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨</strong></a></li><li><a href=#ä¸€åŠŸèƒ½å®šä½å·®å¼‚><strong>ä¸€ã€åŠŸèƒ½å®šä½å·®å¼‚</strong></a></li><li><a href=#nginx-åå‘ä»£ç†><strong>Nginx åå‘ä»£ç†</strong></a></li><li><a href=#frp-åå‘ä»£ç†><strong>frp åå‘ä»£ç†</strong></a></li><li><a href=#äºŒå®‰å…¨æ¨¡å‹å¯¹æ¯”><strong>äºŒã€å®‰å…¨æ¨¡å‹å¯¹æ¯”</strong></a></li><li><a href=#nginx-å®‰å…¨å¢å¼º><strong>Nginx å®‰å…¨å¢å¼º</strong></a></li><li><a href=#frp-å®‰å…¨è€ƒè™‘><strong>frp å®‰å…¨è€ƒè™‘</strong></a></li><li><a href=#ä¸‰æ€§èƒ½è¡¨ç°å·®å¼‚><strong>ä¸‰ã€æ€§èƒ½è¡¨ç°å·®å¼‚</strong></a></li><li><a href=#å››éƒ¨ç½²æ¶æ„å¯¹æ¯”><strong>å››ã€éƒ¨ç½²æ¶æ„å¯¹æ¯”</strong></a></li><li><a href=#nginx-å…¸å‹æ¶æ„><strong>Nginx å…¸å‹æ¶æ„</strong></a></li><li><a href=#frp-å…¸å‹æ¶æ„><strong>frp å…¸å‹æ¶æ„</strong></a></li><li><a href=#äº”é€‰å‹å»ºè®®><strong>äº”ã€é€‰å‹å»ºè®®</strong></a></li><li><a href=#é€‰æ‹©-nginx-å½“><strong>é€‰æ‹© Nginx å½“</strong>ï¼š</a></li><li><a href=#é€‰æ‹©-frp-å½“><strong>é€‰æ‹© frp å½“</strong>ï¼š</a></li><li><a href=#æ··åˆæ–¹æ¡ˆæœ€ä½³å®è·µ><strong>æ··åˆæ–¹æ¡ˆï¼ˆæœ€ä½³å®è·µï¼‰</strong>ï¼š</a></li><li><a href=#å…­ç»´æŠ¤æˆæœ¬å¯¹æ¯”><strong>å…­ã€ç»´æŠ¤æˆæœ¬å¯¹æ¯”</strong></a></li><li><a href=#qwen>qwen</a></li><li><a href=#å‰ææ¡ä»¶><strong>å‰ææ¡ä»¶</strong></a></li><li><a href=#é…ç½®æ­¥éª¤><strong>é…ç½®æ­¥éª¤</strong></a></li><li><a href=#åœºæ™¯-1nginx-ä¸-gitea-åœ¨åŒä¸€å†…ç½‘><strong>åœºæ™¯ 1ï¼šNginx ä¸ Gitea åœ¨åŒä¸€å†…ç½‘</strong></a></li><li><a href=#åœºæ™¯-2nginx-åœ¨å…¬ç½‘gitea-åœ¨å†…ç½‘é€šè¿‡-frp-ç©¿é€><strong>åœºæ™¯ 2ï¼šNginx åœ¨å…¬ç½‘ï¼ŒGitea åœ¨å†…ç½‘ï¼ˆé€šè¿‡ frp ç©¿é€ï¼‰</strong></a></li><li><a href=#æ³¨æ„äº‹é¡¹><strong>æ³¨æ„äº‹é¡¹</strong></a></li><li><a href=#å¸¸è§é—®é¢˜><strong>å¸¸è§é—®é¢˜</strong></a></li><li><a href=#q1nginx-æŠ¥é”™><strong>Q1ï¼šNginx æŠ¥é”™ <code>502 Bad Gateway</code></strong></a></li><li><a href=#q2gitea-é¡µé¢èµ„æºåŠ è½½å¤±è´¥><strong>Q2ï¼šGitea é¡µé¢èµ„æºåŠ è½½å¤±è´¥</strong></a></li><li><a href=#æ€»ç»“-1><strong>æ€»ç»“</strong></a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=æ–‡æ¡£>æ–‡æ¡£</h1><p><a href=https://docs.gitea.com/zh-cn/category/installation target=_blank rel="noopener noreffer">https://docs.gitea.com/zh-cn/category/installation</a></p><p><a href=https://dl.gitea.com/gitea/1.23.7/ target=_blank rel="noopener noreffer">https://dl.gitea.com/gitea/1.23.7/</a></p><h1 id=å®‰è£…äºŒè¿›åˆ¶>å®‰è£…ï¼ˆäºŒè¿›åˆ¶ï¼‰</h1><p><a href=https://docs.gitea.com/zh-cn/installation/install-from-binary target=_blank rel="noopener noreffer">https://docs.gitea.com/zh-cn/installation/install-from-binary</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ç¯å¢ƒå‡†å¤‡</span>
</span></span><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install git wget sqlite3 -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># giteaä¸‹è½½</span>
</span></span><span class=line><span class=cl>wget -O gitea https://dl.gitea.com/gitea/1.23.7/gitea-1.23.7-linux-amd64 <span class=c1># -O write documents to FILE</span>
</span></span><span class=line><span class=cl>wget gitea https://dl.gitea.com/gitea/1.23.7/gitea-1.23.7-linux-amd64.asc
</span></span><span class=line><span class=cl>chmod +x gitea
</span></span><span class=line><span class=cl>sudo cp gitea /usr/local/bin/gitea
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># éªŒè¯GPGç­¾å[å¯é€‰]</span>
</span></span><span class=line><span class=cl>gpg --keyserver keys.openpgp.org --recv 7C9E68152594688862D62AF62D9AE806EC1592E2
</span></span><span class=line><span class=cl>gpg --verify gitea-1.23.7-linux-amd64.asc gitea
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºå·¥ä½œè·¯å¾„</span>
</span></span><span class=line><span class=cl>sudo mkdir -p /var/lib/gitea/<span class=o>{</span>custom,data,log<span class=o>}</span>
</span></span><span class=line><span class=cl>sudo chown -R git:git /var/lib/gitea/
</span></span><span class=line><span class=cl>sudo chmod -R <span class=m>750</span> /var/lib/gitea/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo mkdir /etc/gitea
</span></span><span class=line><span class=cl>sudo chown root:git /etc/gitea
</span></span><span class=line><span class=cl>sudo chmod <span class=m>770</span> /etc/gitea
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç½‘é¡µé…ç½®å®Œæˆåæ‰§è¡Œ</span>
</span></span><span class=line><span class=cl>chmod <span class=m>750</span> /etc/gitea
</span></span><span class=line><span class=cl>chmod <span class=m>640</span> /etc/gitea/app.ini
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»º Gitea ç”¨æˆ·</span>
</span></span><span class=line><span class=cl>sudo adduser <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   --system <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   --shell /bin/bash <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   --gecos <span class=s1>&#39;Git Version Control&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   --group <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   --disabled-password <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   --home /home/git <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>   git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ·»åŠ  Systemd æœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰   </span>
</span></span><span class=line><span class=cl>sudo tee /etc/systemd/system/gitea.service &gt; /dev/null <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>[Unit]
</span></span></span><span class=line><span class=cl><span class=s>Description=Gitea (Git with a cup of tea)
</span></span></span><span class=line><span class=cl><span class=s>After=syslog.target
</span></span></span><span class=line><span class=cl><span class=s>After=network.target
</span></span></span><span class=line><span class=cl><span class=s>Requires=network.target
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Service]
</span></span></span><span class=line><span class=cl><span class=s>RestartSec=2s
</span></span></span><span class=line><span class=cl><span class=s>Type=simple
</span></span></span><span class=line><span class=cl><span class=s>User=git
</span></span></span><span class=line><span class=cl><span class=s>Group=git
</span></span></span><span class=line><span class=cl><span class=s>WorkingDirectory=/var/lib/gitea/
</span></span></span><span class=line><span class=cl><span class=s>ExecStart=/usr/local/bin/gitea web --config /etc/gitea/app.ini
</span></span></span><span class=line><span class=cl><span class=s>Restart=always
</span></span></span><span class=line><span class=cl><span class=s>Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/var/lib/gitea
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Install]
</span></span></span><span class=line><span class=cl><span class=s>WantedBy=multi-user.target
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯åŠ¨æœåŠ¡</span>
</span></span><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now gitea
</span></span><span class=line><span class=cl>sudo systemctl status gitea  <span class=c1># æ£€æŸ¥æœåŠ¡çŠ¶æ€</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¿é—® Web é¡µé¢é…ç½®</span>
</span></span><span class=line><span class=cl>æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
</span></span><span class=line><span class=cl>ğŸ“ http://&lt;ä½ çš„æœåŠ¡å™¨IP&gt;:3000
</span></span><span class=line><span class=cl>/etc/gitea/app.ini <span class=c1># é…ç½®æ–‡ä»¶é»˜è®¤è·¯å¾„</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯é€‰ï¼šå¼€æ”¾é˜²ç«å¢™ç«¯å£</span>
</span></span><span class=line><span class=cl>sudo ufw allow <span class=m>3000</span> <span class=c1># æˆ–æ”¾åœ¨ Nginx åé¢ä½¿ç”¨ 80/443</span>
</span></span><span class=line><span class=cl>sudo ufw status
</span></span><span class=line><span class=cl>sudo systemctl restart gitea <span class=c1># é‡å¯ Gitea	</span>
</span></span></code></pre></div><h2 id=å®‰è£…æŒ‡å¯¼-gpt>å®‰è£…æŒ‡å¯¼ gpt</h2><p>ä¸‹é¢æ˜¯åœ¨ <strong>Ubuntu ä¸Šéƒ¨ç½² Giteaï¼ˆç§æœ‰ Git å¹³å°ï¼‰</strong> çš„è¶…æ¸…æ™°æ­¥éª¤ï¼Œè½»é‡å¥½ç”¨ï¼Œé€‚åˆä¸ªäººå’Œå°å›¢é˜Ÿï¼Œå‡ å MB å°±èƒ½è·‘ï¼Œå‡ åˆ†é’Ÿæå®šï¼ğŸ’»ğŸš€</p><hr><h2 id=-gitea-ç®€ä»‹>ğŸ§© Gitea ç®€ä»‹</h2><ul><li>ç±»ä¼¼ GitHubï¼Œæ”¯æŒç§æœ‰ä»“åº“ã€Web ç•Œé¢ã€SSH/HTTP è®¿é—®ã€æƒé™æ§åˆ¶</li><li>æè½»é‡ï¼ˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œè¶…é€‚åˆè‡ªç”¨</li><li>å®˜ç½‘ï¼š<a href=https://gitea.io/ target=_blank rel="noopener noreffer">https://gitea.io</a></li></ul><hr><h2 id=-ç¯å¢ƒå‡†å¤‡>ğŸ§° ç¯å¢ƒå‡†å¤‡</h2><p>å»ºè®®ç³»ç»Ÿï¼šUbuntu 20.04+</p><p>ä½ åªéœ€è¦å®‰è£…ä»¥ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install git wget sqlite3 -y
</span></span></code></pre></div><blockquote><p>é»˜è®¤ç”¨ SQLite å­˜æ•°æ®åº“ï¼ˆè½»é‡ï¼‰ï¼Œä¹Ÿæ”¯æŒ MySQL / PostgreSQLã€‚</p></blockquote><hr><h2 id=-å®‰è£…-gitea>ğŸš€ å®‰è£… Gitea</h2><h3 id=-ç¬¬ä¸€æ­¥åˆ›å»º-gitea-ç”¨æˆ·>ğŸ”§ ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Gitea ç”¨æˆ·</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo adduser <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --system <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --shell /bin/bash <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --gecos <span class=s1>&#39;Git Version Control&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --group <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --disabled-password <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --home /home/git <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  git
</span></span></code></pre></div><hr><h3 id=-ç¬¬äºŒæ­¥ä¸‹è½½-gitea>ğŸ”§ ç¬¬äºŒæ­¥ï¼šä¸‹è½½ Gitea</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget -O gitea https://dl.gitea.io/gitea/latest/gitea-linux-amd64
</span></span><span class=line><span class=cl>chmod +x gitea
</span></span><span class=line><span class=cl>sudo mv gitea /usr/local/bin/gitea
</span></span></code></pre></div><hr><h3 id=-ç¬¬ä¸‰æ­¥åˆ›å»ºæ‰€éœ€ç›®å½•>ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæ‰€éœ€ç›®å½•</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir -p /var/lib/gitea/<span class=o>{</span>custom,data,log<span class=o>}</span>
</span></span><span class=line><span class=cl>sudo chown -R git:git /var/lib/gitea/
</span></span><span class=line><span class=cl>sudo chmod -R <span class=m>750</span> /var/lib/gitea/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo mkdir /etc/gitea
</span></span><span class=line><span class=cl>sudo chown root:git /etc/gitea
</span></span><span class=line><span class=cl>sudo chmod <span class=m>770</span> /etc/gitea
</span></span></code></pre></div><hr><h3 id=-ç¬¬å››æ­¥æ·»åŠ -systemd-æœåŠ¡å¼€æœºè‡ªå¯>ğŸ”§ ç¬¬å››æ­¥ï¼šæ·»åŠ  Systemd æœåŠ¡ï¼ˆå¼€æœºè‡ªå¯ï¼‰</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo tee /etc/systemd/system/gitea.service &gt; /dev/null <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>[Unit]
</span></span></span><span class=line><span class=cl><span class=s>Description=Gitea (Git with a cup of tea)
</span></span></span><span class=line><span class=cl><span class=s>After=syslog.target
</span></span></span><span class=line><span class=cl><span class=s>After=network.target
</span></span></span><span class=line><span class=cl><span class=s>Requires=network.target
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Service]
</span></span></span><span class=line><span class=cl><span class=s>RestartSec=2s
</span></span></span><span class=line><span class=cl><span class=s>Type=simple
</span></span></span><span class=line><span class=cl><span class=s>User=git
</span></span></span><span class=line><span class=cl><span class=s>Group=git
</span></span></span><span class=line><span class=cl><span class=s>WorkingDirectory=/var/lib/gitea/
</span></span></span><span class=line><span class=cl><span class=s>ExecStart=/usr/local/bin/gitea web --config /etc/gitea/app.ini
</span></span></span><span class=line><span class=cl><span class=s>Restart=always
</span></span></span><span class=line><span class=cl><span class=s>Environment=USER=git HOME=/home/git GITEA_WORK_DIR=/var/lib/gitea
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Install]
</span></span></span><span class=line><span class=cl><span class=s>WantedBy=multi-user.target
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><hr><h3 id=-ç¬¬äº”æ­¥å¯åŠ¨æœåŠ¡>ğŸ”§ ç¬¬äº”æ­¥ï¼šå¯åŠ¨æœåŠ¡</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl daemon-reexec
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now gitea
</span></span></code></pre></div><hr><h3 id=-ç¬¬å…­æ­¥è®¿é—®-web-é¡µé¢é…ç½®>âœ… ç¬¬å…­æ­¥ï¼šè®¿é—® Web é¡µé¢é…ç½®</h3><p>æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š</p><p>ğŸ“ <code>http://&lt;ä½ çš„æœåŠ¡å™¨IP>:3000</code></p><p>é¦–æ¬¡è¿›å…¥å®‰è£…ç•Œé¢ï¼Œå¡«å†™ï¼š</p><ul><li>æ•°æ®åº“ï¼šSQLiteï¼ˆé»˜è®¤ï¼‰</li><li>ä»“åº“è·¯å¾„ï¼š<code>/var/lib/gitea/data/gitea-repositories</code></li><li>åº”ç”¨è·¯å¾„ï¼š<code>/usr/local/bin/gitea</code></li><li>é…ç½®æ–‡ä»¶ï¼š<code>/etc/gitea/app.ini</code></li><li>ç®¡ç†å‘˜è´¦æˆ·ï¼šè®¾ç½®ä½ è‡ªå·±çš„ç”¨æˆ·åå’Œå¯†ç </li></ul><hr><h2 id=-å¯é€‰å¼€æ”¾é˜²ç«å¢™ç«¯å£>ğŸŒ å¯é€‰ï¼šå¼€æ”¾é˜²ç«å¢™ç«¯å£</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow <span class=m>3000</span>
</span></span></code></pre></div><p>æˆ–æ”¾åœ¨ Nginx åé¢ä½¿ç”¨ 80/443</p><hr><h2 id=-åç»­å»ºè®®>ğŸ›¡ï¸ åç»­å»ºè®®</h2><table><thead><tr><th>æ“ä½œ</th><th>å‘½ä»¤</th></tr></thead><tbody><tr><td>é‡å¯ Gitea</td><td><code>sudo systemctl restart gitea</code></td></tr><tr><td>æŸ¥çœ‹æ—¥å¿—</td><td><code>journalctl -u gitea -f</code></td></tr><tr><td>Gitea é…ç½®æ–‡ä»¶</td><td><code>/etc/gitea/app.ini</code></td></tr><tr><td>ä»“åº“å­˜å‚¨è·¯å¾„</td><td><code>/var/lib/gitea/data/gitea-repositories</code></td></tr></tbody></table><hr><h2 id=-å¦‚æœä½ æƒ³>ğŸ§  å¦‚æœä½ æƒ³ï¼š</h2><ul><li>ç”¨ HTTPS â†’ å¯ç”¨ Nginx åä»£ + Let&rsquo;s Encrypt</li><li>æ•°æ®åº“æŒä¹…åŒ– â†’ æ¢æˆ MySQL/PostgreSQL</li><li>å¤šäººåä½œ â†’ ç®¡ç†ç”¨æˆ·ã€ç»„ç»‡ã€æƒé™åˆ†ç»„</li></ul><p>æˆ‘å¯ä»¥ç»§ç»­å¸®ä½ ä¸€æ­¥æ­¥é…ç½®ã€‚</p><hr><p>éœ€è¦æˆ‘ç»™ä½ é…ä¸€ä»½ <strong>Nginx + åŸŸå + SSL çš„å®Œæ•´é…ç½®è„šæœ¬</strong> å—ï¼Ÿæˆ–è€…ç›´æ¥å°è£…ä¸º Docker æ–¹æ¡ˆï¼Ÿä¹Ÿå¯ä»¥ï¼</p><h2 id=éªŒè¯-gpg-ç­¾å><strong>éªŒè¯ GPG ç­¾å</strong></h2><h3 id=å‘½ä»¤è§£é‡Š>å‘½ä»¤è§£é‡Š</h3><p>è¿™ä¸¤æ¡å‘½ä»¤æ˜¯ç”¨æ¥ <strong>éªŒè¯ Gitea å®‰è£…æ–‡ä»¶ GPG ç­¾å</strong> çš„å…³é”®æ­¥éª¤ã€‚ä¸‹é¢æ¥ä¸€æ¡ä¸€æ¡åœ°è¯¦ç»†è§£é‡Šï¼š</p><hr><h3 id=-ç¬¬ä¸€æ­¥>âœ… ç¬¬ä¸€æ­¥ï¼š</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpg --keyserver keys.openpgp.org --recv 7C9E68152594688862D62AF62D9AE806EC1592E2
</span></span></code></pre></div><h3 id=-å«ä¹‰è§£é‡Š>ğŸ” å«ä¹‰è§£é‡Šï¼š</h3><table><thead><tr><th>éƒ¨åˆ†</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>gpg</code></td><td>GnuPGï¼ˆGNU Privacy Guardï¼‰å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåŠ å¯†ã€è§£å¯†ã€ç­¾åã€éªŒè¯ç­‰</td></tr><tr><td><code>--keyserver keys.openpgp.org</code></td><td>æŒ‡å®šè¦ä»å“ªä¸ª GPG å…¬é’¥æœåŠ¡å™¨æ‹‰å–å¯†é’¥ï¼Œè¿™é‡Œæ˜¯ <code>keys.openpgp.org</code></td></tr><tr><td><code>--recv</code></td><td>è¡¨ç¤ºä»æœåŠ¡å™¨æ¥æ”¶ï¼ˆå¯¼å…¥ï¼‰å…¬é’¥</td></tr><tr><td><code>7C9E68152594688862D62AF62D9AE806EC1592E2</code></td><td>Gitea å®˜æ–¹å‘å¸ƒç­¾åæ‰€ç”¨çš„ GPG å…¬é’¥çš„ Key IDï¼ˆæˆ–è€…ç§° fingerprintï¼‰</td></tr></tbody></table><blockquote><p>ğŸ“Œ ç®€å•è¯´ï¼Œè¿™æ¡å‘½ä»¤å°±æ˜¯ï¼šä» GPG å…¬é’¥æœåŠ¡å™¨ä¸‹è½½ Gitea å‘å¸ƒè€…çš„ç­¾åå…¬é’¥ï¼Œä»¥ä¾¿ä¹‹åèƒ½éªŒè¯ç­¾åæ˜¯å¦åˆæ³•ã€‚</p></blockquote><hr><h3 id=-ç¬¬äºŒæ­¥>âœ… ç¬¬äºŒæ­¥ï¼š</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpg --verify gitea-1.23.7-linux-amd64.asc gitea-1.23.7-linux-amd64
</span></span></code></pre></div><h3 id=-å«ä¹‰è§£é‡Š-1>ğŸ” å«ä¹‰è§£é‡Šï¼š</h3><table><thead><tr><th>éƒ¨åˆ†</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>gpg</code></td><td>è°ƒç”¨ GnuPG å·¥å…·</td></tr><tr><td><code>--verify</code></td><td>è¡¨ç¤ºâ€œéªŒè¯ç­¾åâ€</td></tr><tr><td><code>gitea-1.23.7-linux-amd64.asc</code></td><td>è¿™æ˜¯ Gitea äºŒè¿›åˆ¶çš„ç­¾åæ–‡ä»¶</td></tr><tr><td><code>gitea-1.23.7-linux-amd64</code></td><td>è¿™æ˜¯è¢«ç­¾åçš„ä¸»ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰</td></tr></tbody></table><blockquote><p>ğŸ“Œ è¿™æ¡å‘½ä»¤æ˜¯ï¼šç”¨åˆšå¯¼å…¥çš„ GPG å…¬é’¥å»éªŒè¯ .asc æ–‡ä»¶ä¸­çš„ç­¾åæ˜¯å¦ä¸ä¸‹è½½çš„ Gitea ä¸»ç¨‹åºä¸€è‡´ã€æœªè¢«ç¯¡æ”¹ã€‚</p></blockquote><hr><h3 id=-éªŒè¯æˆåŠŸçš„æ ·å­>ğŸ¯ éªŒè¯æˆåŠŸçš„æ ·å­ï¼š</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpg: Signature made ... using RSA key ...
</span></span><span class=line><span class=cl>gpg: Good signature from <span class=s2>&#34;Gitea &lt;gitea@...&gt;&#34;</span> <span class=o>[</span>unknown<span class=o>]</span>
</span></span></code></pre></div><p>âœ… è¡¨ç¤ºç­¾ååˆæ³•ã€æ–‡ä»¶æ²¡è¢«ç¯¡æ”¹ã€‚</p><hr><h3 id=-é™„gitea-å®˜æ–¹ç­¾åè€…-gpg-æŒ‡çº¹å®Œæ•´>ğŸ§± é™„ï¼šGitea å®˜æ–¹ç­¾åè€… GPG æŒ‡çº¹ï¼ˆå®Œæ•´ï¼‰</h3><pre tabindex=0><code>7C9E 6815 2594 6888 62D6 2AF6 2D9A E806 EC15 92E2
</code></pre><p>æ¥è‡ª Gitea å®˜æ–¹çš„å‘å¸ƒè€…ï¼š<a href=https://gitea.com/gitea/gitea/releases target=_blank rel="noopener noreffer">https://gitea.com/gitea/gitea/releases</a></p><hr><p>å¦‚æœä½ è¿˜æƒ³ï¼š</p><ul><li>éªŒè¯ GPG å…¬é’¥çš„å®‰å…¨æ€§ï¼ˆæ¯”å¦‚ä»å¤šä¸ªæ¸ é“æ¯”å¯¹æŒ‡çº¹ï¼‰</li><li>æŠŠè¿™å¥—æµç¨‹å†™å…¥è‡ªåŠ¨è„šæœ¬</li><li>ç”¨ Docker é•œåƒç­¾åéªŒè¯æ–¹å¼</li></ul><p>æˆ‘ä¹Ÿå¯ä»¥ç»§ç»­å¸®ä½ æ•´ç† âœ…</p><h3 id=éªŒè¯åˆ¤æ–­>éªŒè¯åˆ¤æ–­</h3><p>æ˜¯çš„ âœ…ï¼Œä½ è¿™æ¬¡ GPG éªŒè¯æ˜¯ <strong>æˆåŠŸçš„</strong>ï¼Œä¸‹é¢æ¥è¯¦ç»†æ‹†è§£ä¸€ä¸‹è¾“å‡ºï¼š</p><hr><h3 id=-éªŒè¯ä¿¡æ¯è§£æ>ğŸ§¾ éªŒè¯ä¿¡æ¯è§£æï¼š</h3><pre tabindex=0><code>gpg: Signature made 2025å¹´04æœˆ08æ—¥ æ˜ŸæœŸäºŒ 03æ—¶26åˆ†24ç§’ CST
gpg:                using RSA key CC64B1DB67ABBEECAB24B6455FC346329753F4B0
gpg: Good signature from &#34;Teabot &lt;teabot@gitea.io&gt;&#34; [unknown]
</code></pre><ul><li>âœ… <strong>â€œGood signatureâ€</strong> æ˜¯å…³é”®ï¼šè¡¨ç¤ºç­¾åæ–‡ä»¶ç¡®å®æ˜¯ç”¨è¯¥ GPG å¯†é’¥å¯¹ä½ ä¸‹è½½çš„æ–‡ä»¶ç­¾åçš„ï¼Œå¹¶ä¸”éªŒè¯é€šè¿‡ã€‚</li><li>ğŸ”‘ ä½¿ç”¨çš„å­å¯†é’¥ <code>CC64...F4B0</code> æ­£æ˜¯ Gitea å‘å¸ƒå…¬é’¥çš„<strong>å­å¯†é’¥</strong>ï¼Œç”¨äºä»£ç ç­¾åã€‚</li></ul><hr><h3 id=-å…³äºè­¦å‘Šä¿¡æ¯>âš ï¸ å…³äºè­¦å‘Šä¿¡æ¯ï¼š</h3><pre tabindex=0><code>gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
</code></pre><h3 id=è§£é‡Š>è§£é‡Šï¼š</h3><p>è¿™æ®µæç¤ºçš„æ„æ€æ˜¯ï¼š</p><ul><li>ä½  <strong>å°šæœªä¿¡ä»»ï¼ˆsignï¼‰è¿™ä¸ªå…¬é’¥</strong>ï¼Œæ‰€ä»¥ GPG æ— æ³•åˆ¤æ–­â€œTeabot <a href=mailto:teabot@gitea.io rel>teabot@gitea.io</a>â€è¿™ä¸ªèº«ä»½æ˜¯å¦å¯ä¿¡ã€‚</li><li>ä¸å½±å“éªŒè¯æ­£ç¡®æ€§ï¼Œåªæ˜¯æé†’ä½ ï¼š<strong>ä½ è¦è‡ªå·±ç¡®è®¤è¯¥å¯†é’¥æ˜¯ä¸æ˜¯ Gitea å®˜æ–¹çš„å¯†é’¥</strong>ã€‚</li></ul><blockquote><p>å°±åƒæœ‹å‹å¾®ä¿¡å‘ä½ æ–‡ä»¶ï¼Œä½ å¯ä»¥éªŒè¯æ˜¯æœ‹å‹è´¦å·å‘çš„ï¼Œä½† GPG ä¸çŸ¥é“è¿™è´¦å·æ˜¯ä¸æ˜¯ä½ æœ‹å‹ï¼Œé™¤éä½ è‡ªå·±ç‚¹â€œä¿¡ä»»â€ã€‚</p></blockquote><hr><h3 id=-ä½ å¯ä»¥åšçš„äº‹å¯é€‰>ğŸ§  ä½ å¯ä»¥åšçš„äº‹ï¼ˆå¯é€‰ï¼‰ï¼š</h3><p>å¦‚æœä½ å·²ç»ç¡®è®¤è¿™ä¸ª Key æ˜¯ Gitea å®˜æ–¹æä¾›çš„ï¼Œå¯ä»¥æŠŠè¿™ä¸ªå¯†é’¥æ ‡è®°ä¸ºâ€œä¿¡ä»»â€ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpg --edit-key 7C9E68152594688862D62AF62D9AE806EC1592E2
</span></span></code></pre></div><p>ç„¶åè¾“å…¥ï¼š</p><pre tabindex=0><code>trust
</code></pre><p>æ ¹æ®æç¤ºè¾“å…¥ <code>5</code>ï¼ˆå®Œå…¨ä¿¡ä»»ï¼‰ï¼Œç„¶åä¿å­˜é€€å‡ºã€‚</p><p>saveä¿å­˜</p><hr><h3 id=-æœ€ç»ˆç»“è®º>âœ… æœ€ç»ˆç»“è®ºï¼š</h3><p>ä½ è¿™æ¬¡çš„è¾“å‡ºè¯´æ˜ï¼š</p><table><thead><tr><th>éªŒè¯é¡¹</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>ç­¾ååˆæ³•</td><td>âœ… æˆåŠŸ</td></tr><tr><td>æ–‡ä»¶å®Œæ•´æ€§</td><td>âœ… æœªè¢«ç¯¡æ”¹</td></tr><tr><td>ç­¾åè€…èº«ä»½å¯ä¿¡</td><td>âš ï¸ ç”±ä½ æ‰‹åŠ¨ç¡®è®¤ï¼ˆæ¨èä»å®˜ç½‘/å¤šæ¸ é“æ¯”å¯¹ fingerprintï¼‰</td></tr></tbody></table><hr><p>éœ€è¦æˆ‘å¸®ä½ å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„éªŒè¯è„šæœ¬å—ï¼Ÿä¸€æ¡å‘½ä»¤å°±èƒ½éªŒè¯ + æç¤ºç­¾åæƒ…å†µé‚£ç§ ğŸ› ï¸</p><h1 id=faq>FAQ</h1><h2 id=é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®>é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®</h2><p>/etc/gitea/app.ini</p><h2 id=3000ç«¯å£ç¦æ­¢è®¿é—®>3000ç«¯å£ç¦æ­¢è®¿é—®</h2><p>ä»¥ä¸‹æ˜¯é™åˆ¶ Gitea 3000 ç«¯å£ä»…å…è®¸æœ¬åœ°è®¿é—®çš„è§£å†³æ–¹æ¡ˆï¼š</p><hr><h3 id=æ–¹æ³•ä¸€ä¿®æ”¹-gitea-ç›‘å¬åœ°å€><strong>æ–¹æ³•ä¸€ï¼šä¿®æ”¹ Gitea ç›‘å¬åœ°å€</strong></h3><ol><li>ç¼–è¾‘é…ç½®æ–‡ä»¶</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/gitea/app.ini
</span></span></code></pre></div><ol><li>ä¿®æ”¹æœåŠ¡å™¨é…ç½®æ®µ</li></ol><pre tabindex=0><code>[server]
HTTP_ADDR = 127.0.0.1  # åŸä¸º 0.0.0.0
HTTP_PORT = 3000
</code></pre><ol><li>é‡å¯æœåŠ¡ç”Ÿæ•ˆ</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart gitea
</span></span></code></pre></div><hr><h3 id=æ–¹æ³•äºŒä½¿ç”¨é˜²ç«å¢™è§„åˆ™æ¨èç»„åˆæ–¹æ¡ˆ><strong>æ–¹æ³•äºŒï¼šä½¿ç”¨é˜²ç«å¢™è§„åˆ™ï¼ˆæ¨èç»„åˆæ–¹æ¡ˆï¼‰</strong></h3><h3 id=1-æ¸…é™¤åŸæœ‰3000ç«¯å£è§„åˆ™>1. æ¸…é™¤åŸæœ‰3000ç«¯å£è§„åˆ™</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw delete allow <span class=m>3000</span>
</span></span></code></pre></div><h3 id=2-è®¾ç½®æ–°è§„åˆ™ä»…å…è®¸æœ¬æœºè®¿é—®>2. è®¾ç½®æ–°è§„åˆ™ï¼ˆä»…å…è®¸æœ¬æœºè®¿é—®ï¼‰</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw allow from 127.0.0.1 to any port <span class=m>3000</span>
</span></span><span class=line><span class=cl>sudo ufw deny <span class=m>3000</span>  <span class=c1># æ˜ç¡®æ‹’ç»å…¶ä»–è®¿é—®</span>
</span></span></code></pre></div><h3 id=3-ç”Ÿæ•ˆè§„åˆ™>3. ç”Ÿæ•ˆè§„åˆ™</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw reload
</span></span></code></pre></div><hr><h3 id=æ–¹æ³•ä¸‰nginx-åå‘ä»£ç†éš”ç¦»ç”Ÿäº§ç¯å¢ƒæ¨è><strong>æ–¹æ³•ä¸‰ï¼šNginx åå‘ä»£ç†éš”ç¦»ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</strong></h3><ol><li>ä¿®æ”¹ Nginx é…ç½®</li></ol><pre tabindex=0><code>server {
    listen 80;
    server_name localhost;  # ä»…é™æœ¬æœºè®¿é—®

    location / {
        proxy_pass &lt;http://127.0.0.1:3000&gt;;
        # æ·»åŠ IPç™½åå•ï¼ˆå¯é€‰ï¼‰
        allow 192.168.1.100;  # å…è®¸æŒ‡å®šIP
        deny all;
    }
}
</code></pre><ol><li>ç¦ç”¨åŸ3000ç«¯å£å¤–éƒ¨è®¿é—®</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw deny <span class=m>3000</span>
</span></span></code></pre></div><hr><h3 id=éªŒè¯é…ç½®æ•ˆæœ><strong>éªŒè¯é…ç½®æ•ˆæœ</strong></h3><ol><li>æœ¬åœ°è®¿é—®æµ‹è¯•</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl 127.0.0.1:3000  <span class=c1># åº”è¯¥æ­£å¸¸å“åº”</span>
</span></span></code></pre></div><ol><li>å±€åŸŸç½‘è®¿é—®æµ‹è¯•ï¼ˆå…¶ä»–æœºå™¨ï¼‰</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl ä½ çš„æœåŠ¡å™¨å†…ç½‘IP:3000  <span class=c1># åº”è¯¥è¿”å›è¿æ¥æ‹’ç»</span>
</span></span></code></pre></div><hr><h3 id=è¡¥å……å®‰å…¨æªæ–½><strong>è¡¥å……å®‰å…¨æªæ–½</strong></h3><ol><li>æ£€æŸ¥ç›‘å¬çŠ¶æ€</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ss -tulpn <span class=p>|</span> grep <span class=m>3000</span>
</span></span><span class=line><span class=cl><span class=c1># æ­£ç¡®åº”æ˜¾ç¤ºï¼štcp LISTEN 0 128 127.0.0.1:3000</span>
</span></span></code></pre></div><ol><li>æ°¸ä¹…å…³é—­ IP è½¬å‘ï¼ˆå¢å¼ºéš”ç¦»ï¼‰</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo sysctl -w net.ipv4.ip_forward<span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;net.ipv4.ip_forward = 0&#34;</span> <span class=p>|</span> sudo tee -a /etc/sysctl.conf
</span></span></code></pre></div><hr><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p><ol><li>å¦‚æœä½¿ç”¨ SSH ç«¯å£è½¬å‘è®¿é—®ï¼Œä¿æŒ22ç«¯å£å¼€æ”¾</li><li>ä¿®æ”¹é…ç½®å‰å»ºè®®å¤‡ä»½ <code>app.ini</code> æ–‡ä»¶</li><li>ç»„åˆä½¿ç”¨ã€Œæ–¹æ³•ä¸€ + æ–¹æ³•äºŒã€èƒ½è¾¾åˆ°æœ€ä½³éš”ç¦»æ•ˆæœ</li></ol><p>ä»¥ä¸Šæ–¹æ¡ˆå¯ä½¿ Gitea æœåŠ¡ä»…é™æœ¬æœºè®¿é—®ï¼ŒåŒæ—¶å¯é€šè¿‡ Nginx é…ç½®é€‰æ‹©æ€§å¼€æ”¾å¤–éƒ¨è®¿é—®æƒé™ã€‚</p><h2 id=frpåå‘ä»£ç†>frpåå‘ä»£ç†</h2><h3 id=åŸºæœ¬é…ç½®>åŸºæœ¬é…ç½®</h3><p><code>å®Œæˆåè¿˜éœ€äº‘æœåŠ¡å™¨æ”¾è¡Œ</code></p><p><img class=lazyload src=/svg/loading.min.svg data-src=Gitea%201d2e4020f06080ff905ee0ba10dfeafa/image.png data-srcset="Gitea%201d2e4020f06080ff905ee0ba10dfeafa/image.png, Gitea%201d2e4020f06080ff905ee0ba10dfeafa/image.png 1.5x, Gitea%201d2e4020f06080ff905ee0ba10dfeafa/image.png 2x" data-sizes=auto alt=Gitea%201d2e4020f06080ff905ee0ba10dfeafa/image.png title=image.png></p><p>è¿™ä¸¤ä¸ªé—®é¢˜æˆ‘æ¥ä¸€ä¸€ç»™ä½ è¯¦ç»†è®²æ¸…æ¥š ğŸ‘‡</p><hr><h2 id=-ä¸€gitea-é¦–æ¬¡-web-é¡µé¢é…ç½®å®Œæˆåè¿˜èƒ½ä¿®æ”¹å—>ğŸ“Œ ä¸€ã€Gitea é¦–æ¬¡ Web é¡µé¢é…ç½®å®Œæˆåè¿˜èƒ½ä¿®æ”¹å—ï¼Ÿ</h2><ul><li>*å¯ä»¥çš„ï¼**Gitea çš„é¦–æ¬¡é…ç½®å…¶å®æ˜¯å†™å…¥åˆ°äº†é…ç½®æ–‡ä»¶ä¸­ï¼Œ<strong>ä¿®æ”¹è¿™ä¸ªé…ç½®æ–‡ä»¶å°±å¯ä»¥é‡æ–°è®¾ç½®</strong>ã€‚</li></ul><h3 id=-é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®>ğŸ“„ é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®ï¼š</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/etc/gitea/app.ini
</span></span></code></pre></div><blockquote><p>ä¹Ÿå¯èƒ½åœ¨ï¼š/var/lib/gitea/custom/conf/app.iniï¼Œçœ‹ä½ çš„è¿è¡Œå‚æ•°æˆ– systemd é…ç½®ã€‚</p></blockquote><h3 id=-ä½ å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹çš„å†…å®¹>ğŸ”§ ä½ å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹çš„å†…å®¹ï¼š</h3><table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>[server]</code></td><td>ç«¯å£ã€åŸŸåã€æ ¹URLã€é™æ€æ–‡ä»¶è·¯å¾„ç­‰</td></tr><tr><td><code>[database]</code></td><td>æ•°æ®åº“ç±»å‹ã€ç”¨æˆ·åã€å¯†ç ã€è¿æ¥æ–¹å¼ç­‰</td></tr><tr><td><code>[repository]</code></td><td>ä»“åº“æ ¹ç›®å½•</td></tr><tr><td><code>[security]</code></td><td>å®‰å…¨ç­–ç•¥ã€æ³¨å†Œæ–¹å¼ç­‰</td></tr><tr><td><code>[admin]</code></td><td>é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·åç­‰</td></tr></tbody></table><p>ä¿®æ”¹åï¼Œ<strong>é‡å¯ Gitea æœåŠ¡</strong> ç”Ÿæ•ˆï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart gitea
</span></span></code></pre></div><hr><h2 id=-äºŒå¦‚ä½•é€šè¿‡-frp-å°†-gitea-å±€åŸŸç½‘åœ°å€-192168xxxxxx3000-æš´éœ²åˆ°å…¬ç½‘é€šè¿‡ç«¯å£-2222>ğŸ“Œ äºŒã€å¦‚ä½•é€šè¿‡ frp å°† Gitea å±€åŸŸç½‘åœ°å€ <code>192.168.xxx.xxx:3000</code> æš´éœ²åˆ°å…¬ç½‘ï¼ˆé€šè¿‡ç«¯å£ <code>2222</code>ï¼‰ï¼Ÿ</h2><h3 id=-æ–¹æ¡ˆfrp-ç«¯å£æ˜ å°„tcp-ä»£ç†>âœ… æ–¹æ¡ˆï¼šfrp ç«¯å£æ˜ å°„ï¼ˆTCP ä»£ç†ï¼‰</h3><p>å‡è®¾ä½ å·²ç»æœ‰å…¬ç½‘ VPSï¼ˆå¦‚ cloud serverï¼‰ï¼Œfrp æœåŠ¡å™¨ç«¯è¿è¡Œåœ¨ VPS ä¸Šï¼Œä»¥ä¸‹æ˜¯é…ç½®æµç¨‹ï¼š</p><hr><h3 id=-1-vpså…¬ç½‘æœåŠ¡å™¨é…ç½®-frpsiniæœåŠ¡ç«¯>ğŸ“Œ 1. VPSï¼ˆå…¬ç½‘æœåŠ¡å™¨ï¼‰é…ç½® <code>frps.ini</code>ï¼ˆæœåŠ¡ç«¯ï¼‰ï¼š</h3><pre tabindex=0><code>[common]
bind_port = 7000
</code></pre><p>å¯åŠ¨ frps æœåŠ¡ç«¯ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./frps -c ./frps.ini
</span></span></code></pre></div><hr><h3 id=-2-å±€åŸŸç½‘å†…è¿è¡Œ-gitea-çš„æœºå™¨é…ç½®-frpcini>ğŸ“Œ 2. å±€åŸŸç½‘å†…è¿è¡Œ Gitea çš„æœºå™¨é…ç½® <code>frpc.ini</code>ï¼š</h3><pre tabindex=0><code>[common]
server_addr = &lt;ä½ çš„å…¬ç½‘IP&gt;
server_port = 7000

[gitea_web]
type = tcp
local_ip = 127.0.0.1
local_port = 3000
remote_port = 2222
</code></pre><p>ç„¶åè¿è¡Œï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./frpc -c ./frpc.ini
</span></span></code></pre></div><hr><h3 id=-ç°åœ¨ä½ å°±å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—®-gitea>ğŸŒ ç°åœ¨ï¼Œä½ å°±å¯ä»¥é€šè¿‡å…¬ç½‘è®¿é—® Giteaï¼š</h3><pre tabindex=0><code>http://&lt;ä½ çš„å…¬ç½‘IP&gt;:2222
</code></pre><p>å°±èƒ½è®¿é—®ä½ å†…ç½‘çš„ <code>http://192.168.x.x:3000</code> ä¸Šè¿è¡Œçš„ Gitea Web é¡µé¢å•¦ ğŸš€</p><hr><h3 id=-è¡¥å……å»ºè®®>ğŸ” è¡¥å……å»ºè®®ï¼š</h3><ul><li><strong>ä¸è¦åœ¨å…¬ç½‘å¼€æ”¾ Gitea çš„ 3000 ç«¯å£ä½œä¸ºæœ€ç»ˆå…¥å£</strong>ï¼Œå»ºè®®æ­ä¸ªåå‘ä»£ç†ï¼ˆNginxï¼‰ + HTTPSã€‚</li><li>æˆ–è€…åŠ  frp çš„ <a href=https://gofrp.org/docs/examples/https/ target=_blank rel="noopener noreffer">http</a> æ¨¡å¼é…ç½®ï¼Œè¿™æ ·å¯ä»¥ç”¨åŸŸå+TLSã€‚</li><li>é…ç½®å¼ºå¯†ç å’Œæ³¨å†Œæƒé™ï¼ˆå¦‚ç¦ç”¨åŒ¿åæ³¨å†Œï¼‰ã€‚</li></ul><hr><p>éœ€è¦æˆ‘å¸®ä½ ç”Ÿæˆå®Œæ•´çš„ <code>frpc.ini</code> + <code>frps.ini</code> æ–‡ä»¶æ¨¡æ¿å—ï¼Ÿ</p><p>æˆ–è€…é… Nginx å®ç° <code>https://gitea.example.com</code> çš„æ–¹å¼ï¼Ÿâœ¨</p><h3 id=é˜»æ­¢frpè®¿é—®>é˜»æ­¢frpè®¿é—®</h3><p>ç¡®å®ï¼Œå³ä½¿ä½ åœ¨ Gitea çš„é…ç½®ä¸­è®¾ç½®ï¼š</p><pre tabindex=0><code>HTTP_ADDR = localhost
</code></pre><p><strong>frp ä¾ç„¶å¯ä»¥è®¿é—®</strong>ã€‚è¿™æ˜¯å› ä¸ºï¼š</p><hr><h2 id=-å…³é”®ç‚¹è§£é‡Š>ğŸ’¡ å…³é”®ç‚¹è§£é‡Š</h2><p>frp åœ¨æœ¬åœ°å¯åŠ¨ <code>frpc</code> æ—¶ï¼Œä¼šæŠŠå…¬ç½‘æµé‡è½¬å‘åˆ° <code>127.0.0.1:3000</code>ï¼ˆæˆ–ä½ è®¾ç½®çš„ä»»æ„ç«¯å£ï¼‰ï¼Œè¿™æœ¬è´¨ä¸Šå°±æ˜¯åœ¨ <strong>æœ¬åœ°ç›´æ¥è®¿é—® Gitea</strong>ï¼Œå’Œâ€œå¤–éƒ¨è®¿é—®â€æ²¡åŒºåˆ«ã€‚</p><p><strong><code>HTTP_ADDR = localhost</code></strong> åªæ˜¯é™åˆ¶ Gitea ç›‘å¬åœ¨æœ¬åœ°å›ç¯æ¥å£ï¼ˆ127.0.0.1ï¼‰ï¼Œä½† <strong>frp å°±åœ¨æœ¬åœ°ï¼Œæ‰€ä»¥å®ƒä»ç„¶èƒ½è®¿é—®è¿™ä¸ªåœ°å€</strong>ï¼</p><hr><h2 id=-ç¦ç”¨-frp-è®¿é—®çš„çœŸæ­£è§£å†³æ–¹æ¡ˆ>âœ… ç¦ç”¨ frp è®¿é—®çš„çœŸæ­£è§£å†³æ–¹æ¡ˆ</h2><p>è¦é˜»æ­¢ frpï¼Œè¿˜éœ€è¦é…åˆä»¥ä¸‹è‡³å°‘ä¸€ç§æ–¹æ³•ï¼š</p><hr><h3 id=-æ–¹æ³•ä¸€ç›´æ¥ç¦ç”¨-frpc-ä¸­å¯¹-gitea-çš„é…ç½®>âœ… æ–¹æ³•ä¸€ï¼šç›´æ¥ç¦ç”¨ frpc ä¸­å¯¹ Gitea çš„é…ç½®</h3><p>åœ¨ <code>frpc.ini</code> ä¸­æ³¨é‡Šæ‰ï¼š</p><pre tabindex=0><code>#[gitea]
#type = tcp
#local_ip = 127.0.0.1
#local_port = 3000
#remote_port = 2222
</code></pre><p>æˆ–è€…åˆ é™¤ <code>[gitea]</code> é…ç½®å—ï¼Œé‡å¯ frpc å³å¤±æ•ˆï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./frpc -c ./frpc.ini
</span></span></code></pre></div><hr><h3 id=-æ–¹æ³•äºŒufw-å±è”½æœ¬æœºé€šè¿‡-lo-è®¿é—®-3000-ç«¯å£å¾ˆç¡¬æ ¸>âœ… æ–¹æ³•äºŒï¼šUFW å±è”½æœ¬æœºé€šè¿‡ <code>lo</code> è®¿é—® 3000 ç«¯å£ï¼ˆå¾ˆç¡¬æ ¸ï¼‰</h3><p>ä½ å¯ä»¥ç”¨ <code>UFW</code> æ˜ç¡®ç¦æ­¢æ¥è‡ªæœ¬åœ°å›ç¯æ¥å£çš„è®¿é—®ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ufw deny in on lo to any port <span class=m>3000</span>
</span></span></code></pre></div><p>è¿™ä¼šé˜»æ­¢ frp çš„è½¬å‘ï¼ˆå®ƒèµ° loï¼‰</p><blockquote><p>âš ï¸ å°å¿ƒï¼šè¿™ä¸ªè®¾ç½®å¯èƒ½ä¹Ÿå½±å“ä½ æœ¬æœºè®¿é—® localhost:3000ï¼Œè¦æƒè¡¡ä½¿ç”¨ã€‚</p></blockquote><hr><h3 id=-æ–¹æ³•ä¸‰iptables-ç²¾å‡†é˜»æ–­-frp-ç”¨æˆ·æ¨èä¸­é«˜çº§ç”¨æˆ·>âœ… æ–¹æ³•ä¸‰ï¼šiptables ç²¾å‡†é˜»æ–­ frp ç”¨æˆ·ï¼ˆæ¨èä¸­é«˜çº§ç”¨æˆ·ï¼‰</h3><p>ä½ å¯ä»¥åŠ ä¸€ä¸ªè§„åˆ™ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo iptables -A INPUT -s 127.0.0.1 -p tcp --dport <span class=m>3000</span> -j DROP
</span></span></code></pre></div><p>æˆ–è€…æ›´é«˜çº§çš„ï¼Œæ£€æµ‹æ˜¯ <code>frpc</code> çš„ PID ç„¶åä¸¢å¼ƒå¯¹åº”æµé‡ï¼ˆä½†éº»çƒ¦ï¼‰ã€‚</p><hr><h3 id=-æ–¹æ³•å››gitea-é…åˆ-tokenip-æ£€æŸ¥>âœ… æ–¹æ³•å››ï¼šGitea é…åˆ token/IP æ£€æŸ¥</h3><p>è¿™ä¸ªåæ›²çº¿æ•‘å›½ã€‚ä½ å¯ä»¥ç”¨ï¼š</p><ul><li><strong>åä»£é™åˆ¶ IP</strong>ï¼ˆä¾‹å¦‚ç”¨ Nginx åŠ  allow/denyï¼‰</li><li>æˆ– Gitea å¢åŠ  middleware åšè¯·æ±‚æ¥æºæ£€æŸ¥ï¼ˆè¾ƒå¤æ‚ï¼‰</li></ul><hr><h2 id=-æ€»ç»“>âœ… æ€»ç»“</h2><table><thead><tr><th>æ–¹æ³•</th><th>æ˜¯å¦æ¨è</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ä¿®æ”¹ <code>frpc.ini</code> ç¦ç”¨è½¬å‘</td><td>âœ… å¼ºçƒˆæ¨è</td><td>æœ€ç›´æ¥</td></tr><tr><td><code>ufw deny in on lo to port 3000</code></td><td>âœ… å°å¿ƒä½¿ç”¨</td><td>å±€éƒ¨æ‹¦æˆª frp</td></tr><tr><td><code>iptables</code> é™åˆ¶ lo æµé‡</td><td>âœ… ç²¾ç»†ç²’åº¦</td><td>æ›´é«˜çº§åšæ³•</td></tr><tr><td>Gitea IP ç™½åå•æˆ– Token æ£€æŸ¥</td><td>âš ï¸ å¯é€‰</td><td>éœ€è‡ªè¡Œå¼€å‘æˆ–é…ç½®</td></tr></tbody></table><hr><p>å¦‚æœä½ å¸Œæœ›ç»§ç»­ä½¿ç”¨ frp ä½†åªå…è®¸æŸä¸ªç‰¹å®š IP æˆ–æ—¶é—´æ®µå¯ä»¥è®¿é—®ï¼Œä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ï¼Œæˆ‘æ¥å¸®ä½ è®¾è®¡ä¸ªåŠ¨æ€æ–¹æ¡ˆ ğŸš€</p><h3 id=frpç™½åå•è®¿é—®-gpt>frpç™½åå•è®¿é—®-gpt</h3><p>Gitea æœ¬èº«æ²¡æœ‰å†…ç½®â€œIP ç™½åå•æˆ– Token æ£€æŸ¥è®¿é—®æ§åˆ¶â€åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼šä¸ç™»å½•å°±æ‹¦ IPï¼‰ï¼Œä½†ä½ å¯ä»¥é€šè¿‡ <strong>å¤–éƒ¨ Web æœåŠ¡å™¨ï¼ˆå¦‚ Nginxï¼‰</strong> é…åˆä½¿ç”¨ï¼Œæˆ–è€…é€šè¿‡ <strong>åå‘ä»£ç† Token éªŒè¯è„šæœ¬</strong> å®ç°ä½ æƒ³è¦çš„ç›®æ ‡ã€‚</p><p>æˆ‘ä¸‹é¢ç»™å‡ºä¸¤ç§æ–¹å¼ï¼š</p><hr><h2 id=-æ–¹æ³•ä¸€ç”¨-nginx-å®ç°-ip-ç™½åå•--token-é‰´æƒ>âœ… æ–¹æ³•ä¸€ï¼šç”¨ Nginx å®ç° IP ç™½åå• + Token é‰´æƒ</h2><p>è¿™æ˜¯æœ€å®ç”¨ä¹Ÿæœ€å¯æ§çš„æ–¹æ¡ˆï¼Œ<strong>æ‹¦æˆªåœ¨ Gitea ä¹‹å‰ï¼Œä¸ç”¨æ”¹åŠ¨ Gitea æœ¬ä½“</strong>ã€‚</p><hr><h3 id=-step-1-å®‰è£…-nginxå¦‚æœæ²¡è£…>ğŸ”§ Step 1: å®‰è£… Nginxï¼ˆå¦‚æœæ²¡è£…ï¼‰</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install nginx
</span></span></code></pre></div><hr><h3 id=-step-2-é…ç½®-nginx-åå‘ä»£ç†--ip-ç™½åå•--token-é™åˆ¶>ğŸ”§ Step 2: é…ç½® Nginx åå‘ä»£ç† + IP ç™½åå• + Token é™åˆ¶</h3><p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/nginx/sites-available/gitea
</span></span></code></pre></div><p>å¡«å…¥å¦‚ä¸‹é…ç½®ï¼ˆä¾‹å­ä»…ä¿ç•™å¿…è¦éƒ¨åˆ†ï¼‰ï¼š</p><pre tabindex=0><code>server {
    listen 80;
    server_name your.domain.com;

    # å…è®¸æœ¬åœ°å’Œå±€åŸŸç½‘è®¿é—®
    allow 127.0.0.1;
    allow 192.168.0.0/16;

    # å…è®¸å¸¦ç‰¹å®šTokençš„è®¿é—®
    if ($http_x_auth_token != &#34;your-secret-token&#34;) {
        return 403;
    }

    deny all;

    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
</code></pre><hr><h3 id=-ä½¿ç”¨æ–¹å¼>âœ… ä½¿ç”¨æ–¹å¼ï¼š</h3><p>å…¬ç½‘è®¿é—®å¿…é¡»å¸¦ä¸Šè¯·æ±‚å¤´ï¼š</p><pre tabindex=0><code>X-Auth-Token: your-secret-token
</code></pre><p>å¦åˆ™ç›´æ¥ 403ã€‚å±€åŸŸç½‘ç”¨æˆ·å’Œæœ¬åœ°ç”¨æˆ·é»˜è®¤æ”¾è¡Œã€‚</p><hr><h3 id=-é…ç½®æ¿€æ´»>ğŸ” é…ç½®æ¿€æ´»</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ln -s /etc/nginx/sites-available/gitea /etc/nginx/sites-enabled/gitea
</span></span><span class=line><span class=cl>sudo nginx -t
</span></span><span class=line><span class=cl>sudo systemctl reload nginx
</span></span></code></pre></div><hr><h2 id=-æ–¹æ³•äºŒåœ¨-gitea-ä¹‹ånginx-æˆ–-frp-åŠ è‡ªå®šä¹‰é‰´æƒ>âœ… æ–¹æ³•äºŒï¼šåœ¨ Gitea ä¹‹åï¼ŒNginx æˆ– frp åŠ è‡ªå®šä¹‰é‰´æƒ</h2><p>è¿™ç§æ–¹å¼ä½ å¯ä»¥ç”¨ Nginx çš„ <code>auth_request</code> æ¨¡å—æˆ–ç›´æ¥åœ¨ frps ä¸ŠåŠ  Token è®¤è¯ï¼ˆä½† frp ä¸æ”¯æŒç²¾ç»† IP æ§åˆ¶ï¼Œåªæ”¯æŒç”¨æˆ·é‰´æƒï¼‰ã€‚</p><hr><h3 id=-frpsini-æ”¯æŒç”¨æˆ·å¯†ç è®¤è¯ä¸æ˜¯-ip-ç™½åå•>ğŸ’¡ frps.ini æ”¯æŒç”¨æˆ·å¯†ç è®¤è¯ï¼ˆä¸æ˜¯ IP ç™½åå•ï¼‰</h3><pre tabindex=0><code>[common]
bind_port = 7000
dashboard_port = 7500
authentication_method = token
token = your-secret-token
</code></pre><p>ä½†è¿™ä¸ªåªé˜²æ­¢â€œåˆ«äººç”¨ frpc è¿æ¥â€ï¼Œä¸èƒ½é˜²æ­¢â€œåˆ«äººè®¿é—®ä½ æš´éœ²å‡ºå»çš„æœåŠ¡â€ã€‚</p><hr><h2 id=-æ€»ç»“æ¨è>ğŸš€ æ€»ç»“æ¨è</h2><table><thead><tr><th>æ–¹æ¡ˆ</th><th>è¯´æ˜</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td>Nginx é™åˆ¶ IP + è¯·æ±‚å¤´ Token</td><td>çµæ´»ã€æ˜“æ§åˆ¶ï¼Œæ¨è</td><td>â­â­â­â­â­</td></tr><tr><td>Gitea æ’ä»¶æˆ–ä¸­é—´ä»¶å¼€å‘</td><td>å¤ªéº»çƒ¦</td><td>â­</td></tr><tr><td>frps é™åˆ¶ frpc ç”¨æˆ·</td><td>ä¸è§£å†³è®¿é—®é—®é¢˜</td><td>â­</td></tr></tbody></table><hr><p>å¦‚æœä½ å¸Œæœ›æˆ‘ä¸ºä½ è‡ªåŠ¨ç”Ÿæˆä¸€ä»½é€‚ç”¨äºä½ ç¯å¢ƒçš„ Nginx é…ç½®ï¼ˆå« IP ç™½åå• + Token æ£€æŸ¥ï¼‰ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ï¼š</p><ul><li>å±€åŸŸç½‘å…è®¸çš„ IP èŒƒå›´</li><li>æ˜¯å¦ç”¨ HTTPS</li><li>æƒ³é€šè¿‡ä»€ä¹ˆ Token æ§åˆ¶</li></ul><p>æˆ‘å¯ä»¥ç›´æ¥å†™å‡ºæ¥ä½ å°±å¤åˆ¶ç²˜è´´éƒ¨ç½²å³å¯ã€‚éœ€è¦å—ï¼Ÿ</p><h3 id=frpç™½åå•è®¿é—®-qwen>frpç™½åå•è®¿é—®-qwen</h3><p>ä»¥ä¸‹æ˜¯ <strong>Gitea ç»“åˆ frp å®ç°ç™½åå•è®¿é—®</strong>çš„å®Œæ•´æ–¹æ¡ˆï¼Œæ¶µç›–ç½‘ç»œå±‚ã€åº”ç”¨å±‚å’Œè®¤è¯å±‚çš„è®¿é—®æ§åˆ¶ï¼š</p><hr><h3 id=1-frp-æœåŠ¡ç«¯é…ç½®ç™½åå•><strong>1. frp æœåŠ¡ç«¯é…ç½®ç™½åå•</strong></h3><h3 id=11-é™åˆ¶å®¢æˆ·ç«¯-ip><strong>1.1 é™åˆ¶å®¢æˆ·ç«¯ IP</strong></h3><p>åœ¨ <code>frps.ini</code> ä¸­é…ç½®å…è®¸è¿æ¥çš„å®¢æˆ·ç«¯ IPï¼š</p><pre tabindex=0><code>[common]
bind_port = 7000
token = your_secure_token

# å…è®¸çš„å®¢æˆ·ç«¯ IP åˆ—è¡¨ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰
allow_clients = 192.168.1.100,203.0.113.5
</code></pre><h3 id=12-é™åˆ¶ä»£ç†ç«¯å£><strong>1.2 é™åˆ¶ä»£ç†ç«¯å£</strong></h3><p>ä»…å…è®¸ç‰¹å®šç«¯å£è¢«ä»£ç†ï¼ˆå¦‚ Gitea çš„ HTTP å’Œ SSHï¼‰ï¼š</p><pre tabindex=0><code>[common]
allow_ports = 3000,22  # Gitea HTTP å’Œ SSH ç«¯å£
</code></pre><hr><h3 id=2-gitea-åº”ç”¨å±‚ç™½åå•><strong>2. Gitea åº”ç”¨å±‚ç™½åå•</strong></h3><h3 id=21-ip-ç™½åå•><strong>2.1 IP ç™½åå•</strong></h3><p>åœ¨ <code>app.ini</code> ä¸­é…ç½®å…è®¸è®¿é—® Gitea çš„ IPï¼š</p><pre tabindex=0><code>[security]
ALLOWED_HOSTS = 127.0.0.1,192.168.1.0/24,your-trusted-ip
INTERNAL_TOKEN = your_secure_token  # å¼ºåŒ–å†…éƒ¨é€šä¿¡
</code></pre><h3 id=22-ç¦ç”¨åŒ¿åè®¿é—®><strong>2.2 ç¦ç”¨åŒ¿åè®¿é—®</strong></h3><p>å¼ºåˆ¶ç”¨æˆ·ç™»å½•åæ“ä½œï¼š</p><pre tabindex=0><code>[service]
DISABLE_REGISTRATION = true
REQUIRE_SIGNIN_VIEW = true
</code></pre><hr><h3 id=3-nginx-åå‘ä»£ç†ç™½åå•å¯é€‰><strong>3. Nginx åå‘ä»£ç†ç™½åå•ï¼ˆå¯é€‰ï¼‰</strong></h3><p>å¦‚æœé€šè¿‡ Nginx æš´éœ²æœåŠ¡ï¼Œæ·»åŠ  IP é™åˆ¶ï¼š</p><pre tabindex=0><code>server {
    listen 443 ssl;
    server_name git.example.com;

    # å…è®¸çš„ IP åˆ—è¡¨
    allow 192.168.1.0/24;
    allow 203.0.113.5;
    deny all;

    location / {
        proxy_pass &lt;http://127.0.0.1:60080&gt;;  # frp æ˜ å°„çš„æœ¬åœ°ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
</code></pre><hr><h3 id=4-é˜²ç«å¢™è§„åˆ™ufw><strong>4. é˜²ç«å¢™è§„åˆ™ï¼ˆUFWï¼‰</strong></h3><p>ç›´æ¥é™åˆ¶ frp ç«¯å£çš„è®¿é—®æºï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å…è®¸ä¿¡ä»»çš„ IP è®¿é—® frp ç«¯å£ï¼ˆ7000ï¼‰</span>
</span></span><span class=line><span class=cl>sudo ufw allow from 192.168.1.100 to any port <span class=m>7000</span>
</span></span><span class=line><span class=cl>sudo ufw allow from 203.0.113.5 to any port <span class=m>7000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ‹’ç»å…¶ä»–æ‰€æœ‰ IP</span>
</span></span><span class=line><span class=cl>sudo ufw deny 7000/tcp
</span></span></code></pre></div><hr><h3 id=5-åŠ¨æ€-ip-ç™½åå•é«˜çº§><strong>5. åŠ¨æ€ IP ç™½åå•ï¼ˆé«˜çº§ï¼‰</strong></h3><p>å¦‚æœå®¢æˆ·ç«¯ IP åŠ¨æ€å˜åŒ–ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°åŠ¨æ€è®¤è¯ï¼š</p><h3 id=51-frp-token-è®¤è¯><strong>5.1 frp Token è®¤è¯</strong></h3><p>åœ¨ <code>frpc.ini</code> å’Œ <code>frps.ini</code> ä¸­é…ç½®å¼º Tokenï¼š</p><pre tabindex=0><code># frps.iniï¼ˆæœåŠ¡ç«¯ï¼‰
token = your_secure_token

# frpc.iniï¼ˆå®¢æˆ·ç«¯ï¼‰
token = your_secure_token
</code></pre><h3 id=52-è‡ªå®šä¹‰è„šæœ¬éªŒè¯><strong>5.2 è‡ªå®šä¹‰è„šæœ¬éªŒè¯</strong></h3><p>é€šè¿‡ <code>frp</code> çš„ <code>http_auth</code> æˆ– <code>plugin</code> åŠŸèƒ½å®ç°åŠ¨æ€éªŒè¯ï¼š</p><pre tabindex=0><code># frpc.iniï¼ˆå®¢æˆ·ç«¯ï¼‰
[gitea-http]
type = http
local_port = 3000
custom_domains = git.example.com
http_user = user
http_pwd = password  # åŸºç¡€è®¤è¯
</code></pre><hr><h3 id=6-æ—¥å¿—ä¸ç›‘æ§><strong>6. æ—¥å¿—ä¸ç›‘æ§</strong></h3><h3 id=61-å®æ—¶ç›‘æ§-frp-è¿æ¥><strong>6.1 å®æ—¶ç›‘æ§ frp è¿æ¥</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æŸ¥çœ‹ frp è¿æ¥æ—¥å¿—</span>
</span></span><span class=line><span class=cl>tail -f /var/log/frps.log <span class=p>|</span> grep <span class=s2>&#34;login&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥æ´»è·ƒè¿æ¥</span>
</span></span><span class=line><span class=cl>netstat -anp <span class=p>|</span> grep frp
</span></span></code></pre></div><h3 id=62-é…ç½®-fail2ban-é˜²æš´åŠ›ç ´è§£><strong>6.2 é…ç½® Fail2Ban é˜²æš´åŠ›ç ´è§£</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£… Fail2Ban</span>
</span></span><span class=line><span class=cl>sudo apt install fail2ban -y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™ï¼ˆ/etc/fail2ban/filter.d/frp.confï¼‰ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Definition<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>failregex</span> <span class=o>=</span> ^.*Failed to authenticate client.*from &lt;HOST&gt;.*$
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½® jailï¼ˆ/etc/fail2ban/jail.localï¼‰ï¼š</span>
</span></span><span class=line><span class=cl><span class=o>[</span>frp<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>enabled</span> <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=nv>port</span> <span class=o>=</span> <span class=m>7000</span>
</span></span><span class=line><span class=cl><span class=nv>filter</span> <span class=o>=</span> frp
</span></span><span class=line><span class=cl><span class=nv>logpath</span> <span class=o>=</span> /var/log/frps.log
</span></span><span class=line><span class=cl><span class=nv>maxretry</span> <span class=o>=</span> <span class=m>3</span>
</span></span><span class=line><span class=cl><span class=nv>bantime</span> <span class=o>=</span> <span class=m>3600</span>
</span></span></code></pre></div><hr><h3 id=7-æ€»ç»“><strong>7. æ€»ç»“</strong></h3><ul><li><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š<ul><li><strong>ç½‘ç»œå±‚</strong>ï¼šé€šè¿‡ frp å’Œé˜²ç«å¢™é™åˆ¶ IPã€‚</li><li><strong>åº”ç”¨å±‚</strong>ï¼šGitea é…ç½® <code>ALLOWED_HOSTS</code> å’Œè®¤è¯ã€‚</li><li><strong>ä¼ è¾“å±‚</strong>ï¼šç»“åˆ HTTPS å’Œ Token åŠ å¯†é€šä¿¡ã€‚</li></ul></li><li><strong>åŠ¨æ€åœºæ™¯</strong>ï¼šä½¿ç”¨ Token æˆ–åŠ¨æ€ DNS å®ç°éå›ºå®š IP è®¿é—®ã€‚</li></ul><p>æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©ç»„åˆæ–¹æ¡ˆï¼Œä¼˜å…ˆä¿éšœ <strong>æœ€å°æƒé™åŸåˆ™</strong> å’Œ <strong>åŠ å¯†ä¼ è¾“</strong>ã€‚</p><h2 id=nginxåå‘ä»£ç†>nginxåå‘ä»£ç†</h2><h3 id=ubuntuå®‰è£…>ubuntuå®‰è£…</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install nginx
</span></span><span class=line><span class=cl>sudo vim /etc/nginx/sites-available/gitea
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ–‡ä»¶å†…å®¹</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name git.example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / <span class=o>{</span>
</span></span><span class=line><span class=cl>        proxy_pass http://192.168.1.100:3000<span class=p>;</span>  <span class=c1># Gitea å†…ç½‘åœ°å€</span>
</span></span><span class=line><span class=cl>        proxy_set_header Host <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯åŠ¨é…ç½®</span>
</span></span><span class=line><span class=cl>sudo ln -s /etc/nginx/sites-available/gitea /etc/nginx/sites-enabled/
</span></span><span class=line><span class=cl>sudo nginx -t <span class=o>&amp;&amp;</span> sudo systemctl reload nginx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åœæ­¢</span>
</span></span><span class=line><span class=cl>sudo systemctl stop nginx
</span></span></code></pre></div><h3 id=centos7å®‰è£…æ‰‹åŠ¨>centos7å®‰è£…(æ‰‹åŠ¨)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat /etc/centos-release
</span></span><span class=line><span class=cl>wget https://nginx.org/packages/centos/7/x86_64/RPMS/nginx-1.24.0-1.el7.ngx.x86_64.rpm
</span></span><span class=line><span class=cl>sudo yum install -y pcre pcre-devel zlib zlib-devel openssl openssl-devel
</span></span><span class=line><span class=cl>sudo yum install -y epel-release
</span></span><span class=line><span class=cl>sudo yum install -y pcre2
</span></span><span class=line><span class=cl>sudo rpm -ivh nginx-1.24.0-1.el7.ngx.x86_64.rpm
</span></span><span class=line><span class=cl>nginx -V
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯åŠ¨</span>
</span></span><span class=line><span class=cl>sudo systemctl start nginx
</span></span><span class=line><span class=cl>sudo systemctl status nginx
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> nginx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># éªŒè¯</span>
</span></span><span class=line><span class=cl>http://43.138.116.20/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¸è½½</span>
</span></span><span class=line><span class=cl>sudo rpm -e nginx
</span></span></code></pre></div><h3 id=é…ç½®æ–¹å¼å¯¹æ¯”>é…ç½®æ–¹å¼å¯¹æ¯”</h3><p>åœ¨ <strong>Gitea + Nginx + frp</strong> çš„é…ç½®ä¸­ï¼ŒNginx çš„å®‰è£…ä½ç½®ï¼ˆå†…ç½‘æˆ–å…¬ç½‘ï¼‰å–å†³äºå…·ä½“çš„ç½‘ç»œç¯å¢ƒå’Œéœ€æ±‚ã€‚ä»¥ä¸‹æ˜¯ä¸¤ç§å¸¸è§çš„æ¶æ„æ–¹æ¡ˆåŠå…¶é€‚ç”¨åœºæ™¯ï¼š</p><hr><h3 id=æ–¹æ¡ˆ-1nginx-å®‰è£…åœ¨å†…ç½‘><strong>æ–¹æ¡ˆ 1ï¼šNginx å®‰è£…åœ¨å†…ç½‘</strong></h3><h3 id=æ¶æ„æè¿°><strong>æ¶æ„æè¿°</strong></h3><ul><li><p><strong>Nginx</strong>ï¼šéƒ¨ç½²åœ¨å†…ç½‘ï¼Œä½œä¸º Gitea çš„åå‘ä»£ç†ã€‚</p></li><li><p><strong>frp</strong>ï¼šå°† Nginx æš´éœ²åˆ°å…¬ç½‘ã€‚</p></li><li><p><strong>æµé‡è·¯å¾„</strong>ï¼š</p><pre tabindex=0><code>ç”¨æˆ·è®¿é—® --&gt; å…¬ç½‘ frp æœåŠ¡ç«¯ --&gt; å†…ç½‘ frp å®¢æˆ·ç«¯ --&gt; å†…ç½‘ Nginx --&gt; å†…ç½‘ Gitea
</code></pre></li></ul><h3 id=é€‚ç”¨åœºæ™¯><strong>é€‚ç”¨åœºæ™¯</strong></h3><ul><li>å†…ç½‘æœåŠ¡å™¨æ— æ³•ç›´æ¥æš´éœ²åˆ°å…¬ç½‘ï¼ˆå¦‚æ— å…¬ç½‘ IP æˆ– NAT ç¯å¢ƒï¼‰ã€‚</li><li>éœ€è¦é€šè¿‡ frp å®ç°å†…ç½‘ç©¿é€ã€‚</li><li>å¸Œæœ›åœ¨å†…ç½‘ç¯å¢ƒä¸­é›†ä¸­ç®¡ç†åå‘ä»£ç†ï¼ˆä½¿ç”¨ Nginxï¼‰ã€‚</li></ul><h3 id=é…ç½®ç¤ºä¾‹><strong>é…ç½®ç¤ºä¾‹</strong></h3><ol><li><p><strong>å†…ç½‘ Nginx é…ç½®</strong>ï¼š</p><pre tabindex=0><code>server {
    listen 80;
    server_name git.example.com;

    location / {
        proxy_pass &lt;http://127.0.0.1:3000&gt;;  # Gitea é»˜è®¤ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
</code></pre></li><li><p><strong>frp å®¢æˆ·ç«¯é…ç½®ï¼ˆ<code>frpc.ini</code>ï¼‰</strong>ï¼š</p><pre tabindex=0><code>[common]
server_addr = your-frp-server.com  # å…¬ç½‘ frp æœåŠ¡ç«¯åœ°å€
server_port = 7000
token = your_token

[gitea-http]
type = http
local_ip = 127.0.0.1
local_port = 80  # Nginx ç›‘å¬çš„ç«¯å£
custom_domains = git.example.com
</code></pre></li><li><p><strong>å…¬ç½‘ frp æœåŠ¡ç«¯é…ç½®ï¼ˆ<code>frps.ini</code>ï¼‰</strong>ï¼š</p><pre tabindex=0><code>[common]
bind_port = 7000
vhost_http_port = 80
token = your_token
</code></pre></li></ol><hr><h3 id=æ–¹æ¡ˆ-2nginx-å®‰è£…åœ¨å…¬ç½‘><strong>æ–¹æ¡ˆ 2ï¼šNginx å®‰è£…åœ¨å…¬ç½‘</strong></h3><h3 id=æ¶æ„æè¿°-1><strong>æ¶æ„æè¿°</strong></h3><ul><li><p><strong>Nginx</strong>ï¼šéƒ¨ç½²åœ¨å…¬ç½‘æœåŠ¡å™¨ï¼Œä½œä¸ºåå‘ä»£ç†ã€‚</p></li><li><p><strong>frp</strong>ï¼šå°†å†…ç½‘ Gitea æš´éœ²åˆ°å…¬ç½‘ã€‚</p></li><li><p><strong>æµé‡è·¯å¾„</strong>ï¼š</p><pre tabindex=0><code>ç”¨æˆ·è®¿é—® --&gt; å…¬ç½‘ Nginx --&gt; å…¬ç½‘ frp æœåŠ¡ç«¯ --&gt; å†…ç½‘ frp å®¢æˆ·ç«¯ --&gt; å†…ç½‘ Gitea
</code></pre></li></ul><h3 id=é€‚ç”¨åœºæ™¯-1><strong>é€‚ç”¨åœºæ™¯</strong></h3><ul><li>å†…ç½‘æœåŠ¡å™¨æ— æ³•ç›´æ¥æš´éœ²åˆ°å…¬ç½‘ï¼Œä½†æœ‰ä¸€ä¸ªå…¬ç½‘æœåŠ¡å™¨å¯ç”¨ã€‚</li><li>å¸Œæœ›åœ¨å…¬ç½‘æœåŠ¡å™¨ä¸Šç»Ÿä¸€ç®¡ç† HTTPS å’Œåå‘ä»£ç†ï¼ˆåŒ…æ‹¬å¤šä¸ªæœåŠ¡ï¼‰ã€‚</li><li>éœ€è¦åœ¨å…¬ç½‘ Nginx ä¸Šé…ç½® SSL è¯ä¹¦ï¼ˆå¦‚ Let&rsquo;s Encryptï¼‰ã€‚</li></ul><h3 id=é…ç½®ç¤ºä¾‹-1><strong>é…ç½®ç¤ºä¾‹</strong></h3><ol><li><p><strong>frp å®¢æˆ·ç«¯é…ç½®ï¼ˆ<code>frpc.ini</code>ï¼‰</strong>ï¼š</p><pre tabindex=0><code>[common]
server_addr = your-frp-server.com  # å…¬ç½‘ frp æœåŠ¡ç«¯åœ°å€
server_port = 7000
token = your_token

[gitea-http]
type = http
local_ip = 192.168.1.100  # å†…ç½‘ Gitea åœ°å€
local_port = 3000
remote_port = 60080  # å…¬ç½‘æ˜ å°„ç«¯å£
custom_domains = git.example.com
</code></pre></li><li><p><strong>å…¬ç½‘ Nginx é…ç½®</strong>ï¼š</p><pre tabindex=0><code>server {
    listen 80;
    server_name git.example.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name git.example.com;

    ssl_certificate /etc/letsencrypt/live/git.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/git.example.com/privkey.pem;

    location / {
        proxy_pass &lt;http://127.0.0.1:60080&gt;;  # frp æ˜ å°„çš„æœ¬åœ°ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
</code></pre></li><li><p><strong>å…¬ç½‘ frp æœåŠ¡ç«¯é…ç½®ï¼ˆ<code>frps.ini</code>ï¼‰</strong>ï¼š</p><pre tabindex=0><code>[common]
bind_port = 7000
vhost_http_port = 60080
token = your_token
</code></pre></li></ol><hr><h3 id=å¯¹æ¯”ä¸¤ç§æ–¹æ¡ˆ><strong>å¯¹æ¯”ä¸¤ç§æ–¹æ¡ˆ</strong></h3><table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>Nginx åœ¨å†…ç½‘</strong></th><th><strong>Nginx åœ¨å…¬ç½‘</strong></th></tr></thead><tbody><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å†…ç½‘ç¯å¢ƒå¤æ‚ï¼Œéœ€é›†ä¸­ç®¡ç†å†…ç½‘æœåŠ¡</td><td>å…¬ç½‘æœåŠ¡å™¨å¯ç›´æ¥æ‰˜ç®¡ HTTPS å’Œä»£ç†</td></tr><tr><td><strong>HTTPS é…ç½®</strong></td><td>HTTPS éœ€ç”± frp æˆ–å…¶ä»–å·¥å…·å¤„ç†</td><td>HTTPS å¯ç›´æ¥åœ¨å…¬ç½‘ Nginx ä¸Šé…ç½®</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>frp è½¬å‘ HTTP æµé‡ï¼Œå¯èƒ½å¢åŠ å»¶è¿Ÿ</td><td>frp ä»…è½¬å‘åˆ°å†…ç½‘ï¼Œå…¬ç½‘ Nginx å¤„ç† HTTPS</td></tr><tr><td><strong>ç»´æŠ¤éš¾åº¦</strong></td><td>å†…ç½‘å’Œå…¬ç½‘åˆ†åˆ«ç®¡ç† Nginx å’Œ frp</td><td>å…¬ç½‘ç»Ÿä¸€ç®¡ç† Nginx å’Œ frp</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>æ›´é€‚åˆå•ä¸€å†…ç½‘ç¯å¢ƒ</td><td>æ›´é€‚åˆå¤šæœåŠ¡ç»Ÿä¸€æš´éœ²</td></tr></tbody></table><hr><h3 id=æ¨èé€‰æ‹©><strong>æ¨èé€‰æ‹©</strong></h3><ol><li><strong>ä¼˜å…ˆé€‰æ‹© Nginx åœ¨å…¬ç½‘</strong>ï¼š<ul><li>å¦‚æœæœ‰å…¬ç½‘æœåŠ¡å™¨ï¼Œå»ºè®®å°† Nginx éƒ¨ç½²åœ¨å…¬ç½‘ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç† HTTPS å’Œåå‘ä»£ç†ã€‚</li><li>æ­¤æ–¹æ¡ˆæ›´ç¬¦åˆç°ä»£ Web æœåŠ¡çš„æœ€ä½³å®è·µã€‚</li></ul></li><li><strong>é€‰æ‹© Nginx åœ¨å†…ç½‘</strong>ï¼š<ul><li>å¦‚æœæ²¡æœ‰å…¬ç½‘æœåŠ¡å™¨ï¼Œæˆ–è€…å¸Œæœ›åœ¨å†…ç½‘ç¯å¢ƒä¸­é›†ä¸­ç®¡ç†æ‰€æœ‰æœåŠ¡ã€‚</li><li>æ­¤æ–¹æ¡ˆé€‚ç”¨äºå®Œå…¨éš”ç¦»çš„å†…ç½‘ç¯å¢ƒã€‚</li></ul></li></ol><hr><h3 id=æ€»ç»“><strong>æ€»ç»“</strong></h3><ul><li><strong>Nginx åœ¨å†…ç½‘</strong>ï¼šé€‚åˆå†…ç½‘ç¯å¢ƒå¤æ‚ã€éœ€è¦é›†ä¸­ç®¡ç†åå‘ä»£ç†çš„åœºæ™¯ã€‚</li><li><strong>Nginx åœ¨å…¬ç½‘</strong>ï¼šé€‚åˆæœ‰å…¬ç½‘æœåŠ¡å™¨ã€éœ€è¦ç»Ÿä¸€ç®¡ç† HTTPS å’Œå¤šæœåŠ¡çš„åœºæ™¯ã€‚</li></ul><p>æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¶æ„ï¼Œå¹¶ç¡®ä¿é…ç½®çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ï¼</p><h3 id=è‡ªç­¾åè¯ä¹¦>è‡ªç­¾åè¯ä¹¦</h3><p>ä»¥ä¸‹æ˜¯å…³äº Nginx é…ç½®æ˜¯å¦å¿…é¡»ä½¿ç”¨åŸŸåå’Œ SSL çš„è¯¦ç»†è§£ç­”ï¼š</p><hr><h3 id=ä¸€nginx-é…ç½®æ ¸å¿ƒç»“è®º><strong>ä¸€ã€Nginx é…ç½®æ ¸å¿ƒç»“è®º</strong></h3><ol><li><strong>ä¸éœ€è¦åŸŸå</strong>ï¼šå¯ä»¥ç›´æ¥ä½¿ç”¨å…¬ç½‘ IP è¿›è¡Œè®¿é—®</li><li><strong>ä¸éœ€è¦ SSL</strong>ï¼šå¯ä»¥ä»…ä½¿ç”¨ HTTP åè®®</li><li><strong>ä½†å­˜åœ¨ä»¥ä¸‹é™åˆ¶</strong>ï¼š<ul><li>æ— æ³•ä½¿ç”¨ HTTPS åŠ å¯†</li><li>æµè§ˆå™¨ä¼šæ ‡è®° HTTP ä¸ºã€Œä¸å®‰å…¨ã€</li><li>éƒ¨åˆ†ç°ä»£ Web API è¦æ±‚ HTTPS</li></ul></li></ol><hr><h3 id=äºŒçº¯å…¬ç½‘-ip-é…ç½®æ–¹æ¡ˆ><strong>äºŒã€çº¯å…¬ç½‘ IP é…ç½®æ–¹æ¡ˆ</strong></h3><h3 id=1-åŸºç¡€-http-é…ç½®ç¤ºä¾‹><strong>1. åŸºç¡€ HTTP é…ç½®ç¤ºä¾‹</strong></h3><pre tabindex=0><code># /etc/nginx/conf.d/ip.conf
server {
    listen 80;                  # ç›‘å¬ 80 ç«¯å£
    server_name _;              # åŒ¹é…æ‰€æœ‰åŸŸå/IP

    location / {
        proxy_pass &lt;http://127.0.0.1:3000&gt;;  # è½¬å‘åˆ°å®é™…æœåŠ¡ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
</code></pre><h3 id=2-éªŒè¯é…ç½®><strong>2. éªŒè¯é…ç½®</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nginx -t          <span class=c1># æ£€æŸ¥é…ç½®è¯­æ³•</span>
</span></span><span class=line><span class=cl>sudo systemctl reload nginx  <span class=c1># é‡è½½é…ç½®</span>
</span></span></code></pre></div><h3 id=3-è®¿é—®æ–¹å¼><strong>3. è®¿é—®æ–¹å¼</strong></h3><pre tabindex=0><code>&lt;http://ä½ çš„å…¬ç½‘IP&gt;
</code></pre><hr><h3 id=ä¸‰æ½œåœ¨é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ><strong>ä¸‰ã€æ½œåœ¨é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</strong></h3><table><thead><tr><th><strong>é—®é¢˜</strong></th><th><strong>è¡¨ç°</strong></th><th><strong>è§£å†³æ–¹æ¡ˆ</strong></th></tr></thead><tbody><tr><td>æµè§ˆå™¨å®‰å…¨è­¦å‘Š</td><td>åœ°å€æ æ˜¾ç¤ºã€Œä¸å®‰å…¨ã€</td><td>å¯å¿½ç•¥ï¼Œä¸å½±å“åŸºç¡€åŠŸèƒ½ä½¿ç”¨</td></tr><tr><td>ISP å±è”½ 80 ç«¯å£</td><td>æ— æ³•è®¿é—® HTTP æœåŠ¡</td><td>æ”¹ç”¨éæ ‡å‡†ç«¯å£ï¼ˆå¦‚ 8080ï¼‰</td></tr><tr><td>æ•æ„Ÿä¿¡æ¯æ˜æ–‡ä¼ è¾“</td><td>å¯†ç /æ•°æ®å¯èƒ½è¢«æˆªè·</td><td>å†…ç½‘ä½¿ç”¨æˆ–ä¸´æ—¶æµ‹è¯•å¯æ¥å—</td></tr><tr><td>æ— æ³•ä½¿ç”¨éƒ¨åˆ† Web åŠŸèƒ½</td><td>å¦‚åœ°ç†ä½ç½® APIã€PWA ç­‰åŠŸèƒ½å—é™</td><td>å‡çº§åˆ° HTTPS</td></tr></tbody></table><hr><h3 id=å››æ¨èæ”¹è¿›æ–¹æ¡ˆ><strong>å››ã€æ¨èæ”¹è¿›æ–¹æ¡ˆ</strong></h3><h3 id=æ–¹æ¡ˆ-1è‡ªç­¾åè¯ä¹¦--https><strong>æ–¹æ¡ˆ 1ï¼šè‡ªç­¾åè¯ä¹¦ + HTTPS</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</span>
</span></span><span class=line><span class=cl>sudo mkdir -p /etc/nginx/ssl
</span></span><span class=line><span class=cl>sudo openssl req -x509 -nodes -days <span class=m>365</span> -newkey rsa:2048 <span class=se>\\</span>
</span></span><span class=line><span class=cl>-keyout /etc/nginx/ssl/self.key <span class=se>\\</span>
</span></span><span class=line><span class=cl>-out /etc/nginx/ssl/self.crt
</span></span></code></pre></div><pre tabindex=0><code># Nginx é…ç½®
server {
    listen 443 ssl;
    server_name ä½ çš„å…¬ç½‘IP;

    ssl_certificate /etc/nginx/ssl/self.crt;
    ssl_certificate_key /etc/nginx/ssl/self.key;

    location / {
        proxy_pass &lt;http://127.0.0.1:3000&gt;;
    }
}
</code></pre><p><strong>è®¿é—®æ–¹å¼</strong>ï¼š<code>https://ä½ çš„å…¬ç½‘IP</code>ï¼ˆéœ€æ‰‹åŠ¨ä¿¡ä»»è¯ä¹¦ï¼‰</p><h3 id=æ–¹æ¡ˆ-2å…è´¹åŸŸå--let><strong>æ–¹æ¡ˆ 2ï¼šå…è´¹åŸŸå + Let&rsquo;s Encrypt</strong></h3><ol><li>æ³¨å†Œ <a href=https://www.duckdns.org/ target=_blank rel="noopener noreffer">DuckDNS</a> è·å–å…è´¹å­åŸŸå</li><li>ä½¿ç”¨ Certbot è‡ªåŠ¨è·å–è¯ä¹¦ï¼š</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certbot certonly --standalone -d ä½ çš„åŸŸå.duckdns.org
</span></span></code></pre></div><ol><li>è‡ªåŠ¨é…ç½® HTTPSï¼š</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certbot --nginx -d ä½ çš„åŸŸå.duckdns.org
</span></span></code></pre></div><hr><h3 id=äº”é˜²ç«å¢™é…ç½®><strong>äº”ã€é˜²ç«å¢™é…ç½®</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å¼€æ”¾ HTTP ç«¯å£</span>
</span></span><span class=line><span class=cl>sudo firewall-cmd --permanent --add-service<span class=o>=</span>http
</span></span><span class=line><span class=cl><span class=c1># æˆ–è‡ªå®šä¹‰ç«¯å£ï¼ˆå¦‚ 8080ï¼‰</span>
</span></span><span class=line><span class=cl>sudo firewall-cmd --permanent --add-port<span class=o>=</span>8080/tcp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo firewall-cmd --reload
</span></span></code></pre></div><hr><h3 id=å…­æ€§èƒ½å¯¹æ¯”><strong>å…­ã€æ€§èƒ½å¯¹æ¯”</strong></h3><table><thead><tr><th><strong>æŒ‡æ ‡</strong></th><th><strong>HTTP</strong></th><th><strong>HTTPS</strong></th></tr></thead><tbody><tr><td>è¿æ¥é€Ÿåº¦</td><td>ç•¥å¿«ï¼ˆæ— åŠ å¯†å¼€é”€ï¼‰</td><td>ç¨æ…¢ï¼ˆTLS æ¡æ‰‹ï¼‰</td></tr><tr><td>å®‰å…¨æ€§</td><td>æ•°æ®æ˜æ–‡ä¼ è¾“</td><td>å…¨æµé‡åŠ å¯†</td></tr><tr><td>æµè§ˆå™¨å…¼å®¹æ€§</td><td>æ‰€æœ‰æµè§ˆå™¨æ”¯æŒ</td><td>éœ€è¦æœ‰æ•ˆè¯ä¹¦</td></tr><tr><td>SEO æ’å</td><td>å¯èƒ½å½±å“æœç´¢æ’å</td><td>Google ä¼˜å…ˆç´¢å¼• HTTPS</td></tr></tbody></table><hr><h3 id=ä¸ƒæ“ä½œå»ºè®®><strong>ä¸ƒã€æ“ä½œå»ºè®®</strong></h3><ol><li><strong>ä¸´æ—¶æµ‹è¯•/å†…ç½‘ä½¿ç”¨</strong><ul><li>ç›´æ¥ä½¿ç”¨ <code>http://å…¬ç½‘IP</code>ï¼Œæ— éœ€é¢å¤–é…ç½®</li></ul></li><li><strong>å…¬ç½‘é•¿æœŸæœåŠ¡</strong><ul><li>è‡³å°‘ä½¿ç”¨è‡ªç­¾åè¯ä¹¦å¯ç”¨ HTTPS</li><li>æœ€ä½³å®è·µï¼šæ³¨å†Œå…è´¹åŸŸå + Let&rsquo;s Encrypt è¯ä¹¦</li></ul></li><li><strong>æ•æ„Ÿæ•°æ®å¤„ç†</strong><ul><li>å¿…é¡»ä½¿ç”¨å¯ä¿¡ CA ç­¾å‘çš„ SSL è¯ä¹¦</li></ul></li></ol><hr><p>é€šè¿‡ä»¥ä¸Šæ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚çµæ´»é€‰æ‹©é…ç½®æ–¹å¼ã€‚å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œ<strong>å¼ºçƒˆå»ºè®®ä½¿ç”¨åŸŸå + HTTPS</strong> ä»¥ç¡®ä¿å®‰å…¨æ€§å’Œå…¼å®¹æ€§ã€‚</p><h3 id=é…ç½®æµç¨‹-deepseek>é…ç½®æµç¨‹ deepseek</h3><p>ä»¥ä¸‹æ˜¯åŸºäº CentOS ç³»ç»Ÿçš„ <strong>Gitea + frp + Nginx</strong> å…¬ç½‘è®¿é—®å®Œæ•´é…ç½®æ–¹æ¡ˆï¼š</p><hr><h3 id=ä¸€æ¶æ„è¯´æ˜>ä¸€ã€æ¶æ„è¯´æ˜</h3><pre tabindex=0><code>ç”¨æˆ·æµè§ˆå™¨
   â†“ HTTPS
[å…¬ç½‘æœåŠ¡å™¨] CentOS 7/8/9
   â”œâ”€ Nginxï¼ˆSSL ç»ˆç«¯ + åå‘ä»£ç†ï¼‰
   â””â”€ frp æœåŠ¡ç«¯ï¼ˆfrpsï¼‰
         â†“ åŠ å¯†éš§é“
[å†…ç½‘æœåŠ¡å™¨]
   â”œâ”€ Giteaï¼ˆç«¯å£3000ï¼‰
   â””â”€ frp å®¢æˆ·ç«¯ï¼ˆfrpcï¼‰
</code></pre><hr><h3 id=äºŒå…¬ç½‘æœåŠ¡å™¨é…ç½®centos>äºŒã€å…¬ç½‘æœåŠ¡å™¨é…ç½®ï¼ˆCentOSï¼‰</h3><h3 id=1-å®‰è£…ä¾èµ–>1. å®‰è£…ä¾èµ–</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…åŸºç¡€å·¥å…·</span>
</span></span><span class=line><span class=cl>sudo yum install -y wget git vim firewalld
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¯åŠ¨é˜²ç«å¢™</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now firewalld
</span></span></code></pre></div><h3 id=2-å®‰è£…é…ç½®-frp-æœåŠ¡ç«¯>2. å®‰è£…é…ç½® frp æœåŠ¡ç«¯</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ä¸‹è½½æœ€æ–°ç‰ˆ frp</span>
</span></span><span class=line><span class=cl>wget &lt;https://github.com/fatedier/frp/releases/download/v0.52.3/frp_0.52.3_linux_amd64.tar.gz&gt;
</span></span><span class=line><span class=cl>tar -zxvf frp_*.tar.gz
</span></span><span class=line><span class=cl>sudo mv frp_*/frps /usr/local/bin/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ›å»ºé…ç½®æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>sudo mkdir -p /etc/frp
</span></span><span class=line><span class=cl>sudo vim /etc/frp/frps.ini
</span></span></code></pre></div><pre tabindex=0><code>[common]
bind_port = 7000
token = your_secure_token_123  # è‡ªå®šä¹‰å®‰å…¨ä»¤ç‰Œ
allow_ports = 3000-4000       # å…è®¸è½¬å‘çš„ç«¯å£èŒƒå›´

# å¯ç”¨ä»ªè¡¨ç›˜ï¼ˆå¯é€‰ï¼‰
dashboard_port = 7500
dashboard_user = admin
dashboard_pwd = dashboard@123
</code></pre><h3 id=3-é…ç½®-systemd-æœåŠ¡>3. é…ç½® systemd æœåŠ¡</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/systemd/system/frps.service
</span></span></code></pre></div><pre tabindex=0><code>[Unit]
Description=Frp Server
After=network.target

[Service]
ExecStart=/usr/local/bin/frps -c /etc/frp/frps.ini
Restart=on-failure

[Install]
WantedBy=multi-user.target
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now frps
</span></span></code></pre></div><h3 id=4-é˜²ç«å¢™å¼€æ”¾ç«¯å£>4. é˜²ç«å¢™å¼€æ”¾ç«¯å£</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo firewall-cmd --permanent --add-port<span class=o>=</span>7000/tcp   <span class=c1># frpæœåŠ¡ç«¯å£</span>
</span></span><span class=line><span class=cl>sudo firewall-cmd --permanent --add-port<span class=o>=</span>80/tcp     <span class=c1># HTTP</span>
</span></span><span class=line><span class=cl>sudo firewall-cmd --permanent --add-port<span class=o>=</span>443/tcp    <span class=c1># HTTPS</span>
</span></span><span class=line><span class=cl>sudo firewall-cmd --permanent --add-port<span class=o>=</span>7500/tcp   <span class=c1># ä»ªè¡¨ç›˜ç«¯å£ï¼ˆå¯é€‰ï¼‰</span>
</span></span><span class=line><span class=cl>sudo firewall-cmd --reload
</span></span></code></pre></div><hr><h3 id=ä¸‰nginx-é…ç½®ssl-åå‘ä»£ç†>ä¸‰ã€Nginx é…ç½®ï¼ˆSSL åå‘ä»£ç†ï¼‰</h3><h3 id=1-å®‰è£…-nginx>1. å®‰è£… Nginx</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install -y epel-release
</span></span><span class=line><span class=cl>sudo yum install -y nginx
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now nginx
</span></span></code></pre></div><h3 id=2-ç”³è¯·-ssl-è¯ä¹¦lets-encrypt>2. ç”³è¯· SSL è¯ä¹¦ï¼ˆLet&rsquo;s Encryptï¼‰</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yum install -y certbot python3-certbot-nginx
</span></span><span class=line><span class=cl>sudo certbot certonly --nginx -d git.yourdomain.com
</span></span></code></pre></div><p>è¯ä¹¦å°†ä¿å­˜åœ¨ï¼š</p><p><code>/etc/letsencrypt/live/git.yourdomain.com/</code></p><h3 id=3-é…ç½®åå‘ä»£ç†>3. é…ç½®åå‘ä»£ç†</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/nginx/conf.d/gitea.conf
</span></span></code></pre></div><pre tabindex=0><code>server {
    listen 80;
    server_name git.yourdomain.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name git.yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/git.yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/git.yourdomain.com/privkey.pem;

    location / {
        proxy_pass &lt;http://127.0.0.1:8000&gt;;  # è½¬å‘åˆ°frpæ˜ å°„ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # å¯é€‰ï¼šé™åˆ¶è®¿é—®IP
        # allow 192.168.1.0/24;
        # deny all;
    }
}
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nginx -t <span class=o>&amp;&amp;</span> sudo systemctl reload nginx
</span></span></code></pre></div><hr><h3 id=å››å†…ç½‘æœåŠ¡å™¨é…ç½®gitea--frp-å®¢æˆ·ç«¯>å››ã€å†…ç½‘æœåŠ¡å™¨é…ç½®ï¼ˆGitea + frp å®¢æˆ·ç«¯ï¼‰</h3><h3 id=1-å®‰è£…-gitea>1. å®‰è£… Gitea</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># åˆ›å»ºç”¨æˆ·</span>
</span></span><span class=line><span class=cl>sudo useradd -m -s /bin/bash git
</span></span><span class=line><span class=cl>sudo su - git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸‹è½½å®‰è£…</span>
</span></span><span class=line><span class=cl>wget -O gitea &lt;https://dl.gitea.com/gitea/1.21.0/gitea-1.21.0-linux-amd64&gt;
</span></span><span class=line><span class=cl>chmod +x gitea
</span></span><span class=line><span class=cl>./gitea web -p <span class=m>3000</span>  <span class=c1># æµ‹è¯•è¿è¡Œ</span>
</span></span></code></pre></div><h3 id=2-é…ç½®-systemd-æœåŠ¡>2. é…ç½® systemd æœåŠ¡</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/systemd/system/gitea.service
</span></span></code></pre></div><pre tabindex=0><code>[Unit]
Description=Gitea
After=network.target

[Service]
User=git
Group=git
WorkingDirectory=/home/git/
ExecStart=/home/git/gitea web -c /home/git/custom/conf/app.ini
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now gitea
</span></span></code></pre></div><h3 id=3-é…ç½®-frp-å®¢æˆ·ç«¯>3. é…ç½® frp å®¢æˆ·ç«¯</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget &lt;https://github.com/fatedier/frp/releases/download/v0.52.3/frp_0.52.3_linux_amd64.tar.gz&gt;
</span></span><span class=line><span class=cl>tar -zxvf frp_*.tar.gz
</span></span><span class=line><span class=cl>sudo mv frp_*/frpc /usr/local/bin/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo mkdir -p /etc/frp
</span></span><span class=line><span class=cl>sudo vim /etc/frp/frpc.ini
</span></span></code></pre></div><pre tabindex=0><code>[common]
server_addr = å…¬ç½‘æœåŠ¡å™¨IP
server_port = 7000
token = your_secure_token_123  # ä¸frpsä¸€è‡´

[gitea-http]
type = tcp
local_ip = 127.0.0.1
local_port = 3000
remote_port = 8000  # å¯¹åº”Nginxçš„proxy_passç«¯å£
</code></pre><h3 id=4-é…ç½®å®¢æˆ·ç«¯æœåŠ¡>4. é…ç½®å®¢æˆ·ç«¯æœåŠ¡</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vim /etc/systemd/system/frpc.service
</span></span></code></pre></div><pre tabindex=0><code>[Unit]
Description=Frp Client
After=network.target

[Service]
ExecStart=/usr/local/bin/frpc -c /etc/frp/frpc.ini
Restart=on-failure

[Install]
WantedBy=multi-user.target
</code></pre><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now frpc
</span></span></code></pre></div><hr><h3 id=äº”gitea-å…³é”®é…ç½®>äº”ã€Gitea å…³é”®é…ç½®</h3><pre tabindex=0><code># /home/git/custom/conf/app.ini
[server]
DOMAIN           = git.yourdomain.com
HTTP_PORT        = 3000
ROOT_URL         = &lt;https://git.yourdomain.com/&gt;
</code></pre><hr><h3 id=å…­éªŒè¯ä¸ç»´æŠ¤>å…­ã€éªŒè¯ä¸ç»´æŠ¤</h3><h3 id=1-æœåŠ¡çŠ¶æ€æ£€æŸ¥>1. æœåŠ¡çŠ¶æ€æ£€æŸ¥</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å…¬ç½‘æœåŠ¡å™¨</span>
</span></span><span class=line><span class=cl>sudo systemctl status frps nginx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å†…ç½‘æœåŠ¡å™¨</span>
</span></span><span class=line><span class=cl>sudo systemctl status frpc gitea
</span></span></code></pre></div><h3 id=2-æ—¥å¿—ç›‘æ§>2. æ—¥å¿—ç›‘æ§</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># frpæœåŠ¡ç«¯æ—¥å¿—</span>
</span></span><span class=line><span class=cl>journalctl -u frps -f
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giteaè®¿é—®æ—¥å¿—</span>
</span></span><span class=line><span class=cl>tail -f /home/git/gitea/log/gitea.log
</span></span></code></pre></div><h3 id=3-é˜²ç«å¢™çŠ¶æ€æ£€æŸ¥>3. é˜²ç«å¢™çŠ¶æ€æ£€æŸ¥</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo firewall-cmd --list-all  <span class=c1># CentOS</span>
</span></span></code></pre></div><h3 id=4-è¯ä¹¦è‡ªåŠ¨ç»­ç­¾>4. è¯ä¹¦è‡ªåŠ¨ç»­ç­¾</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo crontab -e
</span></span><span class=line><span class=cl><span class=c1># æ·»åŠ ï¼š</span>
</span></span><span class=line><span class=cl><span class=m>0</span> <span class=m>3</span> * * * /usr/bin/certbot renew --quiet
</span></span></code></pre></div><hr><h3 id=ä¸ƒæ•…éšœæ’æŸ¥æŒ‡å—>ä¸ƒã€æ•…éšœæ’æŸ¥æŒ‡å—</h3><table><thead><tr><th><strong>ç°è±¡</strong></th><th><strong>æ£€æŸ¥ç‚¹</strong></th></tr></thead><tbody><tr><td>æ— æ³•è®¿é—®HTTPS</td><td>1. æ£€æŸ¥è¯ä¹¦è·¯å¾„æ˜¯å¦æ­£ç¡®<br>2. ç¡®è®¤443ç«¯å£å¼€æ”¾</td></tr><tr><td>frpè¿æ¥å¤±è´¥</td><td>1. éªŒè¯tokenä¸€è‡´æ€§<br>2. æ£€æŸ¥7000ç«¯å£è¿é€šæ€§</td></tr><tr><td>Giteaæ˜¾ç¤ºIPé”™è¯¯</td><td>æ£€æŸ¥Nginxçš„<code>X-Forwarded-For</code>å¤´æ˜¯å¦æ­£ç¡®ä¼ é€’</td></tr><tr><td>å†…ç½‘æ›´æ–°åå¤–ç½‘ä¸ç”Ÿæ•ˆ</td><td>é‡å¯frpcæœåŠ¡ï¼š<code>sudo systemctl restart frpc</code></td></tr></tbody></table><hr><p>é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œå¯å®ç°å†…ç½‘GiteaæœåŠ¡é€šè¿‡å…¬ç½‘Nginxçš„å®‰å…¨è®¿é—®ã€‚æ­¤æ–¹æ¡ˆå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p><ol><li><strong>HTTPSåŠ å¯†</strong>ï¼šé€šè¿‡Let&rsquo;s Encryptå®ç°å…è´¹SSL</li><li><strong>å®‰å…¨éš”ç¦»</strong>ï¼šå†…ç½‘æœåŠ¡ä¸ç›´æ¥æš´éœ²å…¬ç½‘</li><li><strong>é«˜å¯ç»´æŠ¤æ€§</strong>ï¼šä½¿ç”¨systemdæœåŠ¡ç®¡ç†</li><li><strong>çµæ´»æ‰©å±•</strong>ï¼šå¯è½»æ¾æ·»åŠ æ›´å¤šå†…ç½‘æœåŠ¡ç©¿é€</li></ol><h3 id=è¯¦ç»†é…ç½®>è¯¦ç»†é…ç½®</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir -p /etc/nginx/ssl
</span></span><span class=line><span class=cl>sudo chmod <span class=m>700</span> /etc/nginx/ssl
</span></span><span class=line><span class=cl>sudo openssl req -x509 -nodes -days <span class=m>365</span> -newkey rsa:2048 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-keyout /etc/nginx/ssl/self.key <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-out /etc/nginx/ssl/self.crt
</span></span><span class=line><span class=cl><span class=c1>#å¡«å†™ä¿¡æ¯æ—¶ï¼ŒCommon Name å¡«å†™æœåŠ¡å™¨ IP æˆ–ä»»æ„åç§°ï¼ˆå¦‚ gitea.localï¼‰</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo vim /etc/nginx/conf.d/gitea.conf
</span></span><span class=line><span class=cl><span class=c1># Nginx é…ç½®1</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen <span class=m>443</span> ssl<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name ä½ çš„å…¬ç½‘IP<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ssl_certificate /etc/nginx/ssl/self.crt<span class=p>;</span>
</span></span><span class=line><span class=cl>    ssl_certificate_key /etc/nginx/ssl/self.key<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / <span class=o>{</span>
</span></span><span class=line><span class=cl>        proxy_pass http://127.0.0.1:3000<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=c1># Nginx é…ç½®2</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen <span class=m>443</span> ssl<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name ä½ çš„æœåŠ¡å™¨IP<span class=p>;</span>  <span class=c1># å¦‚ 123.123.123.123</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ssl_certificate /etc/nginx/ssl/self.crt<span class=p>;</span>
</span></span><span class=line><span class=cl>    ssl_certificate_key /etc/nginx/ssl/self.key<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># åŠ å¯†åè®®é…ç½®</span>
</span></span><span class=line><span class=cl>    ssl_protocols TLSv1.2 TLSv1.3<span class=p>;</span>
</span></span><span class=line><span class=cl>    ssl_ciphers HIGH:!aNULL:!MD5<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / <span class=o>{</span>
</span></span><span class=line><span class=cl>        proxy_pass http://127.0.0.1:8000<span class=p>;</span>  <span class=c1># æ ¹æ®å®é™…ä»£ç†ç«¯å£è°ƒæ•´</span>
</span></span><span class=line><span class=cl>        proxy_set_header Host <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name ä½ çš„æœåŠ¡å™¨IP<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=m>301</span> https://<span class=nv>$host$request_uri</span><span class=p>;</span>  <span class=c1># HTTP å¼ºåˆ¶è·³è½¬ HTTPS</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nginx é…ç½®3</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name git.yourdomain.com<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=m>301</span> https://<span class=nv>$host$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen <span class=m>443</span> ssl<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name git.yourdomain.com<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ssl_certificate /etc/letsencrypt/live/git.yourdomain.com/fullchain.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>    ssl_certificate_key /etc/letsencrypt/live/git.yourdomain.com/privkey.pem<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / <span class=o>{</span>
</span></span><span class=line><span class=cl>        proxy_pass http://127.0.0.1:8000<span class=p>;</span>  <span class=c1># è½¬å‘åˆ°frpæ˜ å°„ç«¯å£</span>
</span></span><span class=line><span class=cl>        proxy_set_header Host <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># å¯é€‰ï¼šé™åˆ¶è®¿é—®IP</span>
</span></span><span class=line><span class=cl>        <span class=c1># allow 192.168.1.0/24;</span>
</span></span><span class=line><span class=cl>        <span class=c1># deny all;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¦‚æœéœ€è¦ SSH é€šè¿‡ Nginx ä»£ç†ï¼ˆå¯é€‰ï¼‰</span>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 2222<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name git.example.com<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / <span class=o>{</span>
</span></span><span class=line><span class=cl>        proxy_pass http://127.0.0.1:2222<span class=p>;</span>  <span class=c1># frp æ˜ å°„çš„ SSH ç«¯å£</span>
</span></span><span class=line><span class=cl>        proxy_set_header Host <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥å¹¶é‡è½½é…ç½®</span>
</span></span><span class=line><span class=cl>sudo nginx -t
</span></span><span class=line><span class=cl>sudo systemctl reload nginx
</span></span></code></pre></div><h3 id=åŸŸåè®¿é—®>åŸŸåè®¿é—®</h3><p><code>æ²¡æœ‰å…¬å…±åŸŸåï¼Œåªèƒ½å±€åŸŸç½‘è®¿é—®</code></p><p><strong>ä¸è¦å¼€ä»£ç†ï¼ï¼ï¼</strong></p><p><strong>ä¸è¦å¼€ä»£ç†ï¼ï¼ï¼</strong></p><p><strong>ä¸è¦å¼€ä»£ç†ï¼ï¼ï¼</strong></p><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨ <strong>Common Nameï¼ˆè‡ªå®šä¹‰åŸŸåï¼‰</strong> è®¿é—® Nginx + Gitea æœåŠ¡çš„å®Œæ•´é…ç½®æ–¹æ¡ˆï¼Œæ— éœ€å…¬ç½‘ IP å’Œæ­£å¼åŸŸåï¼š</p><hr><h3 id=ä¸€æ ¸å¿ƒæ€è·¯><strong>ä¸€ã€æ ¸å¿ƒæ€è·¯</strong></h3><ol><li><strong>æœ¬åœ° DNS è§£æ</strong>ï¼šé€šè¿‡ä¿®æ”¹ hosts æ–‡ä»¶æˆ–å†…ç½‘ DNS æœåŠ¡å™¨ï¼Œå°†è‡ªå®šä¹‰åŸŸåï¼ˆå¦‚ <code>gitea.local</code>ï¼‰æŒ‡å‘æœåŠ¡å™¨ IP</li><li><strong>è‡ªç­¾åè¯ä¹¦</strong>ï¼šç”Ÿæˆ Common Name åŒ¹é…è‡ªå®šä¹‰åŸŸåçš„è¯ä¹¦</li><li><strong>Nginx é…ç½®</strong>ï¼šåŸºäºåŸŸåé…ç½®åå‘ä»£ç†å’Œ SSL</li><li><strong>Gitea é…ç½®</strong>ï¼šé€‚é…è‡ªå®šä¹‰åŸŸå</li></ol><hr><h3 id=äºŒæ“ä½œæ­¥éª¤><strong>äºŒã€æ“ä½œæ­¥éª¤</strong></h3><h3 id=1-è®¾ç½®æœ¬åœ°-dns-è§£æ><strong>1. è®¾ç½®æœ¬åœ° DNS è§£æ</strong></h3><h3 id=windows-ç³»ç»Ÿ>Windows ç³»ç»Ÿï¼š</h3><ol><li><p>ä»¥ç®¡ç†å‘˜èº«ä»½ç¼–è¾‘æ–‡ä»¶ï¼š<code>C:\\Windows\\System32\\drivers\\etc\\hosts</code></p></li><li><p>æ·»åŠ è®°å½•ï¼š</p><pre tabindex=0><code>192.168.1.100  gitea.local  # æ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨å†…ç½‘IP
</code></pre></li></ol><h3 id=linuxmacos-ç³»ç»Ÿ>Linux/macOS ç³»ç»Ÿï¼š</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/hosts
</span></span><span class=line><span class=cl><span class=c1># æ·»åŠ ç›¸åŒè®°å½•</span>
</span></span></code></pre></div><h3 id=2-ç”Ÿæˆè‡ªç­¾åè¯ä¹¦><strong>2. ç”Ÿæˆè‡ªç­¾åè¯ä¹¦</strong></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir -p /etc/nginx/ssl
</span></span><span class=line><span class=cl>sudo openssl req -x509 -nodes -days <span class=m>365</span> -newkey rsa:2048 <span class=se>\\</span>
</span></span><span class=line><span class=cl>-keyout /etc/nginx/ssl/gitea.key <span class=se>\\</span>
</span></span><span class=line><span class=cl>-out /etc/nginx/ssl/gitea.crt
</span></span></code></pre></div><ul><li><p><strong>å…³é”®å¡«å†™é¡¹</strong>ï¼š</p><pre tabindex=0><code>Common Name (e.g. server FQDN) []:gitea.local  # å¿…é¡»ä¸è®¿é—®åŸŸåä¸€è‡´
</code></pre></li></ul><h3 id=3-é…ç½®-nginx><strong>3. é…ç½® Nginx</strong></h3><pre tabindex=0><code># /etc/nginx/conf.d/gitea.conf
server {
    listen 80;
    server_name gitea.local;
    return 301 https://$host$request_uri;  # HTTP å¼ºåˆ¶è·³è½¬ HTTPS
}

server {
    listen 443 ssl;
    server_name gitea.local;

    ssl_certificate /etc/nginx/ssl/gitea.crt;
    ssl_certificate_key /etc/nginx/ssl/gitea.key;

    location / {
        proxy_pass &lt;http://localhost:3000&gt;;  # Gitea å®é™…ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
</code></pre><p>éªŒè¯å¹¶é‡è½½é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nginx -t <span class=o>&amp;&amp;</span> sudo systemctl reload nginx
</span></span></code></pre></div><h3 id=4-è°ƒæ•´-gitea-é…ç½®><strong>4. è°ƒæ•´ Gitea é…ç½®</strong></h3><pre tabindex=0><code># /etc/gitea/app.ini
[server]
DOMAIN           = gitea.local
ROOT_URL         = &lt;https://gitea.local/&gt;
</code></pre><p>é‡å¯æœåŠ¡ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart gitea
</span></span></code></pre></div><hr><h3 id=ä¸‰éªŒè¯è®¿é—®><strong>ä¸‰ã€éªŒè¯è®¿é—®</strong></h3><ol><li><p>æµè§ˆå™¨è®¿é—®ï¼š</p><p><code>https://gitea.local</code></p><ul><li>é¦–æ¬¡è®¿é—®éœ€æ‰‹åŠ¨ä¿¡ä»»è¯ä¹¦ï¼ˆç‚¹å‡»ã€Œé«˜çº§ã€â†’ã€Œç»§ç»­è®¿é—®ã€ï¼‰</li></ul></li><li><p>å‘½ä»¤è¡Œæµ‹è¯•ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -vk &lt;https://gitea.local&gt;
</span></span><span class=line><span class=cl><span class=c1># -k å‚æ•°å¿½ç•¥è¯ä¹¦éªŒè¯</span>
</span></span></code></pre></div></li></ol><hr><h3 id=å››é«˜çº§é…ç½®å¯é€‰><strong>å››ã€é«˜çº§é…ç½®ï¼ˆå¯é€‰ï¼‰</strong></h3><h3 id=1-å†…ç½‘-dns-æœåŠ¡å™¨é…ç½®><strong>1. å†…ç½‘ DNS æœåŠ¡å™¨é…ç½®</strong></h3><p>å¦‚æœæœ‰å¤šå°è®¾å¤‡éœ€è¦è®¿é—®ï¼Œå¯åœ¨è·¯ç”±å™¨æˆ–å†…ç½‘ DNS æœåŠ¡å™¨æ·»åŠ è®°å½•ï¼š</p><pre tabindex=0><code>gitea.local  A  192.168.1.100
</code></pre><h3 id=2-è¯ä¹¦ä¿¡ä»»é…ç½®æ¶ˆé™¤æµè§ˆå™¨è­¦å‘Š><strong>2. è¯ä¹¦ä¿¡ä»»é…ç½®ï¼ˆæ¶ˆé™¤æµè§ˆå™¨è­¦å‘Šï¼‰</strong></h3><ul><li><p><strong>Windows</strong>ï¼š</p><p>åŒå‡» <code>gitea.crt</code> â†’ é€‰æ‹©ã€Œå®‰è£…è¯ä¹¦ã€â†’ å­˜å‚¨ä½ç½®é€‰ã€Œæœ¬åœ°è®¡ç®—æœºã€â†’ æ”¾å…¥ã€Œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„ã€</p></li><li><p><strong>macOS</strong>ï¼š</p><p>åŒå‡»è¯ä¹¦ â†’ é’¥åŒ™ä¸²è®¿é—® â†’ æ‹–æ‹½åˆ°ã€Œç³»ç»Ÿã€é’¥åŒ™ä¸² â†’ å³é”®é€‰æ‹©ã€Œå§‹ç»ˆä¿¡ä»»ã€</p></li><li><p><strong>Linuxï¼ˆUbuntuï¼‰</strong>ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo cp gitea.crt /usr/local/share/ca-certificates/
</span></span><span class=line><span class=cl>sudo update-ca-certificates
</span></span></code></pre></div></li></ul><h3 id=3-å¤šåŸŸåæ”¯æŒ><strong>3. å¤šåŸŸåæ”¯æŒ</strong></h3><p>ç”Ÿæˆè¯ä¹¦æ—¶ä½¿ç”¨ SANï¼ˆä¸»é¢˜å¤‡ç”¨åç§°ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo openssl req -x509 -nodes -days <span class=m>365</span> -newkey rsa:2048 <span class=se>\\</span>
</span></span><span class=line><span class=cl>-keyout /etc/nginx/ssl/gitea.key <span class=se>\\</span>
</span></span><span class=line><span class=cl>-out /etc/nginx/ssl/gitea.crt <span class=se>\\</span>
</span></span><span class=line><span class=cl>-addext <span class=s2>&#34;subjectAltName = DNS:gitea.local, DNS:git.internal&#34;</span>
</span></span></code></pre></div><hr><h3 id=äº”å¸¸è§é—®é¢˜æ’æŸ¥><strong>äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥</strong></h3><table><thead><tr><th><strong>é—®é¢˜ç°è±¡</strong></th><th><strong>æ’æŸ¥æ–¹æ³•</strong></th></tr></thead><tbody><tr><td>æµè§ˆå™¨æç¤ºã€Œè¯ä¹¦æ— æ•ˆã€</td><td>æ£€æŸ¥è¯ä¹¦ Common Name æ˜¯å¦ä¸è®¿é—®åŸŸåä¸€è‡´ï¼›ç¡®è®¤å®¢æˆ·ç«¯å·²ä¿¡ä»»è¯ä¹¦</td></tr><tr><td>è®¿é—®è¢«é‡ç½®</td><td>æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦æ”¾è¡Œ 443 ç«¯å£ï¼›ç¡®è®¤ Nginx æœåŠ¡æ­£å¸¸è¿è¡Œ</td></tr><tr><td>é¡µé¢æ ·å¼é”™ä¹±</td><td>æ£€æŸ¥ Gitea çš„ <code>ROOT_URL</code> é…ç½®æ˜¯å¦æ­£ç¡®ï¼›æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</td></tr><tr><td>ä»… HTTPS æ— æ³•è®¿é—®</td><td>ä½¿ç”¨ <code>curl -v</code> æŸ¥çœ‹è¯¦ç»†æ¡æ‰‹è¿‡ç¨‹ï¼›æ£€æŸ¥ Nginx é”™è¯¯æ—¥å¿— <code>/var/log/nginx/error.log</code></td></tr></tbody></table><hr><h3 id=å…­ç”Ÿäº§ç¯å¢ƒå»ºè®®><strong>å…­ã€ç”Ÿäº§ç¯å¢ƒå»ºè®®</strong></h3><ol><li><p><strong>æ­£å¼åŸŸåæ›¿ä»£</strong>ï¼š</p><p>è´­ä¹°å»‰ä»·åŸŸåï¼ˆå¦‚ <code>.xyz</code> åŸŸåçº¦ $1/å¹´ï¼‰ï¼Œä½¿ç”¨ Let&rsquo;s Encrypt å…è´¹è¯ä¹¦ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo certbot --nginx -d yourdomain.xyz
</span></span></code></pre></div></li><li><p><strong>DNS æœåŠ¡é€‰æ‹©</strong>ï¼š</p><ul><li>å…è´¹åŠ¨æ€ DNSï¼šDuckDNSã€No-IP</li><li>å•†ä¸š DNSï¼šCloudflareã€é˜¿é‡Œäº‘ DNS</li></ul></li><li><p><strong>è¯ä¹¦è‡ªåŠ¨åŒ–ç®¡ç†</strong>ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æ·»åŠ å®šæ—¶ä»»åŠ¡</span>
</span></span><span class=line><span class=cl>sudo crontab -e
</span></span><span class=line><span class=cl><span class=c1># æ·»åŠ ï¼š</span>
</span></span><span class=line><span class=cl><span class=m>0</span> <span class=m>3</span> * * * /usr/bin/certbot renew --quiet
</span></span></code></pre></div></li></ol><hr><p>é€šè¿‡ä»¥ä¸Šé…ç½®ï¼Œå³å¯é€šè¿‡è‡ªå®šä¹‰åŸŸåï¼ˆå¦‚ <code>gitea.local</code>ï¼‰å®‰å…¨è®¿é—®å†…ç½‘æœåŠ¡ï¼ŒåŒæ—¶ä¸ºåç»­æ‰©å±•å…¬ç½‘è®¿é—®å¥ å®šåŸºç¡€ã€‚</p><h2 id=frp-vs-nginx>frp vs. nginx</h2><h3 id=deepseek>deepseek</h3><p>ä»¥ä¸‹æ˜¯ Gitea ä½¿ç”¨ Nginx å’Œ frp ä½œä¸ºåå‘ä»£ç†çš„ä¸»è¦åŒºåˆ«åŠé€‚ç”¨åœºæ™¯åˆ†æï¼š</p><hr><h3 id=æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨><strong>æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨</strong></h3><table><thead><tr><th>ç‰¹æ€§</th><th>Nginx åå‘ä»£ç†</th><th>frp åå‘ä»£ç†</th></tr></thead><tbody><tr><td><strong>ä¸»è¦å®šä½</strong></td><td>Web æœåŠ¡å™¨ä¸“ç”¨ä»£ç†</td><td>å†…ç½‘ç©¿é€/å¤šåè®®é€šç”¨ä»£ç†</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td>å…¬ç½‘æœåŠ¡å™¨ç›´æ¥æš´éœ²æœåŠ¡</td><td>å†…ç½‘æœåŠ¡é€šè¿‡å…¬ç½‘ä¸­è½¬æš´éœ²</td></tr><tr><td><strong>åè®®æ”¯æŒ</strong></td><td>ä¸“æ³¨ HTTP/HTTPS/WebSocket</td><td>æ”¯æŒ TCP/UDP/HTTP/HTTPS ç­‰å¤šåè®®</td></tr><tr><td><strong>SSL ç»ˆç«¯</strong></td><td>åŸç”Ÿæ”¯æŒï¼ˆLet&rsquo;s Encrypt é›†æˆï¼‰</td><td>ä¾èµ–å®¢æˆ·ç«¯é…ç½®æˆ–å¤–éƒ¨è¯ä¹¦</td></tr><tr><td><strong>æ€§èƒ½ä¼˜åŒ–</strong></td><td>è¿æ¥æ± ã€ç¼“å­˜ã€Gzip ç­‰é«˜çº§ä¼˜åŒ–</td><td>åŸºç¡€è½¬å‘ï¼Œæ—  Web ä¸“ç”¨ä¼˜åŒ–</td></tr><tr><td><strong>é…ç½®å¤æ‚åº¦</strong></td><td>è¾ƒé«˜ï¼ˆéœ€ç†Ÿæ‚‰ Nginx è¯­æ³•ï¼‰</td><td>è¾ƒä½ï¼ˆINI æ ¼å¼ç®€å•é…ç½®ï¼‰</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>WAF èƒ½åŠ›ã€è®¿é—®æ§åˆ¶ã€é€Ÿç‡é™åˆ¶</td><td>ä¾èµ–ä¼ è¾“å±‚åŠ å¯†ï¼ˆå¦‚ TLSï¼‰</td></tr><tr><td><strong>éƒ¨ç½²æˆæœ¬</strong></td><td>éœ€å…¬ç½‘æœåŠ¡å™¨</td><td>éœ€è¦å…¬ç½‘æœåŠ¡å™¨ä½œä¸ºä¸­è½¬èŠ‚ç‚¹</td></tr></tbody></table><hr><h3 id=ä¸€åŠŸèƒ½å®šä½å·®å¼‚><strong>ä¸€ã€åŠŸèƒ½å®šä½å·®å¼‚</strong></h3><h3 id=nginx-åå‘ä»£ç†><strong>Nginx åå‘ä»£ç†</strong></h3><ul><li><p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼šä¸“ä¸šçš„ Web æœåŠ¡æµé‡ç®¡ç†</p></li><li><p><strong>å…¸å‹ç”¨ä¾‹</strong>ï¼š</p><pre tabindex=0><code># ç¤ºä¾‹ï¼šGitea çš„ HTTPS ä»£ç†é…ç½®
server {
    listen 443 ssl;
    server_name git.yourdomain.com;

    ssl_certificate /path/to/fullchain.pem;
    ssl_certificate_key /path/to/privkey.pem;

    location / {
        proxy_pass &lt;http://localhost:3000&gt;;
        proxy_set_header Host $host;
    }
}
</code></pre></li><li><p><strong>ä¼˜åŠ¿åœºæ™¯</strong>ï¼š</p><ul><li>éœ€è¦ HTTPS åŠ å¯†</li><li>é™æ€èµ„æºç¼“å­˜åŠ é€Ÿ</li><li>å¤šæœåŠ¡å…±äº« 443 ç«¯å£ï¼ˆåŸºäºåŸŸåè·¯ç”±ï¼‰</li></ul></li></ul><h3 id=frp-åå‘ä»£ç†><strong>frp åå‘ä»£ç†</strong></h3><ul><li><p><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼šç©¿é€ NAT/é˜²ç«å¢™å®ç°æœåŠ¡æš´éœ²</p></li><li><p><strong>å…¸å‹ç”¨ä¾‹</strong>ï¼š</p><pre tabindex=0><code># frps.iniï¼ˆå…¬ç½‘æœåŠ¡å™¨é…ç½®ï¼‰
[common]
bind_port = 7000

# frpc.iniï¼ˆå†…ç½‘æœåŠ¡å™¨é…ç½®ï¼‰
[common]
server_addr = x.x.x.x  # å…¬ç½‘æœåŠ¡å™¨IP
server_port = 7000

[gitea]
type = tcp
local_port = 3000
remote_port = 8000     # é€šè¿‡å…¬ç½‘IP:8000è®¿é—®
</code></pre></li><li><p><strong>ä¼˜åŠ¿åœºæ™¯</strong>ï¼š</p><ul><li>æ— å…¬ç½‘ IP çš„å†…ç½‘ç¯å¢ƒ</li><li>å¿«é€Ÿä¸´æ—¶æµ‹è¯•ç¯å¢ƒæ­å»º</li><li>éœ€è¦æš´éœ²é HTTP æœåŠ¡ï¼ˆå¦‚ SSHï¼‰</li></ul></li></ul><hr><h3 id=äºŒå®‰å…¨æ¨¡å‹å¯¹æ¯”><strong>äºŒã€å®‰å…¨æ¨¡å‹å¯¹æ¯”</strong></h3><h3 id=nginx-å®‰å…¨å¢å¼º><strong>Nginx å®‰å…¨å¢å¼º</strong></h3><ol><li><p>SSL ç»ˆç«¯åŠ å¯†</p></li><li><p>æ”»å‡»é˜²æŠ¤ï¼š</p><pre tabindex=0><code># é™åˆ¶è¯·æ±‚é¢‘ç‡
limit_req_zone $binary_remote_addr zone=one:10m rate=10r/s;
</code></pre></li><li><p>è®¿é—®æ§åˆ¶ï¼š</p><pre tabindex=0><code>location /admin {
    allow 192.168.1.0/24;
    deny all;
}
</code></pre></li></ol><h3 id=frp-å®‰å…¨è€ƒè™‘><strong>frp å®‰å…¨è€ƒè™‘</strong></h3><ol><li><p>ä¼ è¾“åŠ å¯†ï¼š</p><pre tabindex=0><code># frpc.ini
[common]
tls_enable = true  # å¯ç”¨ TLS åŠ å¯†
</code></pre></li><li><p>Token éªŒè¯ï¼š</p><pre tabindex=0><code>[common]
authentication_method = token
token = your_secure_token
</code></pre></li></ol><hr><h3 id=ä¸‰æ€§èƒ½è¡¨ç°å·®å¼‚><strong>ä¸‰ã€æ€§èƒ½è¡¨ç°å·®å¼‚</strong></h3><table><thead><tr><th>æŒ‡æ ‡</th><th>Nginx</th><th>frp</th></tr></thead><tbody><tr><td>1000å¹¶å‘è¿æ¥</td><td>å†…å­˜æ¶ˆè€—çº¦ 50MB</td><td>å†…å­˜æ¶ˆè€—çº¦ 80MB</td></tr><tr><td>æ•°æ®å‹ç¼©</td><td>æ”¯æŒ Gzip/Brotli</td><td>æ— åŸç”Ÿå‹ç¼©æ”¯æŒ</td></tr><tr><td>é•¿è¿æ¥å¤ç”¨</td><td>Keep-Alive ä¼˜åŒ–</td><td>åŸºç¡€ TCP è¿æ¥ä¿æŒ</td></tr><tr><td>å¸¦å®½åˆ©ç”¨ç‡</td><td>æ™ºèƒ½ç¼“å†²æœºåˆ¶</td><td>ç›´é€šå¼è½¬å‘</td></tr></tbody></table><hr><h3 id=å››éƒ¨ç½²æ¶æ„å¯¹æ¯”><strong>å››ã€éƒ¨ç½²æ¶æ„å¯¹æ¯”</strong></h3><h3 id=nginx-å…¸å‹æ¶æ„><strong>Nginx å…¸å‹æ¶æ„</strong></h3><pre tabindex=0><code>äº’è”ç½‘ç”¨æˆ·
   â†“ HTTPS
[Nginx å…¬ç½‘æœåŠ¡å™¨] â†â†’ [Gitea æœ¬åœ°æœåŠ¡]
</code></pre><h3 id=frp-å…¸å‹æ¶æ„><strong>frp å…¸å‹æ¶æ„</strong></h3><pre tabindex=0><code>äº’è”ç½‘ç”¨æˆ·
   â†“ TCP/HTTP
[frp å…¬ç½‘æœåŠ¡å™¨] â†â†’ [frp å®¢æˆ·ç«¯] â†â†’ [Gitea å†…ç½‘æœåŠ¡]
</code></pre><hr><h3 id=äº”é€‰å‹å»ºè®®><strong>äº”ã€é€‰å‹å»ºè®®</strong></h3><h3 id=é€‰æ‹©-nginx-å½“><strong>é€‰æ‹© Nginx å½“</strong>ï¼š</h3><ol><li>æœåŠ¡ç›´æ¥éƒ¨ç½²åœ¨å…¬ç½‘æœåŠ¡å™¨</li><li>éœ€è¦ HTTPS è¯ä¹¦è‡ªåŠ¨ç»­ç­¾</li><li>æœ‰ Web é«˜çº§åŠŸèƒ½éœ€æ±‚ï¼ˆç¼“å­˜/é‡å®šå‘/åˆ†æµï¼‰</li></ol><h3 id=é€‰æ‹©-frp-å½“><strong>é€‰æ‹© frp å½“</strong>ï¼š</h3><ol><li>æœåŠ¡ä½äºæ— å…¬ç½‘ IP çš„å†…ç½‘</li><li>éœ€è¦å¿«é€Ÿæš´éœ²ä¸´æ—¶æµ‹è¯•ç¯å¢ƒ</li><li>éœ€ä»£ç†é HTTP åè®®ï¼ˆå¦‚ Git SSHï¼‰</li></ol><h3 id=æ··åˆæ–¹æ¡ˆæœ€ä½³å®è·µ><strong>æ··åˆæ–¹æ¡ˆï¼ˆæœ€ä½³å®è·µï¼‰</strong>ï¼š</h3><pre tabindex=0><code>äº’è”ç½‘ç”¨æˆ·
   â†“ HTTPS
[Nginx å…¬ç½‘æœåŠ¡å™¨] â†â†’ [frp å…¬ç½‘ç«¯]
                        â†“ åŠ å¯†éš§é“
                     [frp å†…ç½‘ç«¯] â†â†’ [Gitea å†…ç½‘æœåŠ¡]
</code></pre><ul><li><p><strong>ä¼˜åŠ¿</strong>ï¼šæ—¢æœ‰ HTTPS ç»ˆç«¯ï¼Œåˆå®ç°å†…ç½‘ç©¿é€</p></li><li><p><strong>é…ç½®è¦ç‚¹</strong>ï¼š</p><pre tabindex=0><code># Nginx é…ç½®è½¬å‘åˆ° frp
location / {
    proxy_pass http://frp_public_server:8000;
}
</code></pre></li></ul><hr><h3 id=å…­ç»´æŠ¤æˆæœ¬å¯¹æ¯”><strong>å…­ã€ç»´æŠ¤æˆæœ¬å¯¹æ¯”</strong></h3><table><thead><tr><th>æ“ä½œ</th><th>Nginx</th><th>frp</th></tr></thead><tbody><tr><td>è¯ä¹¦æ›´æ–°</td><td><code>certbot renew</code> è‡ªåŠ¨å®Œæˆ</td><td>éœ€æ‰‹åŠ¨æ›¿æ¢å®¢æˆ·ç«¯è¯ä¹¦</td></tr><tr><td>é…ç½®çƒ­é‡è½½</td><td><code>nginx -s reload</code> æ— å®•æœº</td><td>éœ€é‡å¯ frpc æœåŠ¡</td></tr><tr><td>æ—¥å¿—åˆ†æ</td><td>å®Œå–„çš„ access.log æ ¼å¼</td><td>éœ€è‡ªè¡Œè§£æ frp æ—¥å¿—</td></tr><tr><td>ç›‘æ§é›†æˆ</td><td>å…¼å®¹ Prometheus/Grafana</td><td>éœ€é€šè¿‡ API è‡ªè¡Œé‡‡é›†æŒ‡æ ‡</td></tr></tbody></table><hr><p><strong>æœ€ç»ˆå†³ç­–æ ‘</strong>ï¼š</p><ol><li>æœåŠ¡æ˜¯å¦åœ¨å†…ç½‘ä¸”æ— å…¬ç½‘IPï¼Ÿ<ul><li>æ˜¯ â†’ å¿…é¡»ä½¿ç”¨ frp æˆ–ç±»ä¼¼ç©¿é€å·¥å…·</li><li>å¦ â†’ ç›´æ¥ä½¿ç”¨ Nginx</li></ul></li><li>æ˜¯å¦éœ€è¦é«˜çº§ Web åŠŸèƒ½ï¼Ÿ<ul><li>æ˜¯ â†’ Nginx å¿…é€‰</li><li>å¦ â†’ æ ¹æ®åè®®ç±»å‹é€‰æ‹©</li></ul></li></ol><p>é€šè¿‡ä»¥ä¸Šå¯¹æ¯”ï¼Œå¯æ ¹æ®å®é™…ç½‘ç»œç¯å¢ƒå’ŒåŠŸèƒ½éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„ä»£ç†æ–¹æ¡ˆã€‚ç”Ÿäº§ç¯å¢ƒæ¨èä¼˜å…ˆä½¿ç”¨ Nginxï¼Œç©¿é€åœºæ™¯ä¸‹ç”¨ frp ä½œä¸ºè¡¥å……ã€‚</p><h3 id=qwen>qwen</h3><p><strong>æ˜¯çš„ï¼ŒNginx å¯ä»¥ç›´æ¥åå‘ä»£ç†åˆ°å†…ç½‘çš„ Gitea æœåŠ¡å™¨ï¼Œä½†éœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</strong></p><hr><h3 id=å‰ææ¡ä»¶><strong>å‰ææ¡ä»¶</strong></h3><ol><li><strong>ç½‘ç»œè¿é€šæ€§</strong><ul><li>Nginx æ‰€åœ¨çš„æœåŠ¡å™¨ï¼ˆå¦‚å…¬ç½‘æœåŠ¡å™¨æˆ–å†…ç½‘è·³æ¿æœºï¼‰èƒ½å¤Ÿè®¿é—® Gitea æœåŠ¡å™¨çš„å†…ç½‘åœ°å€å’Œç«¯å£ï¼ˆå¦‚ <code>http://192.168.1.100:3000</code>ï¼‰ã€‚</li><li>å¦‚æœ Gitea åœ¨å®Œå…¨éš”ç¦»çš„å†…ç½‘ï¼ˆæ— ä»»ä½•å…¬ç½‘æš´éœ²ï¼‰ï¼Œéœ€é€šè¿‡ <strong>å†…ç½‘ç©¿é€å·¥å…·ï¼ˆå¦‚ frpã€ngrokï¼‰</strong> å°† Gitea æœåŠ¡æ˜ å°„åˆ° Nginx å¯è®¿é—®çš„èŠ‚ç‚¹ã€‚</li></ul></li><li><strong>Gitea é…ç½®</strong><ul><li>Gitea çš„ <code>app.ini</code> ä¸­éœ€æ­£ç¡®é…ç½® <code>ROOT_URL</code> ä¸º Nginx çš„åŸŸåï¼ˆå¦‚ <code>https://git.example.com</code>ï¼‰ã€‚</li><li>ç¡®ä¿ Gitea ç›‘å¬åœ¨å†…ç½‘åœ°å€ï¼ˆå¦‚ <code>HTTP_ADDR = 0.0.0.0</code> æˆ– <code>192.168.1.100</code>ï¼‰ã€‚</li></ul></li></ol><hr><h3 id=é…ç½®æ­¥éª¤><strong>é…ç½®æ­¥éª¤</strong></h3><h3 id=åœºæ™¯-1nginx-ä¸-gitea-åœ¨åŒä¸€å†…ç½‘><strong>åœºæ™¯ 1ï¼šNginx ä¸ Gitea åœ¨åŒä¸€å†…ç½‘</strong></h3><pre tabindex=0><code>server {
    listen 80;
    server_name git.example.com;

    location / {
        proxy_pass &lt;http://192.168.1.100:3000&gt;;  # Gitea å†…ç½‘åœ°å€
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
</code></pre><h3 id=åœºæ™¯-2nginx-åœ¨å…¬ç½‘gitea-åœ¨å†…ç½‘é€šè¿‡-frp-ç©¿é€><strong>åœºæ™¯ 2ï¼šNginx åœ¨å…¬ç½‘ï¼ŒGitea åœ¨å†…ç½‘ï¼ˆé€šè¿‡ frp ç©¿é€ï¼‰</strong></h3><ol><li><p><strong>é…ç½® frp å°†å†…ç½‘ Gitea æ˜ å°„åˆ°å…¬ç½‘</strong></p><ul><li><p><strong>frpc.iniï¼ˆå®¢æˆ·ç«¯ï¼‰</strong>ï¼š</p><pre tabindex=0><code>[gitea]
type = http
local_ip = 192.168.1.100
local_port = 3000
remote_port = 60080  # å…¬ç½‘æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶ç«¯å£
custom_domains = git.example.com
</code></pre></li><li><p><strong>frps.iniï¼ˆæœåŠ¡ç«¯ï¼‰</strong>ï¼š</p><pre tabindex=0><code>bind_port = 7000
vhost_http_port = 60080
</code></pre></li></ul></li><li><p><strong>Nginx åå‘ä»£ç†åˆ° frp æ˜ å°„çš„ç«¯å£</strong></p><pre tabindex=0><code>server {
    listen 80;
    server_name git.example.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name git.example.com;
    ssl_certificate /etc/letsencrypt/live/git.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/git.example.com/privkey.pem;

    location / {
        proxy_pass &lt;http://127.0.0.1:60080&gt;;  # frp æ˜ å°„çš„æœ¬åœ°ç«¯å£
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
</code></pre></li></ol><hr><h3 id=æ³¨æ„äº‹é¡¹><strong>æ³¨æ„äº‹é¡¹</strong></h3><ol><li><strong>SSL è¯ä¹¦</strong><ul><li>å¦‚æœé€šè¿‡ HTTPS è®¿é—®ï¼Œéœ€åœ¨ Nginx å±‚é…ç½® Let&rsquo;s Encrypt è¯ä¹¦ï¼ˆå¦‚ä½¿ç”¨ Certbotï¼‰ã€‚</li><li>Gitea çš„ <code>app.ini</code> ä¸­è®¾ç½® <code>PROTOCOL = https</code>ã€‚</li></ul></li><li><strong>å®‰å…¨æ€§</strong><ul><li>é™åˆ¶ Nginx çš„è®¿é—®æºï¼ˆå¦‚ <code>allow/deny</code> è§„åˆ™ï¼‰ã€‚</li><li>å¯ç”¨é˜²ç«å¢™ï¼ˆå¦‚ UFWï¼‰ä»…å…è®¸å¿…è¦ç«¯å£ã€‚</li></ul></li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong><ul><li><p>å¯ç”¨ Nginx ç¼“å­˜ï¼š</p><pre tabindex=0><code>proxy_buffering on;
proxy_cache my_cache;
</code></pre></li><li><p>è°ƒæ•´è¶…æ—¶æ—¶é—´ï¼š</p><pre tabindex=0><code>proxy_read_timeout 300s;
proxy_connect_timeout 60s;
</code></pre></li></ul></li></ol><hr><h3 id=å¸¸è§é—®é¢˜><strong>å¸¸è§é—®é¢˜</strong></h3><h3 id=q1nginx-æŠ¥é”™><strong>Q1ï¼šNginx æŠ¥é”™ <code>502 Bad Gateway</code></strong></h3><ul><li><p><strong>åŸå› </strong>ï¼šNginx æ— æ³•è¿æ¥åˆ° Gitea çš„å†…ç½‘åœ°å€ã€‚</p></li><li><p><strong>è§£å†³</strong>ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æµ‹è¯•å†…ç½‘è¿é€šæ€§</span>
</span></span><span class=line><span class=cl>curl &lt;http://192.168.1.100:3000&gt;
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥ Gitea æœåŠ¡çŠ¶æ€</span>
</span></span><span class=line><span class=cl>systemctl status gitea
</span></span></code></pre></div></li></ul><h3 id=q2gitea-é¡µé¢èµ„æºåŠ è½½å¤±è´¥><strong>Q2ï¼šGitea é¡µé¢èµ„æºåŠ è½½å¤±è´¥</strong></h3><ul><li><p><strong>åŸå› </strong>ï¼š<code>ROOT_URL</code> é…ç½®é”™è¯¯æˆ–æœªæ­£ç¡®è®¾ç½®åå‘ä»£ç†å¤´ã€‚</p></li><li><p><strong>è§£å†³</strong>ï¼š</p><pre tabindex=0><code>[server]
ROOT_URL = &lt;https://git.example.com/&gt;
</code></pre></li></ul><hr><h3 id=æ€»ç»“-1><strong>æ€»ç»“</strong></h3><ul><li><strong>ç›´æ¥åå‘ä»£ç†</strong>ï¼šé€‚ç”¨äº Nginx ä¸ Gitea åœ¨åŒä¸€ç½‘ç»œç¯å¢ƒã€‚</li><li><strong>å†…ç½‘ç©¿é€+åå‘ä»£ç†</strong>ï¼šé€‚ç”¨äº Gitea åœ¨å®Œå…¨éš”ç¦»çš„å†…ç½‘ï¼Œéœ€ç»“åˆ frp ç­‰å·¥å…·ã€‚</li><li><strong>æ ¸å¿ƒé…ç½®</strong>ï¼šç¡®ä¿ç½‘ç»œå¯è¾¾æ€§ã€æ­£ç¡®è®¾ç½® <code>proxy_pass</code> å’Œ <code>ROOT_URL</code>ã€‚</li></ul><p>æ ¹æ®å®é™…ç½‘ç»œç¯å¢ƒé€‰æ‹©æ–¹æ¡ˆï¼Œä¼˜å…ˆé€šè¿‡ HTTPS ä¿éšœå®‰å…¨æ€§ï¼</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-04-13</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/ data-title=Giteaæ­å»º data-hashtags=git><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/ data-hashtag=git><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/ data-title=Giteaæ­å»º><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/ data-title=Giteaæ­å»º><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on å¾®åš" data-sharer=weibo data-url=https://fjyu95.github.io/posts/gitea-1d2e4020f06080ff905ee0ba10dfeafa/ data-title=Giteaæ­å»º><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/git/>Git</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/gogs-1cee4020f06080249ec6d53c8d9ef2eb/ class=prev rel=prev title=gogs><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>gogs</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2020 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://fjyu95.github.io/ target=_blank>fjyu95</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>