<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>开源3d重建系统 - FangjieYu‘s site</title><meta name=Description content="This is my cool site"><meta property="og:url" content="https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/">
<meta property="og:site_name" content="FangjieYu‘s site"><meta property="og:title" content="开源3d重建系统"><meta property="og:description" content="开源三维重建系统比较及使用"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-09T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-26T00:00:00+00:00"><meta property="article:tag" content="3d"><meta property="article:tag" content="Colmap"><meta property="article:tag" content="Sfm"><meta name=twitter:card content="summary"><meta name=twitter:title content="开源3d重建系统"><meta name=twitter:description content="开源三维重建系统比较及使用"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/><link rel=prev href=https://fjyu95.github.io/posts/3dgs/><link rel=next href=https://fjyu95.github.io/posts/diy%E8%A3%85%E6%9C%BA/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"开源3d重建系统","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/fjyu95.github.io\/posts\/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D\/"},"genre":"posts","keywords":"3d, colmap, sfm","wordcount":2589,"url":"https:\/\/fjyu95.github.io\/posts\/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D\/","datePublished":"2024-11-09T00:00:00+00:00","dateModified":"2025-04-26T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"fjyu95"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="FangjieYu‘s site">fjyu95</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>posts </a><a class=menu-item href=/tags/>tags </a><a class=menu-item href=/categories/>category </a><a class=menu-item href=/about/>about </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="FangjieYu‘s site">fjyu95</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>posts</a><a class=menu-item href=/tags/ title>tags</a><a class=menu-item href=/categories/ title>category</a><a class=menu-item href=/about/ title>about</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">开源3d重建系统</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://fjyu95.github.io/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>fjyu95</a></span>&nbsp;<span class=post-category>included in <a href=/categories/%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA/><i class="far fa-folder fa-fw" aria-hidden=true></i>三维重建</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-11-09>2024-11-09</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2589 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#概览>概览</a><ul><li><a href=#三维重建流程>三维重建流程</a></li><li><a href=#开源三维重建系统比较>开源三维重建系统比较</a></li></ul></li><li><a href=#colmap-install>COLMAP install</a><ul><li><a href=#pipline>pipline</a></li><li><a href=#docker方式安装>docker方式安装</a></li><li><a href=#faq>FAQ</a><ul><li><a href=#1dense-stereo-reconstruction-requirescuda-which-is-not-available-on-your-system><strong>1、Dense stereo reconstruction requires CUDA, which is not available on your system.</strong></a></li><li><a href=#2no-good-initial-image-pair-found>2、No good initial image pair found.</a></li><li><a href=#1-insufficient-overlap-between-images>1. <strong>Insufficient Overlap Between Images</strong></a></li><li><a href=#2-low-quality-or-poorly-captured-images>2. <strong>Low-Quality or Poorly Captured Images</strong></a></li><li><a href=#3-incorrect-camera-parameters>3. <strong>Incorrect Camera Parameters</strong></a></li><li><a href=#4-inadequate-feature-extraction-or-matching>4. <strong>Inadequate Feature Extraction or Matching</strong></a></li><li><a href=#5-misconfigured-camera-model>5. <strong>Misconfigured Camera Model</strong></a></li><li><a href=#6-image-quality-control>6. <strong>Image Quality Control</strong></a></li><li><a href=#7-try-manual-initialization>7. <strong>Try Manual Initialization</strong></a></li><li><a href=#8-image-scale-or-alignment-issues>8. <strong>Image Scale or Alignment Issues</strong></a></li><li><a href=#next-steps>Next Steps:</a></li></ul></li></ul></li><li><a href=#colmap稀疏点云格式>colmap稀疏点云格式</a><ul><li><a href=#-colmap-稀疏点云的目录结构及文件格式><strong>📌 COLMAP 稀疏点云的目录结构及文件格式</strong></a></li><li><a href=#-1-稀疏点云的二进制文件格式默认><strong>📂 1. 稀疏点云的二进制文件格式（默认）</strong></a><ul><li><a href=#如何转换为文本格式可读><strong>如何转换为文本格式（可读）</strong></a></li></ul></li><li><a href=#-2-解析-colmap-生成的><strong>📄 2. 解析 COLMAP 生成的 <code>txt</code> 文件</strong></a><ul><li><a href=#1-camerastxt><strong>(1) cameras.txt</strong></a></li><li><a href=#2-imagestxt><strong>(2) images.txt</strong></a></li><li><a href=#3-points3dtxt><strong>(3) points3D.txt</strong></a></li></ul></li><li><a href=#-3-ply-格式可视化用><strong>📂 3. PLY 格式（可视化用）</strong></a></li><li><a href=#-总结><strong>💡 总结</strong></a><ul><li><a href=#4外参表示形式>4、外参表示形式</a></li><li><a href=#1-colmap-外参的存储格式><strong>1. COLMAP 外参的存储格式</strong></a></li><li><a href=#2-外参的数学含义><strong>2. 外参的数学含义</strong></a></li><li><a href=#3-从-colmap-提取外参><strong>3. 从 COLMAP 提取外参</strong></a></li><li><a href=#4-解析二进制><strong>4. 解析二进制 <code>images.bin</code></strong></a></li><li><a href=#总结><strong>总结</strong></a></li></ul></li></ul></li><li><a href=#meshlab>meshlab</a></li></ul></nav></div></div><div class=content id=content><h1 id=概览>概览</h1><p>COLMAP 学术界更流行</p><p>OpenSfM 更适合GIS领域</p><p><strong>OpenMVG + OpenMVS</strong></p><p>mvs-texturing</p><h2 id=三维重建流程>三维重建流程</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image.png data-srcset="/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image.png, /posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image.png 1.5x, /posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image.png 2x" data-sizes=auto alt=/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image.png title=image.png width=720 height=265></p><h2 id=开源三维重建系统比较>开源三维重建系统比较</h2><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image%201.png data-srcset="/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image%201.png, /posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image%201.png 1.5x, /posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image%201.png 2x" data-sizes=auto alt=/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/image%201.png title=image.png width=720 height=555><br>绿色表示支持，红色表示不支持</p><h1 id=colmap-install>COLMAP install</h1><p><a href=https://github.com/colmap/colmap target=_blank rel="noopener noreffer">https://github.com/colmap/colmap</a></p><p><a href=https://colmap.github.io/install.html target=_blank rel="noopener noreffer">https://colmap.github.io/install.html</a></p><p><a href=https://repology.org/project/colmap/versions target=_blank rel="noopener noreffer">https://repology.org/project/colmap/versions</a></p><h2 id=pipline>pipline</h2><p><a href=https://blog.csdn.net/m0_56836274/article/details/139245630 target=_blank rel="noopener noreffer">https://blog.csdn.net/m0_56836274/article/details/139245630</a></p><h2 id=docker方式安装>docker方式安装</h2><p><a href=https://hub.docker.com/r/colmap/colmap target=_blank rel="noopener noreffer">https://hub.docker.com/r/colmap/colmap</a></p><h2 id=faq>FAQ</h2><h3 id=1dense-stereo-reconstruction-requirescuda-which-is-not-available-on-your-system><strong>1、Dense stereo reconstruction requires CUDA, which is not available on your system.</strong></h3><p>稠密重建必须安装配置cuda</p><h3 id=2no-good-initial-image-pair-found>2、No good initial image pair found.</h3><p>The error <strong>&ldquo;No good initial image pair found&rdquo;</strong> in COLMAP typically occurs during the feature matching or structure-from-motion (SfM) pipeline, specifically when COLMAP is unable to find a good pair of images to start the matching process.</p><p>Here are some common causes and solutions for this error:</p><h3 id=1-insufficient-overlap-between-images>1. <strong>Insufficient Overlap Between Images</strong></h3><ul><li><strong>Cause</strong>: If the images do not have enough overlap (i.e., common features), COLMAP may struggle to find a good initial image pair.</li><li><strong>Solution</strong>:<ul><li>Ensure that your images have significant overlap and that the camera movement between shots isn&rsquo;t too large.</li><li>Try to include images with obvious common features.</li></ul></li></ul><h3 id=2-low-quality-or-poorly-captured-images>2. <strong>Low-Quality or Poorly Captured Images</strong></h3><ul><li><strong>Cause</strong>: Images with poor resolution, blurriness, or noise may not have enough features to match.</li><li><strong>Solution</strong>:<ul><li>Use higher-quality images with clear details and fewer blurry areas.</li><li>Ensure images have distinct features that are easy to detect.</li></ul></li></ul><h3 id=3-incorrect-camera-parameters>3. <strong>Incorrect Camera Parameters</strong></h3><ul><li><strong>Cause</strong>: Incorrect camera intrinsic parameters (focal length, principal point, etc.) can affect the feature matching process.</li><li><strong>Solution</strong>:<ul><li>If you have camera calibration data, make sure to input the correct intrinsic parameters in COLMAP.</li><li>If unsure, you can use the <strong>Automatic Calibration</strong> option in COLMAP to let it estimate the parameters.</li></ul></li></ul><h3 id=4-inadequate-feature-extraction-or-matching>4. <strong>Inadequate Feature Extraction or Matching</strong></h3><ul><li><strong>Cause</strong>: The feature extraction and matching process may not be set up optimally, leading to no good matches between images.</li><li><strong>Solution</strong>:<ul><li>Increase the number of features extracted by adjusting the parameters in <strong>Feature Extraction</strong> (e.g., increase the number of keypoints, use different detectors like SIFT or ORB).</li><li>Use <strong>More Robust Matching</strong> by adjusting matching parameters or enabling <strong>Exhaustive Matching</strong>.</li></ul></li></ul><h3 id=5-misconfigured-camera-model>5. <strong>Misconfigured Camera Model</strong></h3><ul><li><strong>Cause</strong>: The selected camera model may not suit your dataset, especially if you&rsquo;re using a non-standard or specific camera type.</li><li><strong>Solution</strong>:<ul><li>Check if you&rsquo;re using the correct camera model in COLMAP. If you are using a non-standard camera, try defining the camera model manually or adjust the model settings.</li></ul></li></ul><h3 id=6-image-quality-control>6. <strong>Image Quality Control</strong></h3><ul><li><strong>Solution</strong>: You can try running the image set through a tool that automatically detects problematic images. If certain images are out of focus, poorly exposed, or lack sufficient texture, COLMAP might fail to create a good initial match. Removing or fixing these images could help.</li></ul><h3 id=7-try-manual-initialization>7. <strong>Try Manual Initialization</strong></h3><ul><li><strong>Solution</strong>: If automatic initialization fails, you can try <strong>manual initialization</strong>. In COLMAP, you can manually select two images to initialize the SfM pipeline. This can sometimes bypass the issue when automatic matching is not successful.</li></ul><h3 id=8-image-scale-or-alignment-issues>8. <strong>Image Scale or Alignment Issues</strong></h3><ul><li><strong>Cause</strong>: Images might have been resized or improperly aligned (e.g., if they come from different sources with different camera settings or scales).</li><li><strong>Solution</strong>: Make sure all images are aligned correctly, and if they were resized or downsampled, consider working with the original images.</li></ul><hr><h3 id=next-steps>Next Steps:</h3><ul><li>Start by reviewing the dataset and checking for any obvious issues with the images (e.g., overlap, quality).</li><li>Try adjusting the parameters for feature extraction and matching in COLMAP.</li><li>If the issue persists, consider using manual initialization to give COLMAP a better starting point.</li></ul><h1 id=colmap稀疏点云格式>colmap稀疏点云格式</h1><h2 id=-colmap-稀疏点云的目录结构及文件格式><strong>📌 COLMAP 稀疏点云的目录结构及文件格式</strong></h2><p>COLMAP 生成的 <strong>稀疏重建（Sparse Reconstruction）</strong> 结果通常保存在 <code>sparse/</code> 目录下，其结构如下：</p><pre tabindex=0><code>COLMAP_PROJECT/
│── images/             # 输入图像
│── sparse/             # 稀疏点云数据
│   ├── 0/              # 第一组稀疏重建（可有多个）
│   │   ├── cameras.bin       # 相机内参信息
│   │   ├── images.bin        # 图像的位姿 (R, T) 及 3D-2D 观测关系
│   │   ├── points3D.bin      # 3D点云数据
│   ├── txt/            # 可选：转换后的文本格式（cameras.txt, images.txt, points3D.txt）
│   ├── pointcloud.ply  # 可选：PLY 格式点云（用于可视化）
│── database.db         # COLMAP 数据库（存储特征点、匹配关系等）
│── dense/              # 稠密重建（MVS）
│── ...
</code></pre><p><code>0/</code> 目录表示第一个重建模型，如果你进行了多次 <strong>Incremental Reconstruction</strong>，可能会有 <code>1/</code>, <code>2/</code> 等多个重建模型。</p><hr><h2 id=-1-稀疏点云的二进制文件格式默认><strong>📂 1. 稀疏点云的二进制文件格式（默认）</strong></h2><p>默认情况下，COLMAP 使用二进制格式存储数据：</p><table><thead><tr><th>文件名</th><th>作用</th></tr></thead><tbody><tr><td><code>cameras.bin</code></td><td>相机的内参（焦距、主点、畸变系数等）</td></tr><tr><td><code>images.bin</code></td><td>相机的外参（位姿 R, T）和 3D-2D 对应关系</td></tr><tr><td><code>points3D.bin</code></td><td>稀疏 3D 点云（包含颜色、重投影误差等）</td></tr></tbody></table><h3 id=如何转换为文本格式可读><strong>如何转换为文本格式（可读）</strong></h3><p>可以使用 <code>colmap model_converter</code> 转换：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>colmap model_converter --input_path sparse/0 --output_path sparse/txt --output_type TXT
</span></span></code></pre></td></tr></table></div></div><p>这样会生成：</p><ul><li><code>cameras.txt</code></li><li><code>images.txt</code></li><li><code>points3D.txt</code></li></ul><hr><h2 id=-2-解析-colmap-生成的><strong>📄 2. 解析 COLMAP 生成的 <code>txt</code> 文件</strong></h2><h3 id=1-camerastxt><strong>(1) cameras.txt</strong></h3><p>存储相机的内参，每行格式如下：</p><pre tabindex=0><code>&lt;camera_id&gt; &lt;model&gt; &lt;width&gt; &lt;height&gt; &lt;params&gt;
</code></pre><p>示例：</p><pre tabindex=0><code>1 PINHOLE 1920 1080 1500.0 960.0 540.0
</code></pre><ul><li><code>PINHOLE</code> 表示相机模型（可以是 <code>SIMPLE_PINHOLE</code>、<code>OPENCV</code> 等）。</li><li><code>1500.0</code> 是焦距 <code>fx</code>。</li><li><code>960.0 540.0</code> 是主点坐标 <code>(cx, cy)</code>。</li></ul><hr><h3 id=2-imagestxt><strong>(2) images.txt</strong></h3><p>存储 <strong>相机外参（位姿 R, T）</strong> 及 3D-2D 观测关系，每个相机两行：</p><pre tabindex=0><code>&lt;image_id&gt; &lt;qw&gt; &lt;qx&gt; &lt;qy&gt; &lt;qz&gt; &lt;tx&gt; &lt;ty&gt; &lt;tz&gt; &lt;camera_id&gt; &lt;image_name&gt;
&lt;point2D_x1&gt; &lt;point2D_y1&gt; &lt;point3D_id1&gt; &lt;point2D_x2&gt; &lt;point2D_y2&gt; &lt;point3D_id2&gt; ...
</code></pre><p>示例：</p><pre tabindex=0><code>1 0.998 -0.002 0.055 -0.015 0.2 0.1 1.5 1 img_001.jpg
50.5 30.2 10  120.3 60.7 11  ...
</code></pre><ul><li><code>qw, qx, qy, qz</code> 是四元数（旋转矩阵）。</li><li><code>tx, ty, tz</code> 是平移向量。</li><li><code>point2D_x, point2D_y</code> 是该图像上的特征点像素坐标。</li><li><code>point3D_id</code> 是点云中对应的 3D 点 ID（如果 <code>1</code>，表示未匹配到 3D 点）。</li></ul><hr><h3 id=3-points3dtxt><strong>(3) points3D.txt</strong></h3><p>存储 <strong>3D 点坐标、颜色、重投影误差及观测信息</strong>：</p><pre tabindex=0><code>&lt;point3D_id&gt; &lt;X&gt; &lt;Y&gt; &lt;Z&gt; &lt;R&gt; &lt;G&gt; &lt;B&gt; &lt;error&gt; &lt;track&gt;
</code></pre><p>示例：</p><pre tabindex=0><code>10 1.23 2.34 3.45 255 0 0 0.5  1 23  2 15  3 7
</code></pre><ul><li><code>10</code>：点 ID</li><li><code>1.23 2.34 3.45</code>：3D 世界坐标</li><li><code>255 0 0</code>：RGB 颜色</li><li><code>0.5</code>：重投影误差</li><li><code>1 23 2 15 3 7</code>：该点被 <code>image_id=1</code> 的第 <code>23</code> 个关键点观测到，<code>image_id=2</code> 的 <code>15</code> 号关键点观测到，依此类推。</li></ul><hr><h2 id=-3-ply-格式可视化用><strong>📂 3. PLY 格式（可视化用）</strong></h2><p>如果你想用 <strong>MeshLab</strong> 或 <strong>Open3D</strong> 可视化点云，可以导出 <code>.ply</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>colmap model_converter --input_path sparse/0 --output_path sparse/pointcloud.ply --output_type PLY
</span></span></code></pre></td></tr></table></div></div><p>该文件包含：</p><ul><li>3D 坐标 (<code>x, y, z</code>)</li><li>颜色 (<code>r, g, b</code>)</li></ul><p><strong>使用 Open3D 读取并可视化：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>open3d</span> <span class=k>as</span> <span class=nn>o3d</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pcd</span> <span class=o>=</span> <span class=n>o3d</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>read_point_cloud</span><span class=p>(</span><span class=s2>&#34;sparse/pointcloud.ply&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>o3d</span><span class=o>.</span><span class=n>visualization</span><span class=o>.</span><span class=n>draw_geometries</span><span class=p>([</span><span class=n>pcd</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=-总结><strong>💡 总结</strong></h2><table><thead><tr><th>文件名</th><th>作用</th><th>可读性</th></tr></thead><tbody><tr><td><code>cameras.bin</code> / <code>cameras.txt</code></td><td>存储相机的内参</td><td>📜 易读（TXT）</td></tr><tr><td><code>images.bin</code> / <code>images.txt</code></td><td>存储相机位姿（R, T）及 3D-2D 观测关系</td><td>📜 复杂但可读</td></tr><tr><td><code>points3D.bin</code> / <code>points3D.txt</code></td><td>存储 3D 点云及颜色、重投影误差等</td><td>📜 重要</td></tr><tr><td><code>pointcloud.ply</code></td><td>PLY 格式的点云文件（可视化）</td><td>📌 方便可视化</td></tr></tbody></table><p>如果你需要解析 <code>.bin</code>，可以用 Python 读取：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>colmap_read_model</span> <span class=k>as</span> <span class=nn>read_model</span>  <span class=c1># 需要 colmap_read_model.py（可在 COLMAP GitHub 找到）</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cameras</span><span class=p>,</span> <span class=n>images</span><span class=p>,</span> <span class=n>points3D</span> <span class=o>=</span> <span class=n>read_model</span><span class=o>.</span><span class=n>read_model</span><span class=p>(</span><span class=s2>&#34;sparse/0&#34;</span><span class=p>,</span> <span class=n>ext</span><span class=o>=</span><span class=s2>&#34;.bin&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Number of cameras:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>cameras</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Number of images:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>images</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Number of 3D points:&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>points3D</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>如果你有更具体的问题，比如如何解析 <code>.bin</code> 文件或者转换其他格式，可以告诉我！ 🚀</p><h3 id=4外参表示形式>4、外参表示形式</h3><p>在 COLMAP 中，外参（外部参数，extrinsics）用于描述相机在三维空间中的姿态。COLMAP 使用 <strong>世界坐标系到相机坐标系的变换</strong>，并采用 <strong>四元数 + 平移向量</strong> 进行存储。</p><hr><h3 id=1-colmap-外参的存储格式><strong>1. COLMAP 外参的存储格式</strong></h3><p>q=qw+qxi+qyj+qzk （w,x,y,z顺序）</p><p>COLMAP 的外参一般存储在 <strong><code>cameras.txt</code></strong>（相机参数）、<strong><code>images.txt</code></strong>（外参） 或 <strong><code>images.bin</code></strong>（二进制格式）文件中，格式如下：</p><pre tabindex=0><code>IMAGE_ID QW QX QY QZ TX TY TZ CAMERA_ID NAME
</code></pre><p>每一行表示一张图像的外参：</p><ul><li><code>IMAGE_ID</code>：图像的 ID</li><li><code>QW QX QY QZ</code>：表示 <strong>旋转（四元数）</strong>，用于描述相机姿态</li><li><code>TX TY TZ</code>：表示 <strong>平移向量</strong>（相机在世界坐标系中的位置）</li><li><code>CAMERA_ID</code>：相机的 ID（与 <code>cameras.txt</code> 关联）</li><li><code>NAME</code>：图像文件名</li></ul><hr><h3 id=2-外参的数学含义><strong>2. 外参的数学含义</strong></h3><p>COLMAP 采用 <strong>世界坐标系 → 相机坐标系</strong> 的变换：</p><p>Xc=R⋅Xw+TX_c = R \cdot X_w + T</p><p>其中：</p><ul><li>RR 是旋转矩阵，由四元数转换得到</li><li>T=(TX,TY,TZ)T = (TX, TY, TZ) 是平移向量</li><li>XwX_w 是世界坐标系中的点</li><li>XcX_c 是相机坐标系中的点</li></ul><p>如果需要相机的 <strong>位姿（世界坐标系中的位置和朝向）</strong>，可以计算 <strong>相机中心 C</strong>：</p><p>C=−RT⋅TC = -R^T \cdot T</p><p>其中：</p><ul><li>RTR^T 是旋转矩阵的转置</li><li>计算后得到的是相机在世界坐标系下的中心位置</li></ul><hr><h3 id=3-从-colmap-提取外参><strong>3. 从 COLMAP 提取外参</strong></h3><p>如果想将 COLMAP 提供的 <strong>四元数+平移向量</strong> 转换为 <strong>旋转矩阵 R 和相机中心 C</strong>，可以使用 Python 代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.spatial.transform</span> <span class=kn>import</span> <span class=n>Rotation</span> <span class=k>as</span> <span class=n>R</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 假设外参数据</span>
</span></span><span class=line><span class=cl><span class=n>qw</span><span class=p>,</span> <span class=n>qx</span><span class=p>,</span> <span class=n>qy</span><span class=p>,</span> <span class=n>qz</span> <span class=o>=</span> <span class=mf>0.707</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>,</span> <span class=mf>0.707</span><span class=p>,</span> <span class=mf>0.0</span>  <span class=c1># 四元数</span>
</span></span><span class=line><span class=cl><span class=n>tx</span><span class=p>,</span> <span class=n>ty</span><span class=p>,</span> <span class=n>tz</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>2.0</span><span class=p>,</span> <span class=mf>3.0</span>  <span class=c1># 平移向量</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 四元数转旋转矩阵</span>
</span></span><span class=line><span class=cl><span class=n>rot</span> <span class=o>=</span> <span class=n>R</span><span class=o>.</span><span class=n>from_quat</span><span class=p>([</span><span class=n>qx</span><span class=p>,</span> <span class=n>qy</span><span class=p>,</span> <span class=n>qz</span><span class=p>,</span> <span class=n>qw</span><span class=p>])</span><span class=o>.</span><span class=n>as_matrix</span><span class=p>()</span>  <span class=c1># SciPy 需要 [qx, qy, qz, qw]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 计算相机中心</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>tx</span><span class=p>,</span> <span class=n>ty</span><span class=p>,</span> <span class=n>tz</span><span class=p>])</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>camera_center</span> <span class=o>=</span> <span class=o>-</span><span class=n>rot</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;旋转矩阵 R:</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>rot</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;相机中心 C:</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>camera_center</span><span class=o>.</span><span class=n>flatten</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=4-解析二进制><strong>4. 解析二进制 <code>images.bin</code></strong></h3><p>COLMAP 也支持 <code>images.bin</code> 格式，如果想解析，可以用 <code>colmap.bin_to_txt</code> 或者 Python：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>struct</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_colmap_binary_images</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>num_images</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;Q&#34;</span><span class=p>,</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>images</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_images</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;idddddddi&#34;</span><span class=p>,</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>64</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>image_id</span><span class=p>,</span> <span class=n>qw</span><span class=p>,</span> <span class=n>qx</span><span class=p>,</span> <span class=n>qy</span><span class=p>,</span> <span class=n>qz</span><span class=p>,</span> <span class=n>tx</span><span class=p>,</span> <span class=n>ty</span><span class=p>,</span> <span class=n>tz</span><span class=p>,</span> <span class=n>camera_id</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>            <span class=n>name_length</span> <span class=o>=</span> <span class=n>struct</span><span class=o>.</span><span class=n>unpack</span><span class=p>(</span><span class=s2>&#34;&lt;I&#34;</span><span class=p>,</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>name_length</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>images</span><span class=p>[</span><span class=n>image_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>qw</span><span class=p>,</span> <span class=n>qx</span><span class=p>,</span> <span class=n>qy</span><span class=p>,</span> <span class=n>qz</span><span class=p>,</span> <span class=n>tx</span><span class=p>,</span> <span class=n>ty</span><span class=p>,</span> <span class=n>tz</span><span class=p>,</span> <span class=n>camera_id</span><span class=p>,</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>images</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>images</span> <span class=o>=</span> <span class=n>read_colmap_binary_images</span><span class=p>(</span><span class=s2>&#34;images.bin&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>images</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=总结><strong>总结</strong></h3><ul><li><p><strong>COLMAP 采用四元数 + 平移向量存储外参</strong>。</p></li><li><p><strong>外参表示的是世界坐标系到相机坐标系的变换</strong>。</p></li><li><p><strong>四元数可以转换为旋转矩阵 R</strong>，相机中心可以通过 计算。</p><p>C=−RTTC = -R^T</p></li><li><p><strong>可以解析 <code>images.txt</code> 或 <code>images.bin</code> 以获取外参</strong>。</p></li></ul><h1 id=meshlab>meshlab</h1><p>ctrl+左键长按 拖动</p><p>ctrl+滚轮 控制点数的增减</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2025-04-26</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/ data-title=开源3d重建系统 data-hashtags=3d,colmap,sfm><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/ data-hashtag=3d><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/ data-title=开源3d重建系统><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/ data-title=开源3d重建系统><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://fjyu95.github.io/posts/%E5%BC%80%E6%BA%90%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/ data-title=开源3d重建系统><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/3d/>3d</a>,&nbsp;<a href=/tags/colmap/>Colmap</a>,&nbsp;<a href=/tags/sfm/>Sfm</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/3dgs/ class=prev rel=prev title=3DGS><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>3DGS</a>
<a href=/posts/diy%E8%A3%85%E6%9C%BA/ class=next rel=next title=DIY装机>DIY装机<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2020 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://fjyu95.github.io/ target=_blank>fjyu95</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>